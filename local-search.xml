<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>GitHubæé€Ÿ</title>
    <link href="undefined2019/08/04/2019-08-04-github%E6%8F%90%E9%80%9F/"/>
    <url>2019/08/04/2019-08-04-github%E6%8F%90%E9%80%9F/</url>
    
    <content type="html"><![CDATA[<blockquote><p>è‡ªä»å¾®è½¯æ”¶è´­GitHubä»¥æ¥ï¼ŒGitHubä»“åº“åŒæ­¥é€Ÿåº¦æŠ½é£å‡å°‘ã€‚ä½†æ˜¯ä»æ˜¨å¤©å¼€å§‹åˆ°ç°åœ¨GitHubä»“åº“åŒæ­¥å˜å¾—å·¨æ…¢ï¼Œè”ç³»ä¸­ç¾è´¸æ˜“æˆ˜ä»¥åŠæœ€è¿‘çš„å¾®è½¯å‘å¸ƒéµå®ˆç¾å›½æ³•å¾‹çš„æ–°é—»æ¶ˆæ¯ç­‰ç­‰ï¼Œå¤§å®¶éƒ½æ‡‚ï¼Œçœ‹æ¥GitHubåˆ†å‘æœåŠ¡å™¨DNSæ±¡æŸ“ä¸¥é‡ã€‚é‚£å’±ä¹Ÿä¸èƒ½æ”¾å¼ƒï¼Œé‚£å’±ä»¬å°±hostsæ–‡ä»¶ç›´æ¥è§£æåŸŸåæŒ‡å‘ipåœ°å€ç»•è¿‡å›½å†…DNSè§£æã€‚</p></blockquote><ol><li><a href="https://www.ipaddress.com" target="_blank" rel="noopener">https://www.ipaddress.com</a></li><li>æŸ¥è¯¢ä¸‹é¢3ä¸ªç½‘å€çš„<code>IP</code></li></ol><pre><code>    a. github.com    b. assets-cdn.github.com    c. github.global.ssl.fastly.net</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>DNS</tag>
      
      <tag>GitHub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSæœåŠ¡å™¨éƒ¨ç½²</title>
    <link href="undefined2019/07/05/2019-07-05-SS%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2/"/>
    <url>2019/07/05/2019-07-05-SS%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2/</url>
    
    <content type="html"><![CDATA[<blockquote><p>ä½ å¥½å•Š</p></blockquote><blockquote><p>å¤ªé•¿äº†ï¼Œæˆ‘å†³å®šé¸½ğŸ˜®</p></blockquote><blockquote><p>Buildingã€‚ã€‚ã€‚</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>ss</tag>
      
      <tag>vultr</tag>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>celeryç®€å•ä½¿ç”¨(æ¬è¿æ•´ç†)</title>
    <link href="undefined2018/11/07/2018-11-07-celery%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"/>
    <url>2018/11/07/2018-11-07-celery%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<blockquote></blockquote><h1 id="Celery"><a href="#Celery" class="headerlink" title="Celery"></a>Celery</h1><p>Celeryæ˜¯ä¸€ä¸ªåŸºäºPythonå¼€å‘çš„åˆ†å¸ƒå¼å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¯ä»¥è½»æ¾å®ç°ä»»åŠ¡çš„å¼‚æ­¥å¤„ç†ã€‚å®ƒçš„åŸºæœ¬å·¥ä½œå°±æ˜¯ç®¡ç†åˆ†é…ä»»åŠ¡åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œå¹¶ä¸”å–å¾—ç»“æœã€‚è‡³äºè¯´æœåŠ¡å™¨ä¹‹é—´æ˜¯å¦‚ä½•è¿›è¡Œé€šä¿¡çš„ï¼Ÿè¿™ä¸ªCeleryæœ¬èº«ä¸èƒ½è§£å†³ã€‚</p><a id="more"></a><p>Celeryåœ¨æ‰§è¡Œä»»åŠ¡æ—¶éœ€è¦ä¸€ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶æ¥æ¥æ”¶å’Œå‘é€ä»»åŠ¡æ¶ˆæ¯ï¼Œä»¥åŠå­˜å‚¨ä»»åŠ¡ç»“æœï¼Œä¸€èˆ¬ä½¿ç”¨RabbitMQ æˆ– Redisï¼Œæˆ‘ä»¬è¿™é‡Œåªè®¨è®ºCelery+RabbitMQï¼Œå…¶ä»–çš„ç»„åˆæ–¹å¼å¯ä»¥æŸ¥é˜…æ›´å¤šèµ„æ–™ã€‚</p><p>RabbitMQæ˜¯ä¸€ä¸ªç”±Erlangè¯­è¨€å¼€å‘çš„AMQPçš„å¼€æºå®ç°ã€‚AMQPå³Advanced Message Queueï¼Œé«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ã€‚å®ƒæ˜¯åº”ç”¨å±‚åè®®çš„ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œä¸ºé¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶è®¾è®¡ï¼ŒåŸºäºæ­¤åè®®çš„å®¢æˆ·ç«¯ä¸æ¶ˆæ¯ä¸­é—´ä»¶å¯ä¼ é€’æ¶ˆæ¯ï¼Œå¹¶ä¸å—äº§å“ã€å¼€å‘è¯­è¨€ç­‰æ¡ä»¶çš„é™åˆ¶ã€‚</p><p>åœ¨Celery+RabbitMQç»„åˆä¸­ï¼ŒRabbitMQä½œä¸ºä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ç®¡ç†å·¥å…·è¢«å¼•å…¥åˆ°å’ŒCeleryé›†æˆï¼Œè´Ÿè´£å¤„ç†æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ä»»åŠ¡ã€‚</p><p>é‚£ä¹ˆæœ‰ä¸€ä¸ªç–‘é—®ï¼šRabbitMQä½œä¸ºæ¶ˆæ¯ç®¡ç†ç³»ç»Ÿå·²ç»å¯ä»¥å®ç°å¼‚æ­¥çš„å‘é€æ¶ˆæ¯ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨Celery?</p><p>Celeryç›¸å½“äºåŒ…è£…äº†ä¸€ä¸ªç°æˆçš„ç³»ç»Ÿï¼Œå¯ä»¥æ–¹ä¾¿çš„åœ¨é¡¹ç›®ä¸­æ“ä½œRabbitMQè¿™ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä»‹è´¨ï¼Œå‡å°‘åœ¨RabbitMQä¸Šç¼–å†™è„šæœ¬çš„ä»»åŠ¡ã€‚æœ€ç›´æ¥çš„ä¾‹å­å°±æ˜¯åœ¨Celery Pythoné‡Œï¼Œåªéœ€è¦configä¸€ä¸‹settingsï¼Œç„¶åå°±å¯ä»¥ç”¨decoratorè½»æ¾ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè€Œä¸ç”¨åœ¨RabbitMQä¸Šç¼–å†™å¤æ‚çš„è„šæœ¬ã€‚</p><p>å½“ç„¶ï¼ŒCeleryä¹Ÿæ”¯æŒå’ŒRedisã€MongoDBä¹‹ç±»çš„ç»„åˆï¼ŒåŸå› æ˜¯RabbitMQå°½ç®¡è¶³å¤Ÿå¼ºå¤§ï¼Œä½†å¯¹äºä¸€äº›ç›¸å¯¹ç®€å•çš„ä¸šåŠ¡ç¯å¢ƒæ¥è¯´å¯èƒ½å¤ªå¤šï¼ˆå¤æ‚ï¼‰äº†ä¸€äº›ã€‚</p><!-- more --><h1 id="Celery-RabbitMQæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ"><a href="#Celery-RabbitMQæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ" class="headerlink" title="Celery+RabbitMQæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ"></a>Celery+RabbitMQæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h1><p>å…³äºCeleryå’ŒRabbitMQçš„åä½œæ–¹å¼ï¼Œå¯ä»¥é€šè¿‡å·¥ä½œä¸Šçš„ä¸€äº›æ¡ˆä¾‹æ¥è¯´æ˜ï¼š</p><p>å‡è®¾Aå…¬å¸æœ€è¿‘åœ¨å¼€ä¸‹å¹´åº¦å·¥ä½œä¼šè®®ï¼Œä¼šè®®ä¸Šè¦ç¡®å®šä¸‹ä¸€å¹´çš„å·¥ä½œå†…å®¹å’Œè®¡åˆ’ï¼Œå‚ä¼šäººå‘˜æœ‰è€æ¿ï¼ˆä¸‹å‘ä»»åŠ¡è€…ï¼‰ã€éƒ¨é—¨ä¸»ç®¡ï¼ˆCeleryåˆ†é…ä»»åŠ¡è€…ï¼‰ã€éƒ¨é—¨å‘˜å·¥ï¼ˆå·¥ä½œè€…ï¼‰ã€è€æ¿ç§˜ä¹¦ï¼ˆæ²Ÿé€šåè°ƒè€…RabbitMQï¼‰ã€‚</p><p>é‚£ä¹ˆè¿™åœºä¼šè®®é¦–å…ˆéœ€è¦ç¡®å®šçš„æ˜¯ä¸‹ä¸€å¹´çš„å…·ä½“å·¥ä½œå†…å®¹ï¼Œè¿™é‡Œå°±ç§°ä¹‹ä¸ºâ€œä»»åŠ¡å†…å®¹â€ã€‚æ¯”å¦‚è€æ¿è¯´æˆ‘ä»¬ä¸‹ä¸€å¹´è¦å¼€å‘å‡ºä¸€æ¬¾ç¤¾äº¤ç±»APPäº§å“ï¼Œéƒ¨é—¨ä¸»ç®¡è¡¨ç¤ºèµåŒï¼Œäºæ˜¯ä¾¿æ„‰å¿«åœ°å®šä¸‹äº†å…·ä½“çš„å·¥ä½œä»»åŠ¡ï¼ˆtaskï¼‰ï¼Œå½“ç„¶å¼€å‘ä¸€æ¬¾ç¤¾äº¤ç±»APPäº§å“æ˜¯è¿™ä¸ªé¡¹ç›®çš„æ€»ä»»åŠ¡ï¼Œå…¶ä¸­å¯ä»¥ç»†åˆ†æˆå¾ˆå¤šå°çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ä¸šåŠ¡æµç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿç•Œé¢æ€ä¹ˆè®¾è®¡ç­‰ã€‚</p><p>åœ¨ç¡®å®šäº†å…·ä½“å·¥ä½œä»»åŠ¡åï¼Œè€æ¿ä¾¿æŠŠè¿™ä¸ªé¡¹ç›®äº¤ç»™äº†éƒ¨é—¨ä¸»ç®¡ï¼ˆCeleryï¼‰ï¼Œéƒ¨é—¨ä¸»ç®¡ç¡®å®šéƒ¨é—¨å‘˜å·¥ä¸­è°å»å®Œæˆè¿™é¡¹ä»»åŠ¡ï¼Œäºæ˜¯æŒ‡å®šæŸä¸ªäººï¼ˆWorkerï¼‰ï¼Œä¹Ÿå¯ä»¥å¤šä¸ªäººã€‚ </p><p>å‘å¸ƒå·¥ä½œä»»åŠ¡çš„äººæ˜¯è€æ¿ï¼ˆä¸‹å‘ä»»åŠ¡è€…ï¼‰ï¼Œä»–æŒ‡å®šäº†éƒ¨é—¨ä¸»ç®¡ï¼ˆCeleryï¼‰ä»€ä¹ˆæ—¶å€™å»å®Œæˆå“ªäº›ä»»åŠ¡ï¼Œå¹¶è¦æ±‚è·å–åé¦ˆä¿¡æ¯ã€‚ä½†æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œè€æ¿åªç®¡å¸ƒç½®ä»»åŠ¡ï¼Œä¸å‚ä¸å…·ä½“çš„ä»»åŠ¡åˆ†é…ï¼Œè¿™ä¸ªä»»åŠ¡åˆ†é…çš„å·¥ä½œæ˜¯äº¤ç»™éƒ¨é—¨ä¸»ç®¡ï¼ˆCeleryï¼‰å»æ‰§è¡Œã€‚ </p><p>é¡¹ç›®ä¹‹åˆï¼Œè€æ¿ï¼ˆä¸‹å‘ä»»åŠ¡è€…ï¼‰é€šè¿‡å…¬å¸ä¼šè®®å°†ä»»åŠ¡ä¼ é€’ç»™éƒ¨é—¨ä¸»ç®¡ï¼ˆCeleryï¼‰ï¼Œéƒ¨é—¨ä¸»ç®¡é€šè¿‡éƒ¨é—¨ä¼šè®®å°†ä»»åŠ¡åˆ†é…ç»™å‘˜å·¥ï¼ˆWorkerï¼‰ï¼Œè¿‡æ®µæ—¶é—´å†å°†ä»»åŠ¡ç»“æœåé¦ˆç»™è€æ¿ã€‚ç„¶è€Œéšç€ä»»åŠ¡è¶Šæ¥è¶Šå¤šï¼Œéƒ¨é—¨ä¸»ç®¡å‘ç°ä»»åŠ¡å¤ªå¤šï¼Œæ¯ä¸ªä»»åŠ¡éƒ½è¦åé¦ˆç»“æœï¼Œè®°ä¸ä½ï¼Œä¹Ÿå®¹æ˜“å¼„ä¹±ï¼Œå¯¼è‡´æ•ˆç‡ä¸‹é™ã€‚ </p><p>åœ¨å¬å¼€ä¼šè®®å•†é‡äº†ä¸€ç•ªåï¼Œè€æ¿ç§˜ä¹¦ï¼ˆæ²Ÿé€šåè°ƒè€…RabbitMQï¼‰ç«™èµ·æ¥è¯´ï¼šâ€œæˆ‘æœ‰ä¸ªæè®®ï¼Œè€æ¿æ¯å¤©å°†å¸ƒç½®çš„ä»»åŠ¡å†™æˆä¸€å¼ çº¸æ¡æ”¾åˆ°æˆ‘è¿™ï¼Œç„¶åéƒ¨é—¨ä¸»ç®¡æ¯å¤©æ—©ä¸Šæ¥å–å¹¶äº¤ç»™å‘˜å·¥ï¼Œè‡³äºçº¸æ¡ä¸Šçš„ä»»åŠ¡å¦‚ä½•åˆ†é…ï¼Œéƒ¨é—¨ä¸»ç®¡å†³å®šå°±è¡Œï¼Œä½†æ˜¯è¦å°†ç»“æœåŒæ ·å†™ä¸€å¼ çº¸æ¡åé¦ˆç»™æˆ‘ï¼Œæˆ‘å†äº¤ç»™è€æ¿ã€‚è¿™æ ·è€æ¿åªè´Ÿè´£ä¸‹å‘ä»»åŠ¡ï¼Œæˆ‘åªè´Ÿè´£ä¿ç®¡ä»»åŠ¡çº¸æ¡ï¼Œéƒ¨é—¨ä¸»ç®¡åªè´Ÿè´£åˆ†é…ä»»åŠ¡å¹¶è·å–åé¦ˆï¼Œå‘˜å·¥åªè´Ÿè´£æŒ‰ä»»åŠ¡å·¥ä½œã€‚å¤§å®¶èŒè´£éƒ½å¾ˆæ˜ç¡®ï¼Œæ•ˆç‡è‚¯å®šä¼šæ›´é«˜ã€‚â€è‡³æ­¤ï¼Œè€æ¿ä¸å‘˜å·¥çš„æ²Ÿé€šé—®é¢˜ä¹Ÿè§£å†³äº†ã€‚</p><h1 id="Celeryä»‹ç»å’ŒåŸºæœ¬ä½¿ç”¨"><a href="#Celeryä»‹ç»å’ŒåŸºæœ¬ä½¿ç”¨" class="headerlink" title="Celeryä»‹ç»å’ŒåŸºæœ¬ä½¿ç”¨"></a>Celeryä»‹ç»å’ŒåŸºæœ¬ä½¿ç”¨</h1><p>Celeryæ˜¯ä¸€ä¸ªåŸºäºPythonå¼€å‘çš„åˆ†å¸ƒå¼å¼‚æ­¥æ¶ˆæ¯ä»»åŠ¡é˜Ÿåˆ—ï¼Œå®ƒç®€å•ã€çµæ´»ã€å¯é ï¼Œæ˜¯ä¸€ä¸ªä¸“æ³¨äºå®æ—¶å¤„ç†çš„ä»»åŠ¡é˜Ÿåˆ—ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒä»»åŠ¡è°ƒåº¦ã€‚é€šè¿‡å®ƒå¯ä»¥è½»æ¾çš„å®ç°ä»»åŠ¡çš„å¼‚æ­¥å¤„ç†ï¼Œå¦‚æœä½ çš„ä¸šåŠ¡åœºæ™¯ä¸­éœ€è¦ç”¨åˆ°å¼‚æ­¥ä»»åŠ¡ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨Celeryã€‚ä¸¾å‡ ä¸ªé€‚ç”¨åœºæ™¯ï¼š</p><p>1ï¼‰å¯ä»¥åœ¨ Request-Response å¾ªç¯ä¹‹å¤–æ‰§è¡Œçš„æ“ä½œï¼šå‘é€é‚®ä»¶ã€æ¨é€æ¶ˆæ¯ã€‚</p><p>2ï¼‰è€—æ—¶çš„æ“ä½œï¼šè°ƒç”¨ç¬¬ä¸‰æ–¹ APIã€è§†é¢‘å¤„ç†ï¼ˆå‰ç«¯é€šè¿‡ AJAX å±•ç¤ºè¿›åº¦å’Œç»“æœï¼‰ã€‚</p><p>3ï¼‰å‘¨æœŸæ€§ä»»åŠ¡ï¼šå–ä»£ crontabã€‚</p><h2 id="Celeryæœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹"><a href="#Celeryæœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹" class="headerlink" title="Celeryæœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹"></a>Celeryæœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹</h2><p>ç®€å•ï¼šä¸€æ—¦ç†Ÿæ‚‰äº†Celeryçš„å·¥ä½œæµç¨‹åï¼Œé…ç½®å’Œä½¿ç”¨æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚</p><p>é«˜å¯ç”¨ï¼šå½“ä»»åŠ¡æ‰§è¡Œå¤±è´¥æˆ–æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿè¿æ¥ä¸­æ–­ï¼ŒCelery ä¼šè‡ªåŠ¨å°è¯•é‡æ–°æ‰§è¡Œä»»åŠ¡ã€‚</p><p>å¿«é€Ÿï¼šä¸€ä¸ªå•è¿›ç¨‹çš„Celeryæ¯åˆ†é’Ÿå¯å¤„ç†ä¸Šç™¾ä¸‡ä¸ªä»»åŠ¡ã€‚</p><p>çµæ´»ï¼š Celeryçš„å¤§éƒ¨åˆ†ç»„ä»¶éƒ½å¯ä»¥è¢«æ‰©å±•åŠè‡ªå®šåˆ¶ã€‚</p><h1 id="é€‰æ‹©Broker"><a href="#é€‰æ‹©Broker" class="headerlink" title="é€‰æ‹©Broker"></a>é€‰æ‹©Broker</h1><p>Celeryçš„åŸºæœ¬æ¶æ„å’Œå·¥ä½œæµç¨‹å¦‚ä¸‹å›¾<br><img src="https://box.kancloud.cn/5d8cf93818f7bc7ad2c04306c4221354_1000x115.png" srcset="/img/loading.gif" alt=""></p><p>å¸¸ç”¨çš„Brokeræœ‰RabbitMQã€Redisã€æ•°æ®åº“ç­‰ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æ˜¯RabbitMQ</p><p><img src="https://box.kancloud.cn/155ab4d48f8625d34409f0f6a7e8da72_1000x768.png" srcset="/img/loading.gif" alt=""></p><h1 id="Celeryå®‰è£…ä½¿ç”¨"><a href="#Celeryå®‰è£…ä½¿ç”¨" class="headerlink" title="Celeryå®‰è£…ä½¿ç”¨"></a>Celeryå®‰è£…ä½¿ç”¨</h1><p>Celeryæ˜¯ä¸€ä¸ªPythonçš„åº”ç”¨ï¼Œè€Œä¸”å·²ç»ä¸Šä¼ åˆ°äº†PyPiï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨pipæˆ–easy_installå®‰è£…ï¼š</p><pre><code>pip install celerypip install eventlet</code></pre><h1 id="åˆ›å»ºApplicationå’ŒTask"><a href="#åˆ›å»ºApplicationå’ŒTask" class="headerlink" title="åˆ›å»ºApplicationå’ŒTask"></a>åˆ›å»ºApplicationå’ŒTask</h1><p>Celeryçš„é»˜è®¤brokeræ˜¯RabbitMQï¼Œä»…éœ€é…ç½®ä¸€è¡Œå°±å¯ä»¥ï¼š</p><pre><code>broker_url = &amp;#039;amqp://guest:guest@localhost:5672//&amp;#039;</code></pre><p>åˆ›å»ºä¸€ä¸ªCelery Applicationç”¨æ¥å®šä¹‰ä»»åŠ¡åˆ—è¡¨ã€‚<br>å®ä¾‹åŒ–ä¸€ä¸ªCeleryå¯¹è±¡appï¼Œç„¶åé€šè¿‡@app.task è£…é¥°å™¨æ³¨å†Œä¸€ä¸ª taskã€‚ä»»åŠ¡æ–‡ä»¶å°±å«tasks.pyï¼š</p><pre><code>from celery import Celeryapp = Celery(__name__, broker=&amp;#039;amqp://guest:guest@localhost:5672//&amp;#039;)@app.taskdef add(x, y):           return x + y</code></pre><h1 id="è¿è¡Œ-workerï¼Œå¯åŠ¨Celery-Workeræ¥å¼€å§‹ç›‘å¬å¹¶æ‰§è¡Œä»»åŠ¡"><a href="#è¿è¡Œ-workerï¼Œå¯åŠ¨Celery-Workeræ¥å¼€å§‹ç›‘å¬å¹¶æ‰§è¡Œä»»åŠ¡" class="headerlink" title="è¿è¡Œ workerï¼Œå¯åŠ¨Celery Workeræ¥å¼€å§‹ç›‘å¬å¹¶æ‰§è¡Œä»»åŠ¡"></a>è¿è¡Œ workerï¼Œå¯åŠ¨Celery Workeræ¥å¼€å§‹ç›‘å¬å¹¶æ‰§è¡Œä»»åŠ¡</h1><p>åœ¨ tasks.py æ–‡ä»¶æ‰€åœ¨ç›®å½•è¿è¡Œ</p><pre><code>celery worker -A tasks.app -l INFO  -P eventlet</code></pre><p>è¿™ä¸ªå‘½ä»¤ä¼šå¼€å¯ä¸€ä¸ªåœ¨å‰å°è¿è¡Œçš„ workerï¼Œè§£é‡Šè¿™ä¸ªå‘½ä»¤çš„æ„ä¹‰ï¼š</p><p>worker: è¿è¡Œ worker æ¨¡å—ã€‚</p><p>-A: â€“app=APP, æŒ‡å®šä½¿ç”¨çš„ Celery å®ä¾‹ã€‚</p><p>-l: â€“loglevel=INFO, æŒ‡å®šæ—¥å¿—çº§åˆ«ï¼Œå¯é€‰ï¼šDEBUG, INFO, WARNING, ERROR, CRITICAL, FATAL</p><p>å…¶å®ƒå¸¸ç”¨çš„é€‰é¡¹ï¼š</p><p>-P: â€“pool=prefork, å¹¶å‘æ¨¡å‹ï¼Œå¯é€‰ï¼šprefork (é»˜è®¤ï¼Œmultiprocessing), eventlet, gevent, threads.</p><p>-c: â€“concurrency=10, å¹¶å‘çº§åˆ«ï¼Œprefork æ¨¡å‹ä¸‹å°±æ˜¯å­è¿›ç¨‹æ•°é‡ï¼Œé»˜è®¤ç­‰äº CPU æ ¸å¿ƒæ•°</p><p>å®Œæ•´çš„å‘½ä»¤è¡Œé€‰é¡¹å¯ä»¥è¿™æ ·æŸ¥çœ‹ï¼š</p><pre><code>celery worker --help</code></pre><h1 id="è°ƒç”¨Task"><a href="#è°ƒç”¨Task" class="headerlink" title="è°ƒç”¨Task"></a>è°ƒç”¨Task</h1><p>å†æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œ è¿›è¡Œå‘½ä»¤è¡Œæ¨¡å¼ï¼Œè°ƒç”¨ä»»åŠ¡</p><pre><code>from tasks import addadd.delay(1,2)add.apply_async(args=(1,2))</code></pre><p>ä¸Šé¢ä¸¤ç§è°ƒç”¨æ–¹å¼ç­‰ä»·ï¼Œdelay() æ–¹æ³•æ˜¯ apply_async() æ–¹æ³•çš„ç®€å†™ã€‚è¿™ä¸ªè°ƒç”¨ä¼šæŠŠ add æ“ä½œæ”¾å…¥åˆ°é˜Ÿåˆ—é‡Œï¼Œç„¶åç«‹å³è¿”å›ä¸€ä¸ª AsyncResult å¯¹è±¡ã€‚å¦‚æœå…³å¿ƒå¤„ç†ç»“æœï¼Œéœ€è¦ç»™ app é…ç½® CELERY_RESULT_BACKENDï¼ŒæŒ‡å®šä¸€ä¸ªå­˜å‚¨åç«¯ä¿å­˜ä»»åŠ¡çš„è¿”å›å€¼ã€‚</p><h1 id="åœ¨é¡¹ç›®ä¸­çš„ç®€å•ä½¿ç”¨æµç¨‹"><a href="#åœ¨é¡¹ç›®ä¸­çš„ç®€å•ä½¿ç”¨æµç¨‹" class="headerlink" title="åœ¨é¡¹ç›®ä¸­çš„ç®€å•ä½¿ç”¨æµç¨‹"></a>åœ¨é¡¹ç›®ä¸­çš„ç®€å•ä½¿ç”¨æµç¨‹</h1><p>1ï¼‰RabbitMQæ‰€åœ¨æœåŠ¡å™¨ï¼Œå¯åŠ¨crontabè®¾ç½®  crontable -user user -eè®¾ç½®å®šæ—¶æ‰§è¡Œcelery applicationåº”ç”¨ã€‚</p><pre><code>python tasks.py day </code></pre><p>åœ¨task.pyæ–‡ä»¶é‡Œé¢å¯åŠ¨ä¸€ä¸ªå«åšappçš„Celery Applicationï¼Œç¼–å†™ä¸€ä¸ªapp.taskå‡½æ•°æ¥produce ä»»åŠ¡åˆ°rabbitmqã€‚</p><pre><code>app = Celery()app.config_from_object(celeryconfig)</code></pre><p>åœ¨æ¯ä¸ªworkeré‡Œé¢é€šè¿‡å‘½ä»¤å¯åŠ¨workeræ¶ˆè´¹ä»»åŠ¡</p><pre><code>celery worker -A tasks.app -l INFO  -P eventlet</code></pre><h1 id="Celeryä»‹ç»å’ŒåŸºæœ¬ä½¿ç”¨-1"><a href="#Celeryä»‹ç»å’ŒåŸºæœ¬ä½¿ç”¨-1" class="headerlink" title="Celeryä»‹ç»å’ŒåŸºæœ¬ä½¿ç”¨"></a>Celeryä»‹ç»å’ŒåŸºæœ¬ä½¿ç”¨</h1><p><strong>éœ€æ±‚åœºæ™¯</strong></p><ol><li><p>å¯¹100å°å‘½ä»¤æ‰§è¡Œä¸€æ¡æ‰¹é‡å‘½ä»¤ï¼Œå‘½ä»¤æ‰§è¡Œéœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œä½†æ˜¯ä¸æƒ³è®©ä¸»ç¨‹åºç­‰ç€ç»“æœè¿”å›ï¼Œè€Œæ˜¯ç»™ä¸»ç¨‹åºè¿”å›ä¸€ä¸ªä»»åŠ¡IDï¼Œtask_id<br>ä¸»ç¨‹åºè¿‡ä¸€æ®µæ—¶é—´æ ¹æ®task_idï¼Œè·å–æ‰§è¡Œç»“æœå³å¯ï¼Œå†å‘½ä»¤æ‰§è¡ŒæœŸé—´ï¼Œä¸»ç¨‹åº å¯ä»¥ç»§ç»­åšå…¶ä»–äº‹æƒ…</p></li><li><p>å®šæ—¶ä»»åŠ¡ï¼Œæ¯”å¦‚æ¯å¤©æ£€æµ‹ä¸€ä¸‹æ‰€æœ‰çš„å®¢æˆ·èµ„æ–™ï¼Œå‘ç°æ˜¯å®¢æˆ·çš„ç”Ÿæ—¥ï¼Œå‘ä¸ªç¥ç¦çŸ­ä¿¡</p></li></ol><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p><ol><li>é€»è¾‘view ä¸­å¯ä¸€ä¸ªè¿›ç¨‹</li></ol><p>çˆ¶è¿›ç¨‹ç»“æŸï¼Œå­è¿›ç¨‹è·Ÿç€ç»“æŸï¼Œå­è¿›ç¨‹ä»»åŠ¡æ²¡æœ‰å®Œæˆï¼Œä¸ç¬¦åˆéœ€æ±‚</p><p>çˆ¶è¿›ç¨‹ç»“æŸï¼Œç­‰ç€å­è¿›ç¨‹ç»“æŸï¼Œçˆ¶è¿›ç¨‹éœ€ç­‰ç€ç»“æœè¿”å›ï¼Œä¸ç¬¦åˆéœ€æ±‚</p><p>å°ç»“ï¼šè¯¥æ–¹æ¡ˆè§£å†³ä¸äº†é˜»å¡é—®é¢˜ï¼Œå³éœ€è¦ç­‰å¾… </p><ol start="2"><li>å¯åŠ¨ subprocessï¼Œä»»åŠ¡æ‰˜ç®¡ç»™æ“ä½œç³»ç»Ÿæ‰§è¡Œ</li></ol><p>å®ç°task_idï¼Œå®ç°å¼‚æ­¥ï¼Œè§£å†³é˜»å¡</p><p>å°ç»“ï¼šå¤§æ‰¹é‡é«˜å¹¶å‘ï¼Œä¸»æœåŠ¡å™¨ä¼šå‡ºç°é—®é¢˜ï¼Œè§£å†³ä¸äº†å¹¶å‘</p><ol start="3"><li>celery</li></ol><p>celeryæä¾›å¤šå­èŠ‚ç‚¹ï¼Œè§£å†³å¹¶å‘é—®é¢˜</p><h2 id="celeryä»‹ç»"><a href="#celeryä»‹ç»" class="headerlink" title="celeryä»‹ç»"></a>celeryä»‹ç»</h2><p>celeryæ˜¯ä¸€ä¸ªåŸºäºpythonå¼€å‘çš„åˆ†å¸ƒå¼å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè½»æ¾å®ç°ä»»åŠ¡çš„å¼‚æ­¥å¤„ç†</p><p>celeryåœ¨æ‰§è¡Œä»»åŠ¡æ—¶éœ€è¦ä¸€ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶æ¥æ¥æ”¶å’Œå‘é€ä»»åŠ¡æ¶ˆæ¯ï¼Œä»¥åŠå­˜å‚¨ä»»åŠ¡ç»“æœï¼Œä¸€èˆ¬ä½¿ç”¨RabbitMQ æˆ– Redis</p><h2 id="celeryä¼˜ç‚¹"><a href="#celeryä¼˜ç‚¹" class="headerlink" title="celeryä¼˜ç‚¹"></a>celeryä¼˜ç‚¹</h2><p>ç®€å•ï¼šç†Ÿæ‚‰celeryçš„å·¥ä½œæµç¨‹åï¼Œé…ç½®ä½¿ç”¨ç®€å•</p><p>é«˜å¯ç”¨ï¼šå½“ä»»åŠ¡æ‰§è¡Œå¤±è´¥æˆ–æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿè¿æ¥ä¸­æ–­ï¼Œceleryä¼šè‡ªåŠ¨å°è¯•é‡æ–°æ‰§è¡Œä»»åŠ¡</p><p>å¿«é€Ÿï¼šä¸€ä¸ªå•è¿›ç¨‹çš„celeryæ¯åˆ†é’Ÿå¯å¤„ç†ä¸Šç™¾ä¸‡ä¸ªä»»åŠ¡</p><p>çµæ´»ï¼šå‡ ä¹celeryçš„å„ä¸ªç»„ä»¶éƒ½å¯ä»¥è¢«æ‰©å±•åŠè‡ªå®šåˆ¶</p><h2 id="celeryåŸºæœ¬å·¥ä½œæµç¨‹"><a href="#celeryåŸºæœ¬å·¥ä½œæµç¨‹" class="headerlink" title="celeryåŸºæœ¬å·¥ä½œæµç¨‹"></a>celeryåŸºæœ¬å·¥ä½œæµç¨‹</h2><p><img src="https://box.kancloud.cn/32d19c7420eb9c8c072f1b38ff0f8e41_670x319.png" srcset="/img/loading.gif" alt=""><br>å…¶ä¸­ä¸­é—´é˜Ÿåˆ—ç”¨äºåˆ†é…ä»»åŠ¡ä»¥åŠå­˜å‚¨æ‰§è¡Œç»“æœ</p><h2 id="celeryå®‰è£…åŠä½¿ç”¨"><a href="#celeryå®‰è£…åŠä½¿ç”¨" class="headerlink" title="celeryå®‰è£…åŠä½¿ç”¨"></a>celeryå®‰è£…åŠä½¿ç”¨</h2><ol><li><p>å®‰è£…pythonæ¨¡å—</p><pre><code>pip3 install celerypip3 install redis</code></pre></li><li><p>å®‰è£…redisæœåŠ¡</p><pre><code>wget  http://download.redis.io/releases/redis-3.2.8.tar.gztar -zxvf redis-3.2.8.tar.gzcd redis-3.2.8make</code></pre></li></ol><p>src/redis-server  # å¯åŠ¨redis æœåŠ¡</p><pre><code>3.  åˆ›å»ºä¸€ä¸ªcelery application ç”¨æ¥å®šä¹‰ä»»åŠ¡åˆ—è¡¨åˆ›å»ºä¸€ä¸ªä»»åŠ¡ tasks.py</code></pre><p>from celery import Celery</p><p>app = Celery(&#039;TASK&#039;,<br>             broker=&#039;amqp://guestï¼šguest@localhost:5672//&#039;,<br>             backend=&#039;redis://localhost&#039;)</p><p>@app.task<br>def add(x,y):<br>    print(&quot;runningâ€¦&quot;,x,y)<br>    return x+y</p><pre><code> 4.  å¯åŠ¨celery worker æ¥å¼€å§‹ç›‘å¬å¹¶æ‰§è¡Œä»»åŠ¡</code></pre><p> celery -A tasks worker â€“loglevel=info</p><pre><code>tasks ä»»åŠ¡æ–‡ä»¶åï¼Œworker ä»»åŠ¡è§’è‰²ï¼Œ--loglevel=info ä»»åŠ¡æ—¥å¿—çº§åˆ«5.  è°ƒç”¨ä»»åŠ¡æ‰“å¼€å¦å¤–ç»ˆç«¯ï¼Œè¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼ï¼Œè°ƒç”¨ä»»åŠ¡![](https://box.kancloud.cn/ccf1e9529cc2e20728b3e0ab1c6baa08_573x167.png)6.  celeryå¸¸ç”¨æ¥å£* tasks.add(4,6) ---&amp;gt; æœ¬åœ°æ‰§è¡Œ* tasks.add.delay(3,4) --&amp;gt; workeræ‰§è¡Œ* t=tasks.add.delay(3,4)  --&amp;gt; t.get()  è·å–ç»“æœï¼Œæˆ–å¡ä½ï¼Œé˜»å¡* t.ready()---&amp;gt; Falseï¼šæœªæ‰§è¡Œå®Œï¼ŒTrueï¼šå·²æ‰§è¡Œå®Œ* t.get(propagate=False) æŠ›å‡ºç®€å•å¼‚å¸¸ï¼Œä½†ç¨‹åºä¸ä¼šåœæ­¢* t.traceback è¿½è¸ªå®Œæ•´å¼‚å¸¸# é¡¹ç›®ä¸­ä½¿ç”¨Celery## 1.  é¡¹ç›®ç›®å½•ç»“æ„</code></pre><p>project<br>    |â€“ <strong>init</strong>.py<br>    |â€“ celery.py   # é…ç½®æ–‡æ¡£<br>    |â€“ tasks.py    # ä»»åŠ¡å‡½æ•°<br>    |â€“ tasks2.py   # ä»»åŠ¡å‡½æ•°</p><pre><code>## 2.  é¡¹ç›®æ–‡ä»¶project/celery.py</code></pre><h1 id="from-celery-import-Celery-é»˜è®¤å½“å‰è·¯å¾„ï¼Œæ›´æ”¹ä¸ºç»å¯¹è·¯å¾„-å½“å‰è·¯å¾„æœ‰ä¸ªcelery-pyæ–‡ä»¶å•¦"><a href="#from-celery-import-Celery-é»˜è®¤å½“å‰è·¯å¾„ï¼Œæ›´æ”¹ä¸ºç»å¯¹è·¯å¾„-å½“å‰è·¯å¾„æœ‰ä¸ªcelery-pyæ–‡ä»¶å•¦" class="headerlink" title="from celery import Celery é»˜è®¤å½“å‰è·¯å¾„ï¼Œæ›´æ”¹ä¸ºç»å¯¹è·¯å¾„(å½“å‰è·¯å¾„æœ‰ä¸ªcelery.pyæ–‡ä»¶å•¦)"></a>from celery import Celery é»˜è®¤å½“å‰è·¯å¾„ï¼Œæ›´æ”¹ä¸ºç»å¯¹è·¯å¾„(å½“å‰è·¯å¾„æœ‰ä¸ªcelery.pyæ–‡ä»¶å•¦)</h1><p>from celery import Celery</p><p>app = Celery(&#039;project&#039;,<br>             broker=&#039;redis://localhost&#039;,<br>             backend=&#039;redis://localhost&#039;,<br>             include=[&#039;project.tasks&#039;,&#039;project.tasks2&#039;])  # é…ç½®æ–‡ä»¶å’Œä»»åŠ¡æ–‡ä»¶åˆ†å¼€äº†ï¼Œå¯ä»¥å†™å¤šä¸ªä»»åŠ¡æ–‡ä»¶</p><h1 id="app-æ‰©å±•é…ç½®"><a href="#app-æ‰©å±•é…ç½®" class="headerlink" title="app æ‰©å±•é…ç½®"></a>app æ‰©å±•é…ç½®</h1><p>app.conf.update(<br>    result_expires=3600,<br>)</p><p>if <strong>name</strong> == &#039;<strong>main</strong>&#039;:<br>    app.start()</p><pre><code>celery.pyä½œç”¨ç›¸å½“äºé…ç½®æ–‡ä»¶project/tasks.py</code></pre><p>from .celery import app</p><p>@app.task<br>def add(x, y):<br>    return x + y</p><p>@app.task<br>def mul(x, y):<br>    return x * y</p><pre><code>project/tasks.py</code></pre><p>from .celery import app</p><p>@app.task<br>def hello():<br>    return &#039;Hello World&#039;</p><pre><code>3.  å¯åŠ¨é¡¹ç›®worker</code></pre><p>celery -A project worker -l info</p><pre><code>å¦å¯ç»ˆç«¯ï¼Œä¸projectåŒç›®å½•è¿›å…¥python3![](https://box.kancloud.cn/4abe47350dd74f51919d94120f8a98b4_585x245.png)4.  å®ç°åˆ†å¸ƒå¼ å½“å¯åŠ¨å¤šä¸ªæ—¶ celery -A project worker -l infoï¼Œå»brokerå»ç›¸åº”ä»»åŠ¡ï¼Œå®ç°åˆ†å¸ƒå¼5.  åå°å¯åŠ¨woker</code></pre><p>celery multi start w1 -A project -l info<br>celery multi start w2 -A project -l info<br>celery multi start w3 -A project -l info</p><p>celery multi restart w1 -A project -l info<br>celery multi stop w1 w2 w3        # ä»»åŠ¡ç«‹åˆ»åœæ­¢<br>celery multi stopwait w1 w2 w3    # ä»»åŠ¡æ‰§è¡Œå®Œï¼Œåœæ­¢</p><pre><code>#  Celeryå®šæ—¶ä»»åŠ¡celeryæ”¯æŒå®šæ—¶ä»»åŠ¡ï¼Œè®¾å®šå¥½ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ï¼Œceleryå°±ä¼šå®šæ—¶å¸®ä½ æ‰§è¡Œï¼Œè¿™ä¸ªå®šæ—¶ä»»åŠ¡æ¨¡å—å« celery beaté¡¹ç›®ç›®å½•ç»“æ„</code></pre><p>project<br>    |â€“ <strong>init</strong>.py<br>    |â€“ celery.py          # é…ç½®æ–‡ä»¶<br>    |â€“ periodic_task.py   # å®šæ—¶ä»»åŠ¡æ–‡ä»¶</p><pre><code>è„šæœ¬celery.py</code></pre><p>from celery import Celery</p><p>app = Celery(&#039;project&#039;,<br>             broker=&#039;redis://localhost&#039;,<br>             backend=&#039;redis://localhost&#039;,<br>             include=[&#039;project.periodic_task&#039;,])</p><p>app.conf.update(<br>    result_expires=3600,<br>)</p><p>if <strong>name</strong> == &#039;<strong>main</strong>&#039;:<br>    app.start()</p><pre><code>è„šæœ¬periodic_task.py</code></pre><p>from .celery import app<br>from celery.schedules import crontab</p><p>@app.on_after_configure.connect<br>def setup_periodic_tasks(sender, **kwargs):<br>    # æ¯10sè°ƒç”¨ test(&#039;hello&#039;)<br>    sender.add_periodic_task(10.0, test.s(&#039;hello&#039;), name=&#039;add every 10&#039;)</p><pre><code># æ¯20sè°ƒç”¨ test(&amp;#039;world&amp;#039;)sender.add_periodic_task(20.0, test.s(&amp;#039;world&amp;#039;), expires=10)# æ¯å‘¨ä¸€æ—©ä¸Š7:30 æ‰§è¡Œ test(&amp;#039;Happy Mondays!&amp;#039;)sender.add_periodic_task(    crontab(hour=7, minute=30, day_of_week=1), # å¯çµæ´»ä¿®æ”¹    test.s(&amp;#039;Happy Mondays!&amp;#039;),)</code></pre><p>@app.task<br>def test(arg):<br>    print(arg)</p><pre><code>å¯åŠ¨è§’è‰² worker  æ‰§è¡Œä»»åŠ¡</code></pre><p>celery -A project worker -l info</p><pre><code>å¯åŠ¨è§’è‰² beat å°†å®šæ—¶ä»»åŠ¡æ”¾åˆ°é˜Ÿåˆ—ä¸­</code></pre><p>celery -A  project.periodic_task  beat  -l  debug</p><pre><code>ä¹Ÿå¯ä»¥åœ¨é…ç½®æ–‡ä»¶celery.py é‡Œæ·»åŠ å®šæ—¶ä»»åŠ¡</code></pre><p>app.conf.beat_schedule = {<br>    &#039;add-every-30-seconds&#039;: {<br>        &#039;task&#039;: &#039;project.tasks.add&#039;,<br>        &#039;schedule&#039;: 30.0,<br>        &#039;args&#039;: (16, 16)<br>    },<br>}<br>app.conf.timezone = &#039;UTC&#039;</p><pre><code># Celeryä¸Djangoç»“åˆ</code></pre><p>LearnCelery<br>   |â€“ app1<br>        |â€“ tasks.py<br>        |â€“ models.py<br>   |â€“ app2<br>        |â€“ tasks.py<br>        |â€“ models.py<br>   |â€“ LearnCelery<br>        |â€“ <strong>init</strong>.py<br>        |â€“ celery.py<br>        |â€“ settings.py</p><pre><code>è„šæœ¬ä»£ç LearnCelery/app/tasks.py   # å¿…é¡»å«è¿™ä¸ªåå­—</code></pre><p>from celery import shared_task<br>import time</p><h1 id="æ‰€æœ‰çš„appéƒ½å¯ä»¥è°ƒç”¨"><a href="#æ‰€æœ‰çš„appéƒ½å¯ä»¥è°ƒç”¨" class="headerlink" title="æ‰€æœ‰çš„appéƒ½å¯ä»¥è°ƒç”¨"></a>æ‰€æœ‰çš„appéƒ½å¯ä»¥è°ƒç”¨</h1><p>@shared_task<br>def add(x, y):<br>    time.sleep(10)<br>    return x + y</p><p>@shared_task<br>def mul(x, y):<br>    time.sleep(10)<br>    return x * y</p><pre><code>LearnCelery/LearnCelery/__init__.py</code></pre><h1 id="This-will-make-sure-the-app-is-always-imported-when"><a href="#This-will-make-sure-the-app-is-always-imported-when" class="headerlink" title="This will make sure the app is always imported when"></a>This will make sure the app is always imported when</h1><h1 id="Django-starts-so-that-shared-task-will-use-this-app"><a href="#Django-starts-so-that-shared-task-will-use-this-app" class="headerlink" title="Django starts so that shared_task will use this app."></a>Django starts so that shared_task will use this app.</h1><p>from .celery import app as celery_app</p><p><strong>all</strong> = [&#039;celery_app&#039;]</p><pre><code>LearnCelery/LearnCelery/celery.py</code></pre><p>import os<br>from celery import Celery</p><h1 id="å•ç‹¬è„šæœ¬è°ƒç”¨Djangoå†…å®¹æ—¶ï¼Œéœ€é…ç½®è„šæœ¬çš„ç¯å¢ƒå˜é‡"><a href="#å•ç‹¬è„šæœ¬è°ƒç”¨Djangoå†…å®¹æ—¶ï¼Œéœ€é…ç½®è„šæœ¬çš„ç¯å¢ƒå˜é‡" class="headerlink" title="å•ç‹¬è„šæœ¬è°ƒç”¨Djangoå†…å®¹æ—¶ï¼Œéœ€é…ç½®è„šæœ¬çš„ç¯å¢ƒå˜é‡"></a>å•ç‹¬è„šæœ¬è°ƒç”¨Djangoå†…å®¹æ—¶ï¼Œéœ€é…ç½®è„šæœ¬çš„ç¯å¢ƒå˜é‡</h1><p>os.environ.setdefault(&#039;DJANGO_SETTINGS_MODULE&#039;, &#039;mysite.settings&#039;)</p><p>app = Celery(&#039;mysite&#039;)</p><h1 id="CELERY-ä½œä¸ºå‰ç¼€ï¼Œåœ¨settingsä¸­å†™é…ç½®"><a href="#CELERY-ä½œä¸ºå‰ç¼€ï¼Œåœ¨settingsä¸­å†™é…ç½®" class="headerlink" title="CELERY_ ä½œä¸ºå‰ç¼€ï¼Œåœ¨settingsä¸­å†™é…ç½®"></a>CELERY_ ä½œä¸ºå‰ç¼€ï¼Œåœ¨settingsä¸­å†™é…ç½®</h1><p>app.config_from_object(&#039;django.conf:settings&#039;, namespace=&#039;CELERY&#039;)</p><h1 id="åˆ°Djangoå„ä¸ªappä¸‹ï¼Œè‡ªåŠ¨å‘ç°tasks-py-ä»»åŠ¡è„šæœ¬"><a href="#åˆ°Djangoå„ä¸ªappä¸‹ï¼Œè‡ªåŠ¨å‘ç°tasks-py-ä»»åŠ¡è„šæœ¬" class="headerlink" title="åˆ°Djangoå„ä¸ªappä¸‹ï¼Œè‡ªåŠ¨å‘ç°tasks.py ä»»åŠ¡è„šæœ¬"></a>åˆ°Djangoå„ä¸ªappä¸‹ï¼Œè‡ªåŠ¨å‘ç°tasks.py ä»»åŠ¡è„šæœ¬</h1><p>app.autodiscover_tasks()</p><p>@app.task(bind=True)<br>def debug_task(self):<br>    print(&#039;Request: {0!r}&#039;.format(self.request))</p><pre><code>LearnCelery/LearnCelery/settings.py</code></pre><h1 id="For-celery"><a href="#For-celery" class="headerlink" title="For celery"></a>For celery</h1><p>CELERY_BROKER_URL = &#039;redis://localhost&#039;<br>CELERY_RESULT_BACKEND = &#039;redis://localhost&#039;</p><pre><code>3.  å¯åŠ¨celery</code></pre><p>celery -A LearnCelery worker -l debug</p><pre><code>4.  urls.py è§†å›¾å¤„ç†</code></pre><p>urlpatterns = [<br>    url(r&#039;^celery_call/$&#039;, views.celery_call),<br>    url(r&#039;^celery_res/$&#039;, views.celery_res),<br>]</p><pre><code># djangoä¸­ä½¿ç”¨è®¡åˆ’ä»»åŠ¡1.  å®‰è£…æ’ä»¶</code></pre><p>pip3 install django-celery-beat</p><pre><code>2.  ä¿®æ”¹é…ç½® settings.py</code></pre><p>INSTALLED_APPS = [<br> &#039;django_celery_beat&#039;,<br>]</p><pre><code>3.æ•°æ®åº“è¿ç§»</code></pre><p>python manage.py migrate</p><pre><code>4.  å¯åŠ¨ celery beat</code></pre><p>celery -A LearnCelery beat -l info -S django</p><p>```<br>å®šæ—¶ä»»åŠ¡å­˜åˆ°æ•°æ®åº“é‡Œï¼Œå¯åŠ¨beatå®šæ—¶å–ä»»åŠ¡æ”¾åˆ°é˜Ÿåˆ—é‡Œæ‰§è¡Œ</p><ol start="5"><li>adminç®¡ç†<br><img src="https://box.kancloud.cn/33d360707ed8e3019c407402435e8eac_875x323.png" srcset="/img/loading.gif" alt=""></li></ol><p><img src="https://box.kancloud.cn/b884ec26e2cd1c98d8bf5c480e91a478_1680x1594.png" srcset="/img/loading.gif" alt=""></p><p>æ­¤æ—¶å¯åŠ¨ä½ çš„celery beat å’Œworkerï¼Œä¼šå‘ç°æ¯éš”2åˆ†é’Ÿï¼Œbeatä¼šå‘èµ·ä¸€ä¸ªä»»åŠ¡æ¶ˆæ¯è®©workeræ‰§è¡Œscp_taskä»»åŠ¡</p><p>æ³¨æ„ï¼Œç»æµ‹è¯•ï¼Œæ¯æ·»åŠ æˆ–ä¿®æ”¹ä¸€ä¸ªä»»åŠ¡ï¼Œcelery beatéƒ½éœ€è¦é‡å¯ä¸€æ¬¡ï¼Œè¦ä¸ç„¶æ–°çš„é…ç½®ä¸ä¼šè¢«celery beatè¿›ç¨‹è¯»åˆ°</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>linux</tag>
      
      <tag>MQ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RedisåŸºæœ¬å‘½ä»¤(æ›´æ–°)</title>
    <link href="undefined2018/11/06/2018-08-14-redis%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/"/>
    <url>2018/11/06/2018-08-14-redis%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<p><strong>Redis æ˜¯ä¸€ä¸ªé€Ÿåº¦éå¸¸å¿«çš„éå…³ç³»å‹æ•°æ®åº“ï¼Œä½¿ç”¨å†…å­˜ä½œä¸ºä¸»å­˜å‚¨ï¼Œå†…å­˜ä¸­çš„æ•°æ®ä¹Ÿå¯ä»¥è¢«æŒä¹…åŒ–åˆ°ç¡¬ç›˜ã€‚Redisä»¥é”®å€¼å¯¹å½¢å¼(key-value)å­˜å‚¨æ•°æ®ï¼Œå…¶ä¸­å€¼å¯ä»¥åˆ†ä¸ºä»¥ä¸‹5ä¸­ç±»å‹ï¼š</strong></p><ul><li><a href="#å­—ç¬¦ä¸²">å­—ç¬¦ä¸²(string)</a></li><li><a href="#åˆ—è¡¨">åˆ—è¡¨(list)</a></li><li><a href="#å“ˆå¸Œ">å“ˆå¸Œ(hash)</a></li><li><a href="#é›†åˆ">é›†åˆ(set)</a></li><li><a href="#æœ‰åºé›†åˆ">æœ‰åºé›†åˆ(zset)</a></li><li><a href="#key">key</a></li></ul><a id="more"></a><h3 id="Redis-åŸºæœ¬å‘½ä»¤"><a href="#Redis-åŸºæœ¬å‘½ä»¤" class="headerlink" title="Redis åŸºæœ¬å‘½ä»¤"></a>Redis åŸºæœ¬å‘½ä»¤</h3><h4 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h4><p>Redisçš„å­—ç¬¦ä¸²(string)å¯ä»¥å­˜å‚¨å­—ç¬¦ä¸²ã€æ•´æ•°ã€æµ®ç‚¹æ•°,å€¼æœ€å¤§å­˜å‚¨512mã€‚Stringå‘½ä»¤åŠæè¿°å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><table><thead><tr><th>Stringå‘½ä»¤</th><th>æ è¿°</th></tr></thead><tbody><tr><td>set key value</td><td>è®¾ç½®å­—ç¬¦ä¸²keyçš„å€¼</td></tr><tr><td>get key</td><td>è·å–å­—ç¬¦ä¸²keyçš„å€¼</td></tr><tr><td>del key</td><td>åˆ é™¤key</td></tr><tr><td>strlen key</td><td>è·å–å€¼é•¿åº¦</td></tr><tr><td>mset key1 value1 key2 value2â€¦</td><td>è®¾ç½®å¤šä¸ªå€¼</td></tr><tr><td>mget key1 key2â€¦</td><td>è·å–å¤šä¸ªå€¼</td></tr><tr><td>append key value</td><td>è¿½åŠ å€¼</td></tr><tr><td>incr key</td><td>å°†keyå¯¹åº”çš„å€¼åŠ ä¸€</td></tr><tr><td>decr key</td><td>å°†keyå¯¹åº”çš„å€¼å‡ä¸€</td></tr><tr><td>incrby key intnum</td><td>å°†keyå¯¹åº”çš„å€¼åŠ æ•´æ•°</td></tr><tr><td>decrby key intnum</td><td>å°†keyå¯¹åº”çš„å€¼å‡æ•´æ•°</td></tr></tbody></table><pre><code class="bash">127.0.0.1:6379&gt; mset age 30 sex manOK127.0.0.1:6379&gt; mget age sex1) &quot;30&quot;2) &quot;man&quot;127.0.0.1:6379&gt; append name lisi(integer) 4127.0.0.1:6379&gt; get name&quot;lisi&quot;127.0.0.1:6379&gt; strlen name(integer) 4127.0.0.1:6379&gt; incr age(integer) 31127.0.0.1:6379&gt; incrby age 10(integer) 41127.0.0.1:6379&gt; decr age(integer) 40127.0.0.1:6379&gt; decrby age 20(integer) 20127.0.0.1:6379&gt;</code></pre><h4 id="åˆ—è¡¨"><a href="#åˆ—è¡¨" class="headerlink" title="åˆ—è¡¨"></a>åˆ—è¡¨</h4><p>Redisçš„åˆ—è¡¨(list)å¯ä»¥æœ‰åº(æŒ‰ç…§æ’å…¥é¡ºåºæ’åº)åœ°å­˜å‚¨å¤šä¸ªå­—ç¬¦ä¸²ã€‚Listå‘½ä»¤åŠæè¿°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote><p>ç´¢å¼•å€¼ä»0å¼€å§‹ ï¼Œå¯ä»¥ä¸ºè´Ÿæ•°</p></blockquote><table><thead><tr><th>Listå‘½ä»¤</th><th>æ è¿°</th></tr></thead><tbody><tr><td>lpush key1 value1 value2 â€¦</td><td>åœ¨åˆ—è¡¨keyå·¦ç«¯æ’å…¥ä¸€ä¸ªæˆ–è€…å¤šä¸ªå€¼</td></tr><tr><td>rpush key1 value1 value2 â€¦</td><td>åœ¨åˆ—è¡¨keyåˆç«¯æ’å…¥ä¸€ä¸ªæˆ–è€…å¤šä¸ªå€¼</td></tr><tr><td>linsert key before/after pivot value</td><td>åœ¨ä¸€ä¸ªå…ƒç´ çš„å‰/åæ’å…¥æ–°çš„å…ƒç´ </td></tr><tr><td>lset key index value</td><td>è®¾ç½®æŒ‡å®šç´¢å¼•çš„å…ƒç´ å€¼</td></tr><tr><td>lpop key</td><td>åœ¨åˆ—è¡¨keyå·¦ç«¯å¼¹å‡ºä¸€ä¸ªå€¼</td></tr><tr><td>rpop key</td><td>åœ¨åˆ—è¡¨keyå³ç«¯å¼¹å‡ºä¸€ä¸ªå€¼</td></tr><tr><td>llen key</td><td>è·å–åˆ—è¡¨keyçš„é•¿åº¦</td></tr><tr><td>lindex key index</td><td>è·å–åˆ—è¡¨keyä¸­indexä½ç½®çš„å€¼</td></tr><tr><td>lrange key start end</td><td>è·å–åˆ—è¡¨keyä¸­ä½ç½®åœ¨[start,end]èŒƒå›´çš„å€¼</td></tr><tr><td>ltrim key start end</td><td>è£å‰ªåˆ—è¡¨ï¼Œæ”¹ä¸ºå…ƒé›†åˆçš„ä¸€ä¸ªå­é›†</td></tr></tbody></table><pre><code class="bash">127.0.0.1:6379&gt; lpush fond study game sing(integer) 3127.0.0.1:6379&gt; lrange fond 0 -11) &quot;sing&quot;2) &quot;game&quot;3) &quot;study&quot;127.0.0.1:6379&gt; rpush friends Jane Jack(integer) 2127.0.0.1:6379&gt; linsert friends after Jack kangkang(integer) 3127.0.0.1:6379&gt; lrange friends 0 -11) &quot;Jane&quot;2) &quot;Jack&quot;3) &quot;kangkang&quot;127.0.0.1:6379&gt; lset fond 2 swimOK127.0.0.1:6379&gt; lpop fond&quot;sing&quot;127.0.0.1:6379&gt; rpop friends&quot;kangkang&quot;127.0.0.1:6379&gt; lrange fond 0 -11) &quot;game&quot;2) &quot;swim&quot;127.0.0.1:6379&gt; llen fond(integer) 2127.0.0.1:6379&gt; lindex fond 0&quot;game&quot;127.0.0.1:6379&gt; ltrim friends 0 2OK127.0.0.1:6379&gt; lrange friends 0 -11) &quot;Jane&quot;2) &quot;Jack&quot;</code></pre><h4 id="å“ˆå¸Œ"><a href="#å“ˆå¸Œ" class="headerlink" title="å“ˆå¸Œ"></a>å“ˆå¸Œ</h4><p>Redisçš„å“ˆå¸Œ(Hash)å¯ä»¥å­˜å‚¨å¤šä¸ªé”®å€¼å¯¹ï¼Œå…¶ä¸­çš„é”®å’Œå€¼éƒ½æ˜¯å­—ç¬¦ä¸²ã€‚Hashå‘½ä»¤åŠæè¿°å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><table><thead><tr><th>Hashå‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>hset key field value</td><td>å°†å“ˆå¸Œkeyçš„fieldå­—æ®µèµ‹å€¼ä¸ºvalue</td></tr><tr><td>hmset key field1 value1 field2 value2â€¦</td><td>è®¾ç½®å¤šä¸ªå€¼</td></tr><tr><td>hdel key field1 field2â€¦</td><td>åˆ é™¤å“ˆå¸Œkeyçš„ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µ</td></tr><tr><td>hget key field</td><td>è·å–å“ˆå¸Œkeyçš„fieldå­—æ®µçš„å€¼</td></tr><tr><td>hmget key field1 field2â€¦</td><td>è·å–å¤šä¸ªå±æ€§çš„å€¼</td></tr><tr><td>hgetall key</td><td>è·å–å“ˆå¸Œkeyçš„æ‰€æœ‰å­—æ®µå’Œå€¼</td></tr><tr><td>hkeys key</td><td>è·å–æ‰€æœ‰å±æ€§</td></tr><tr><td>hvals key</td><td>è·å–æ‰€æœ‰å€¼</td></tr><tr><td>hlen  key</td><td>è¿”å›åŒ…å«æ•°æ®çš„ä¸ªæ•°</td></tr><tr><td>hexists key field</td><td>åˆ¤æ–­å±æ€§æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨è¿”å›1ï¼Œä¸å­˜åœ¨è¿”å›0</td></tr><tr><td>hstrlen key field</td><td>è¿”å›å€¼çš„å­—ç¬¦ä¸²é•¿åº¦</td></tr></tbody></table><pre><code class="bash">127.0.0.1:6379&gt; hset point x 10(integer) 1127.0.0.1:6379&gt; hmset point y 20OK127.0.0.1:6379&gt; hget point y&quot;20&quot;127.0.0.1:6379&gt; hmget point(error) ERR wrong number of argu127.0.0.1:6379&gt; hmget point x z1) &quot;10&quot;2) &quot;30&quot;127.0.0.1:6379&gt; hgetall point1) &quot;x&quot;2) &quot;10&quot;3) &quot;y&quot;4) &quot;20&quot;5) &quot;z&quot;6) &quot;30&quot;127.0.0.1:6379&gt; hkeys point1) &quot;x&quot;2) &quot;y&quot;3) &quot;z&quot;127.0.0.1:6379&gt; hvals point1) &quot;10&quot;2) &quot;20&quot;3) &quot;30&quot;127.0.0.1:6379&gt; hlen point(integer) 3127.0.0.1:6379&gt; hexists point w(integer) 0127.0.0.1:6379&gt; hstrlen point x(integer) 2127.0.0.1:6379&gt; hdel point x y z(integer) 3</code></pre><h4 id="é›†åˆ"><a href="#é›†åˆ" class="headerlink" title="é›†åˆ"></a>é›†åˆ</h4><p>Redisä¸­çš„é›†åˆ(set)å¯ä»¥å­˜å‚¨å¤šä¸ªå”¯ä¸€çš„å­—ç¬¦ä¸²,æ˜¯stringç±»å‹çš„æ— åºé›†åˆã€‚setå‘½ä»¤åŠæè¿°å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><table><thead><tr><th>setå‘½ä»¤</th><th>æ è¿°</th></tr></thead><tbody><tr><td>sadd key member1 member2â€¦</td><td>å‘é›†åˆkeyä¸­æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜</td></tr><tr><td>srem key member1 member2â€¦</td><td>åˆ é™¤é›†åˆkeyä¸­ä¸€ä¸ªæˆ–è€…å¤šä¸ªæˆå‘˜</td></tr><tr><td>smembers key</td><td>è·å–é›†åˆkeyä¸­æ‰€æœ‰æˆå‘˜</td></tr><tr><td>scard key</td><td>è·å–é›†åˆkeyä¸­æˆå‘˜æ•°é‡</td></tr><tr><td>sismember key menber</td><td>åˆ¤æ–­memberæ˜¯å¦æ˜¯é›†åˆkeyçš„æˆå‘˜</td></tr><tr><td>sinter key1 key2â€¦</td><td>æ±‚å¤šä¸ªé›†åˆçš„äº¤é›†</td></tr><tr><td>sdiff  key1 key2â€¦</td><td>æ±‚å¤šä¸ªé›†åˆçš„å·®é›†</td></tr><tr><td>sunion key1 key2â€¦</td><td>æ±‚å¤šä¸ªé›†åˆçš„åˆé›†</td></tr></tbody></table><pre><code class="bash">127.0.0.1:6379&gt; sadd color red black blue whi(integer) 4127.0.0.1:6379&gt; smembers color1) &quot;black&quot;2) &quot;white&quot;3) &quot;blue&quot;4) &quot;red&quot;127.0.0.1:6379&gt; scard color(integer) 4127.0.0.1:6379&gt; sismember color yellow(integer) 0127.0.0.1:6379&gt; sadd colors red blue yellow p(integer) 4127.0.0.1:6379&gt; sinter color colors1) &quot;blue&quot;2) &quot;red&quot;127.0.0.1:6379&gt; sdiff color colors1) &quot;black&quot;2) &quot;white&quot;127.0.0.1:6379&gt; sunion color colors1) &quot;yellow&quot;2) &quot;black&quot;3) &quot;pink&quot;4) &quot;white&quot;5) &quot;blue&quot;6) &quot;red&quot;127.0.0.1:6379&gt; srem color red black(integer) 2</code></pre><h4 id="æœ‰åºé›†åˆ"><a href="#æœ‰åºé›†åˆ" class="headerlink" title="æœ‰åºé›†åˆ"></a>æœ‰åºé›†åˆ</h4><p>Redisä¸­çš„æœ‰åºé›†åˆ(ZSet)ä¸é›†åˆ(Set)ç±»ä¼¼ï¼Œå¯ä»¥å­˜å‚¨å¤šä¸ªå”¯ä¸€çš„å­—ç¬¦ä¸²ï¼Œä½†åœ¨æœ‰åºé›†åˆä¸­ï¼Œæ¯ä¸ªæˆå‘˜éƒ½æœ‰ä¸€ä¸ªåˆ†æ•°(score)ï¼Œæ‰€æœ‰æˆå‘˜æŒ‰ç»™å®šåˆ†æ•°åœ¨é›†åˆä¸­ç”±å°åˆ°å¤§æœ‰åºæ’åˆ—ã€‚zsetä¸­æˆå‘˜æ˜¯å”¯ä¸€çš„,ä½†æ˜¯åˆ†æ•°(score)å¯ä»¥ç›¸åŒ.Zsetå‘½ä»¤åŠæè¿°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><table><thead><tr><th>Zsetå‘½ä»¤</th><th>æ è¿°</th></tr></thead><tbody><tr><td>zadd key score1 member1 score2 member2â€¦</td><td>å‘æœ‰åºé›†åˆkeyä¸­æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜</td></tr><tr><td>zrem key member member2 â€¦</td><td>åˆ é™¤æœ‰åºé›†åˆkeyä¸­ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜</td></tr><tr><td>zrange key start stop</td><td>è·å–æœ‰åºé›†åˆkeyä¸­ä½ç½®åœ¨[start,end]èŒƒå›´çš„æ‰€æœ‰æˆå‘˜</td></tr><tr><td>zrangebyscore key min max</td><td>è·å–æœ‰åºé›†åˆkeyä¸­åˆ†å€¼åœ¨[min,max]èŒƒå›´çš„æ‰€æœ‰æˆå‘˜</td></tr><tr><td>zcount key key min max</td><td>è·å–æœ‰åºé›†åˆkeyä¸­åˆ†å€¼åœ¨[min,max]èŒƒå›´çš„ä¸ªæ•°</td></tr><tr><td>zcard key</td><td>è¿”å›å…ƒç´ çš„ä¸ªæ•°</td></tr><tr><td>zscore key member</td><td>è¿”å›æœ‰åºé›†åˆkeyä¸­ï¼Œæˆå‘˜memberçš„åˆ†å€¼</td></tr></tbody></table><pre><code class="bash">127.0.0.1:6379&gt; zadd country 1 China 2 Russia 3 India 4 France(integer) 5127.0.0.1:6379&gt; zrange country 0 -11) &quot;China&quot;2) &quot;Russia&quot;3) &quot;India&quot;4) &quot;France&quot;5) &quot;Italy&quot;127.0.0.1:6379&gt; zrangebyscore country 1 31) &quot;China&quot;2) &quot;Russia&quot;3) &quot;India&quot;127.0.0.1:6379&gt; zcount country 1 4(integer) 4127.0.0.1:6379&gt; zcard country(integer) 5127.0.0.1:6379&gt; zscore country China&quot;1&quot;</code></pre><h4 id="key"><a href="#key" class="headerlink" title="key"></a>key</h4><table><thead><tr><th>keyå‘½ä»¤</th><th>æ è¿°</th></tr></thead><tbody><tr><td>keys pattern</td><td>æŸ¥æ‰¾é”®ï¼Œå‚æ•°æ”¯æŒæ­£åˆ™</td></tr><tr><td>exists key</td><td>åˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨è¿”å›1ï¼Œä¸å­˜åœ¨è¿”å›0</td></tr><tr><td>type key</td><td>æŸ¥çœ‹é”®åŠå¯¹åº”çš„å€¼</td></tr><tr><td>del key1 key2 â€¦</td><td>åˆ é™¤é”®åŠå¯¹åº”çš„å€¼</td></tr><tr><td>expire key seconds</td><td>è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½</td></tr><tr><td>ttl key</td><td>æŸ¥çœ‹æœ‰æ•ˆæ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½</td></tr></tbody></table><blockquote><ul><li>æ›´å¤šå‘½ä»¤è¯·å‚è€ƒå®˜ç½‘ <a href="https://redis.io" target="_blank" rel="noopener">https://redis.io</a></li></ul></blockquote><!-- <meta http-equiv="refresh" content="3"> -->]]></content>
    
    
    
    <tags>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>rabbitMQå¤šä¸ªæ¥æ”¶ç«¯æ¶ˆè´¹ä¿¡æ¯(æ¬è¿æ•´ç†)</title>
    <link href="undefined2018/11/05/2018-11-05-rabbitMQ%E5%A4%9A%E4%B8%AA%E6%8E%A5%E6%94%B6%E7%AB%AF%E6%B6%88%E8%B4%B9%E4%BF%A1%E6%81%AF/"/>
    <url>2018/11/05/2018-11-05-rabbitMQ%E5%A4%9A%E4%B8%AA%E6%8E%A5%E6%94%B6%E7%AB%AF%E6%B6%88%E8%B4%B9%E4%BF%A1%E6%81%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="å¾ªç¯åˆ†å‘"><a href="#å¾ªç¯åˆ†å‘" class="headerlink" title="å¾ªç¯åˆ†å‘"></a>å¾ªç¯åˆ†å‘</h1><p>å¯åŠ¨ä¸€ä¸ªå‘é€ç«¯å¾€é˜Ÿåˆ—å‘æ¶ˆæ¯ï¼Œæ­¤æ—¶å¯åŠ¨å¤šä¸ªæ¥æ”¶ç«¯ã€‚å‘é€çš„æ¶ˆæ¯ä¼šå¯¹æ¥æ”¶ç«¯ä¸€ä¸ªä¸€ä¸ªæŒ¨ç€å‘é€æ¶ˆæ¯ã€‚</p><p>è¿™å°±æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼Œå¤šä¸ªæ¥æ”¶ç«¯è½®æµæ¶ˆè´¹æ¶ˆæ¯ã€‚é˜Ÿåˆ—å‘é€ç»™æ¶ˆè´¹ç«¯åï¼Œå°±ç«‹å³åˆ é™¤ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå½“æŸä¸ªæ¶ˆè´¹è€…åœ¨å¤„ç†æ¶ˆæ¯çš„æ—¶å€™ï¼Œå¼‚å¸¸ç»ˆæ­¢äº†æ€ä¹ˆåŠï¼Ÿæ­¤æ—¶ï¼Œæˆ‘ä»¬æ›´å¸Œæœ›è¿™æ ·ï¼šè‹¥æ˜¯é‚£ä¸ªæ¶ˆè´¹è€…æŒ‚æ‰äº†ï¼Œæ¶ˆæ¯è‡ªåŠ¨è½¬ç»™å¦ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†ã€‚</p><a id="more"></a><p>å¹¸å¥½ï¼Œrabbitmqå°±æœ‰æ•ˆç¡®è®¤æœºåˆ¶ã€‚æ¶ˆè´¹è€…æ”¶åˆ°æ¶ˆæ¯åï¼Œæ­£å¸¸å¤„ç†å®Œæˆï¼Œæ­¤æ—¶æ‰é€šçŸ¥é˜Ÿåˆ—å¯ä»¥è‡ªç”±åˆ é™¤ã€‚é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œæ¶ˆè´¹è€…æŒ‚æ‰äº†è¿ç¡®è®¤æ¶ˆæ¯éƒ½å‘ä¸å‡ºï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿrabbitmqç»´æŒäº†æ¶ˆè´¹è€…çš„è¿æ¥ä¿¡æ¯ã€‚æ¶ˆè´¹è€…æŒ‚æ‰ï¼Œä¸serverçš„è¿æ¥é€šé“ä¼šå…³é—­æˆ–tcpè¿æ¥ä¸¢å¤±ã€‚è¿™æ—¶serverçŸ¥é“äº†è¿™ä¸ªæƒ…å†µï¼Œå°±è‡ªåŠ¨é‡å‘æ¶ˆæ¯ã€‚</p><p>è¿™é‡Œè¿˜æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯serveræŒ‚æ‰äº†æ€ä¹ˆåŠï¼Ÿ<strong>æ³¨æ„ï¼š durable=Trueã€‚è¿™ä¸ªå°±æ˜¯ï¼Œå½“serveræŒ‚äº†é˜Ÿåˆ—è¿˜å­˜åœ¨ã€‚delivery_mode=2ï¼šserveræŒ‚äº†æ¶ˆæ¯è¿˜å­˜åœ¨ã€‚è‹¥æ˜¯ä¿è¯æ¶ˆæ¯ä¸ä¸¢ï¼Œè¿™ä¸¤ä¸ªå‚æ•°éƒ½è¦è®¾ç½®ã€‚</strong></p><p>å‘é€ç«¯</p><pre><code>import pikaimport sysconnection = pika.BlockingConnection(pika.ConnectionParameters(host=&amp;#039;localhost&amp;#039;))channel = connection.channel()# durableï¼šserveræŒ‚äº†é˜Ÿåˆ—ä»ç„¶å­˜åœ¨channel.queue_declare(queue=&amp;#039;task_queue&amp;#039;, durable=True)# ä½¿ç”¨é»˜è®¤çš„äº¤æ¢æœºå‘é€æ¶ˆæ¯ã€‚exchangeä¸ºç©ºå°±ä½¿ç”¨é»˜è®¤çš„ã€‚delivery_mode=2ï¼šä½¿æ¶ˆæ¯æŒä¹…åŒ–ã€‚å’Œé˜Ÿåˆ—åç§°ç»‘å®šrouting_keymessage = &amp;#039; &amp;#039;.join(sys.argv[1:]) or &amp;quot;Hello World!&amp;quot;channel.basic_publish(exchange=&amp;#039;&amp;#039;,routing_key=&amp;#039;task_queue&amp;#039;,body=message,properties=pika.BasicProperties(delivery_mode=2,))print(&amp;quot; [x] Sent %r&amp;quot; % message)connection.close()</code></pre><p>æ¥æ”¶ç«¯</p><pre><code>import pikaimport timeconnection = pika.BlockingConnection(pika.ConnectionParameters(host=&amp;#039;localhost&amp;#039;))channel = connection.channel()channel.queue_declare(queue=&amp;#039;task_queue&amp;#039;, durable=True)print(&amp;#039; [*] Waiting for messages. To exit press CTRL+C&amp;#039;)def callback(ch, method, properties, body):    print(&amp;quot; [x] Received %r&amp;quot; % body)    time.sleep(body.count(b&amp;#039;.&amp;#039;))    print(&amp;quot; [x] Done&amp;quot;)    # æ‰‹åŠ¨å¯¹æ¶ˆæ¯è¿›è¡Œç¡®è®¤    ch.basic_ack(delivery_tag=method.delivery_tag)# basic_consumeï¼šè¿™ä¸ªå‡½æ•°æœ‰no_ackå‚æ•°ã€‚è¯¥å‚æ•°é»˜è®¤ä¸ºfalseã€‚è¡¨ç¤ºï¼šéœ€è¦å¯¹messageè¿›è¡Œç¡®è®¤ã€‚æ€ä¹ˆç†è§£ï¼šnoè®¾ç½®æˆfalseï¼Œè¡¨ç¤ºè¦ç¡®è®¤channel.basic_consume(callback, queue=&amp;#039;task_queue&amp;#039;)channel.start_consuming()</code></pre><h1 id="å…¬å¹³æ´¾é£"><a href="#å…¬å¹³æ´¾é£" class="headerlink" title="å…¬å¹³æ´¾é£"></a>å…¬å¹³æ´¾é£</h1><p>æ­¤åˆ»ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢ï¼Œé‚£ä¹ˆé—®é¢˜åˆæ¥äº†ã€‚æœ‰çš„æ¶ˆè´¹å¹²å¾—å¿«ï¼Œæœ‰çš„å¹²å¾—æ…¢ã€‚è¿™æ ·åˆ†å‘æ¶ˆæ¯ï¼Œæœ‰çš„ç´¯æ­»æœ‰çš„æ²¡äº‹å¹²ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ</p><p><img src="https://box.kancloud.cn/c967559388971bc1277b7021edfcf1c9_396x111.png" srcset="/img/loading.gif" alt=""></p><p>rabbitmqå·²ç»è€ƒè™‘åˆ°äº†ã€‚é‚£å°±æ˜¯ï¼šé‚£ä¸ªå¹²å®Œäº†ï¼Œé€šçŸ¥ç»™serverï¼Œserverå°±å‘é€ç»™é‚£ä¸ªã€‚<br>åœ¨ä¸Šé¢çš„æ¥æ”¶ç«¯çš„</p><pre><code>channel.basic_consume(callback, queue=&amp;#039;task_queue&amp;#039;)</code></pre><p>ä»£ç å‰åŠ ï¼š</p><pre><code>channel.basic_qos(prefetch_count=1)</code></pre><h1 id="å‘å¸ƒè®¢é˜…æ¨¡å¼"><a href="#å‘å¸ƒè®¢é˜…æ¨¡å¼" class="headerlink" title="å‘å¸ƒè®¢é˜…æ¨¡å¼"></a>å‘å¸ƒè®¢é˜…æ¨¡å¼</h1><p>æˆ‘ä»¬è¦å°†åŒä¸€ä¸ªæ¶ˆæ¯å‘ç»™å¤šä¸ªå®¢æˆ·ç«¯ã€‚</p><p>å‘é€ç«¯ï¼š</p><pre><code>import pikaimport syscredentials = pika.PlainCredentials(&amp;quot;yang&amp;quot;, &amp;quot;123456&amp;quot;)connection = pika.BlockingConnection(pika.ConnectionParameters(host=&amp;#039;192.168.2.176&amp;#039;, credentials=credentials))channel = connection.channel()# åŸåˆ™ä¸Šï¼Œæ¶ˆæ¯ï¼Œåªèƒ½æœ‰äº¤æ¢æœºä¼ åˆ°é˜Ÿåˆ—ã€‚å°±åƒæˆ‘ä»¬å®¶é‡Œé¢çš„äº¤æ¢æœºé“ç†ä¸€æ ·ã€‚# æœ‰å¤šä¸ªè®¾å¤‡è¿æ¥åˆ°äº¤æ¢æœºï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªäº¤æ¢æœºæŠŠæ¶ˆæ¯å‘ç»™é‚£ä¸ªè®¾å¤‡å‘¢ï¼Œå°±æ˜¯æ ¹æ®# äº¤æ¢æœºçš„ç±»å‹æ¥å®šã€‚ç±»å‹æœ‰ï¼šdirect\topic\headers\fanout# fanoutï¼šè¿™ä¸ªå°±æ˜¯ï¼Œæ‰€æœ‰çš„è®¾å¤‡éƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯ï¼Œå°±æ˜¯å¹¿æ’­ã€‚# æ­¤å¤„å®šä¹‰ä¸€ä¸ªåç§°ä¸º&amp;#039;logs&amp;#039;çš„&amp;#039;fanout&amp;#039;ç±»å‹çš„exchangechannel.exchange_declare(exchange=&amp;#039;logs&amp;#039;,                         exchange_type=&amp;#039;fanout&amp;#039;)# å°†æ¶ˆæ¯å‘é€åˆ°åä¸ºlogçš„exchangeä¸­# å› ä¸ºæ˜¯fanoutç±»å‹çš„exchangeï¼Œæ‰€ä»¥æ— éœ€æŒ‡å®šrouting_keymessage =  &amp;quot;info: Hello World!&amp;quot;channel.basic_publish(exchange=&amp;#039;logs&amp;#039;,                      routing_key=&amp;#039;&amp;#039;,                      body=message)print(&amp;quot; [x] Sent %r&amp;quot; % message)connection.close()</code></pre><p>æ¥æ”¶ç«¯ï¼š</p><pre><code>import pikacredentials = pika.PlainCredentials(&amp;quot;yang&amp;quot;, &amp;quot;123456&amp;quot;)connection = pika.BlockingConnection(pika.ConnectionParameters(host=&amp;#039;192.168.2.176&amp;#039;, credentials=credentials))channel = connection.channel()# è¿™é‡Œéœ€è¦å’Œå‘é€ç«¯ä¿æŒä¸€è‡´ï¼ˆä¹ æƒ¯å’Œè¦æ±‚ï¼‰channel.exchange_declare(exchange=&amp;#039;logs&amp;#039;,                         exchange_type=&amp;#039;fanout&amp;#039;)# ç±»ä¼¼çš„ï¼Œæ¯”å¦‚logï¼Œæˆ‘ä»¬å…¶å®æœ€æƒ³çœ‹çš„ï¼Œå½“è¿æ¥ä¸Šçš„æ—¶åˆ»åˆ°æ¶ˆè´¹è€…é€€å‡ºï¼Œè¿™æ®µæ—¶é—´çš„æ—¥å¿—# æœ‰äº›æ¶ˆæ¯ï¼Œè¿‡æœŸäº†çš„å¯¹æˆ‘ä»¬å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨# å¹¶ä¸”ï¼Œä¸€ä¸ªç»ˆç«¯ï¼Œæˆ‘ä»¬è¦æ”¶åˆ°é˜Ÿåˆ—çš„æ‰€æœ‰æ¶ˆæ¯ï¼Œæ¯”å¦‚ï¼šè¿™ä¸ªé˜Ÿåˆ—æ”¶åˆ°ä¸¤ä¸ªæ¶ˆæ¯ï¼Œä¸€ä¸ªç»ˆç«¯æ”¶åˆ°ä¸€ä¸ªã€‚# æˆ‘ä»¬ç°åœ¨è¦åšçš„æ˜¯ï¼šä¸¤ä¸ªç»ˆç«¯éƒ½è¦æ”¶åˆ°ä¸¤ä¸ª# é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±åªéœ€åšä¸ªä¸´æ—¶é˜Ÿåˆ—ã€‚æ¶ˆè´¹ç«¯æ–­å¼€åå°±è‡ªåŠ¨åˆ é™¤result = channel.queue_declare(exclusive=True)# å–å¾—é˜Ÿåˆ—åç§°queue_name = result.method.queue# å°†é˜Ÿåˆ—å’Œäº¤æ¢æœºç»‘å®šä¸€èµ·channel.queue_bind(exchange=&amp;#039;logs&amp;#039;,                   queue=queue_name)print(&amp;#039; [*] Waiting for logs. To exit press CTRL+C&amp;#039;)def callback(ch, method, properties, body):    print(&amp;quot; [x] %r&amp;quot; % body)# no_ack=True:æ­¤åˆ»æ²¡å¿…è¦å›åº”äº†channel.basic_consume(callback,                      queue=queue_name,                      no_ack=True)channel.start_consuming()</code></pre><h1 id="æ ¹æ®ç±»å‹è®¢é˜…æ¶ˆæ¯"><a href="#æ ¹æ®ç±»å‹è®¢é˜…æ¶ˆæ¯" class="headerlink" title="æ ¹æ®ç±»å‹è®¢é˜…æ¶ˆæ¯"></a>æ ¹æ®ç±»å‹è®¢é˜…æ¶ˆæ¯</h1><p>ä¸€äº›æ¶ˆæ¯ï¼Œä»ç„¶å‘é€ç»™æ‰€æœ‰æ¥æ”¶ç«¯ã€‚å…¶ä¸­ï¼ŒæŸä¸ªæ¥æ”¶ç«¯ï¼Œåªå¯¹å…¶ä¸­æŸäº›æ¶ˆæ¯æ„Ÿå…´è¶£ï¼Œå®ƒåªæƒ³æ¥æ”¶è¿™ä¸€éƒ¨åˆ†æ¶ˆæ¯ã€‚å¦‚ä¸‹å›¾ï¼šC1ï¼Œåªå¯¹erroræ„Ÿå…´è¶£ï¼ŒC2å¯¹å…¶ä»–ä¸‰ç§ç”šè‡³å¯¹æ‰€æœ‰éƒ½æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆæå‘¢ï¼Ÿ</p><p><img src="https://box.kancloud.cn/65d418b54973525e03432d314234141d_423x171.png" srcset="/img/loading.gif" alt=""></p><p>å‘é€ç«¯ï¼š</p><pre><code>import pikaimport syscredentials = pika.PlainCredentials(&amp;quot;yang&amp;quot;, &amp;quot;123456&amp;quot;)connection = pika.BlockingConnection(pika.ConnectionParameters(host=&amp;#039;192.168.2.176&amp;#039;, credentials=credentials))channel = connection.channel()# åˆ›å»ºä¸€ä¸ªäº¤æ¢æœºï¼šdirect_logs ç±»å‹æ˜¯ï¼šdirectchannel.exchange_declare(exchange=&amp;#039;direct_logs&amp;#039;, exchange_type=&amp;#039;direct&amp;#039;)severity = sys.argv[1] if len(sys.argv) &amp;gt; 1 else &amp;#039;info&amp;#039;message = &amp;#039; &amp;#039;.join(sys.argv[2:]) or &amp;#039;Hello World!&amp;#039;# å‘exchageæŒ‰ç…§è®¾ç½®çš„ routing_key=severity å‘é€messagechannel.basic_publish(exchange=&amp;#039;direct_logs&amp;#039;,                      routing_key=severity,                      body=message)print(&amp;quot; [x] Sent %r:%r&amp;quot; % (severity, message))connection.close()</code></pre><p>æ¥æ”¶ç«¯ï¼š</p><pre><code>import pikaimport syscredentials = pika.PlainCredentials(&amp;quot;yang&amp;quot;, &amp;quot;123456&amp;quot;)connection = pika.BlockingConnection(pika.ConnectionParameters(host=&amp;#039;192.168.2.176&amp;#039;, credentials=credentials))channel = connection.channel()# è·Ÿå‘é€ç«¯ä¸€è‡´channel.exchange_declare(exchange=&amp;#039;direct_logs&amp;#039;,                         exchange_type=&amp;#039;direct&amp;#039;)# è¿˜æ˜¯å£°æ˜ä¸´æ—¶é˜Ÿåˆ—result = channel.queue_declare(exclusive=True)queue_name = result.method.queueseverities = sys.argv[1:]if not severities:    sys.stderr.write(&amp;quot;Usage: %s [info] [warning] [error]\n&amp;quot; % sys.argv[0])    sys.exit(1)# ä½¿ç”¨routing_keyç»‘å®šäº¤æ¢æœºå’Œé˜Ÿåˆ—ã€‚å¹¿æ’­ç±»å‹ï¼Œæ— éœ€ä½¿ç”¨è¿™ä¸ª# directç±»å‹ï¼šä¼šå¯¹æ¶ˆæ¯è¿›è¡Œç²¾ç¡®åŒ¹é…# å¯¹ä¸ªé˜Ÿåˆ—ä½¿ç”¨ç›¸åŒè·¯ç”±keyæ˜¯å¯ä»¥çš„for severity in severities:    channel.queue_bind(exchange=&amp;#039;direct_logs&amp;#039;,                       queue=queue_name,                       routing_key=severity)print(&amp;#039; [*] Waiting for logs. To exit press CTRL+C&amp;#039;)def callback(ch, method, properties, body):    print(&amp;quot; [x] %r:%r&amp;quot; % (method.routing_key, body))channel.basic_consume(callback,                      queue=queue_name,                      no_ack=True)channel.start_consuming()</code></pre><h1 id="è¿›è¡ŒRPCè°ƒç”¨"><a href="#è¿›è¡ŒRPCè°ƒç”¨" class="headerlink" title="è¿›è¡ŒRPCè°ƒç”¨"></a>è¿›è¡ŒRPCè°ƒç”¨</h1><p>RPCï¼šæ˜¯è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ã€‚ç®€å•ç‚¹è¯´ï¼šæ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°çš„ä»£ç ä¸­è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°ä¸ä¸€å®šæœ‰è¿”å›å€¼, ä½†ä¸€å®šæœ‰è¿”å›ã€‚è‹¥æ˜¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œå‰é¢çš„ä¾‹å­ï¼Œå‘é€æ¶ˆæ¯å‡ºå»åï¼Œå‘é€ç«¯æ˜¯ä¸æ¸…æ¥šå®¢æˆ·ç«¯å¤„ç†å®Œåçš„ç»“æœçš„ã€‚ç”±äºrabbitmqçš„å“åº”æœºåˆ¶ï¼Œé¡¶å¤šèƒ½è·å–åˆ°å®¢æˆ·ç«¯çš„å¤„ç†çŠ¶æ€ï¼Œä½†å¹¶ä¸èƒ½è·å–å¤„ç†ç»“æœã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬æƒ³åƒæœ¬åœ°è°ƒç”¨é‚£æ ·ï¼Œéœ€è¦å®¢æˆ·ç«¯å¤„ç†åè¿”å›ç»“æœè¯¥æ€ä¹ˆåŠå‘¢ã€‚å°±æ˜¯å¦‚ä¸‹å›¾ï¼š<br><img src="https://box.kancloud.cn/2e78d61bca855f6c743a3b7fe0e26eaf_576x200.png" srcset="/img/loading.gif" alt=""></p><p>clientå‘é€è¯·æ±‚ï¼ŒåŒæ—¶å‘Šè¯‰serverå¤„ç†å®Œåè¦å‘é€æ¶ˆæ¯ç»™ï¼šå›è°ƒé˜Ÿåˆ—çš„IDï¼šcorrelation_id=abcï¼Œå¹¶è°ƒç”¨replay_toå›è°ƒé˜Ÿåˆ—å¯¹åº”çš„å›è°ƒå‡½æ•°ã€‚</p><h2 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h2><p>å®¢æˆ·ç«¯ï¼šå‘æ¶ˆæ¯ä¹Ÿæ”¶æ¶ˆæ¯</p><pre><code>import pikaimport uuidclass FibonacciRpcClient(object):    def __init__(self):        # åˆ›å»ºè¿æ¥        credentials = pika.PlainCredentials(&amp;quot;yang&amp;quot;, &amp;quot;123456&amp;quot;)        self.connection = pika.BlockingConnection(pika.ConnectionParameters(host=&amp;#039;192.168.2.176&amp;#039;, credentials=credentials))        self.channel = self.connection.channel()        # åˆ›å»ºå›è°ƒé˜Ÿåˆ—        result = self.channel.queue_declare(exclusive=True)        self.callback_queue = result.method.queue        # è¿™é‡Œï¼šè¿™ä¸ªæ˜¯æ¶ˆæ¯å‘é€æ–¹ï¼Œå½“è¦æ‰§è¡Œå›è°ƒçš„æ—¶å€™ï¼Œå®ƒåˆæ˜¯æ¥æ”¶æ–¹        # ä½¿ç”¨callback_queue å®ç°æ¶ˆæ¯æ¥æ”¶ã€‚å³æ˜¯å›è°ƒã€‚æ³¨æ„ï¼šè¿™é‡Œçš„å›è°ƒ        # ä¸éœ€è¦å¯¹æ¶ˆæ¯è¿›è¡Œç¡®è®¤ã€‚åå¤ç¡®è®¤ï¼Œæ²¡ç©æ²¡äº†å°±æˆäº†æ­»å¾ªç¯        #è¿™é‡Œè®¾ç½®å›è°ƒ        self.channel.basic_consume(self.on_response, no_ack=True,                                   queue=self.callback_queue)    # å®šä¹‰å›è°ƒçš„å“åº”å‡½æ•°ã€‚    # åˆ¤æ–­ï¼šè‹¥æ˜¯å½“å‰çš„å›è°ƒIDå’Œå“åº”çš„å›è°ƒIDç›¸åŒï¼Œå³è¡¨ç¤ºï¼Œæ˜¯æœ¬æ¬¡è¯·æ±‚çš„å›è°ƒ    # åŸå› ï¼šè‹¥æ˜¯å‘èµ·ä¸Šç™¾ä¸ªè¯·æ±‚ï¼Œå‘é€ç«¯æ€»å¾—çŸ¥é“å›æ¥çš„å¯¹åº”çš„æ˜¯å“ªä¸€ä¸ªå‘é€çš„    def on_response(self, ch, method, props, body):        if self.corr_id == props.correlation_id:            self.response = body    def call(self, n):        # è®¾ç½®å“åº”å’Œå›è°ƒé€šé“çš„ID        self.response = None        self.corr_id = str(uuid.uuid4())        # propertiesä¸­æŒ‡å®šreplay_toï¼šè¡¨ç¤ºå›è°ƒè¦è°ƒç”¨é‚£ä¸ªå‡½æ•°        # æŒ‡å®šcorrelation_idï¼šè¡¨ç¤ºå›è°ƒè¿”å›çš„è¯·æ±‚IDæ˜¯é‚£ä¸ª        # bodyï¼šæ˜¯è¦äº¤ç»™æ¥æ”¶ç«¯çš„å‚æ•°        self.channel.basic_publish(exchange=&amp;#039;&amp;#039;,                                   routing_key=&amp;#039;rpc_queue&amp;#039;,                                   properties=pika.BasicProperties(reply_to=self.callback_queue,                                                                   correlation_id=self.corr_id,),                                   body=str(n))        # ç›‘å¬å›è°ƒ        while self.response is None:            self.connection.process_data_events()        # è¿”å›çš„ç»“æœæ˜¯æ•´æ•°ï¼Œè¿™é‡Œè¿›è¡Œå¼ºåˆ¶è½¬æ¢        return int(self.response)fibonacci_rpc = FibonacciRpcClient()print(&amp;quot; [x] Requesting fib(30)&amp;quot;)response = fibonacci_rpc.call(30)print(&amp;quot; [.] Got %r&amp;quot; % response)</code></pre><p>æœåŠ¡ç«¯ï¼š</p><pre><code>import pikacredentials = pika.PlainCredentials(&amp;quot;yang&amp;quot;, &amp;quot;123456&amp;quot;)connection = pika.BlockingConnection(pika.ConnectionParameters(host=&amp;#039;192.168.2.176&amp;#039;, credentials=credentials))channel = connection.channel()channel.queue_declare(queue=&amp;#039;rpc_queue&amp;#039;)def fib(n):    if n == 0:        return 0    elif n == 1:        return 1    else:        return fib(n - 1) + fib(n - 2)def on_request(ch, method, props, body):    #æ”¶åˆ°çš„æ¶ˆæ¯    n = int(body)    print(&amp;quot; [.] fib(%s)&amp;quot; % n)    #è¦å¤„ç†çš„ä»»åŠ¡    response = fib(n)    #å‘å¸ƒæ¶ˆæ¯ã€‚é€šçŸ¥åˆ°å®¢æˆ·ç«¯    ch.basic_publish(exchange=&amp;#039;&amp;#039;,                     routing_key=props.reply_to,                     properties=pika.BasicProperties(correlation_id= props.correlation_id),                     body=str(response))    #æ‰‹åŠ¨å“åº”    ch.basic_ack(delivery_tag=method.delivery_tag)channel.basic_qos(prefetch_count=1)channel.basic_consume(on_request, queue=&amp;#039;rpc_queue&amp;#039;)print(&amp;quot; [x] Awaiting RPC requests&amp;quot;)channel.start_consuming()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>linux</tag>
      
      <tag>MQ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RabbitMQæ¦‚è¿°å’Œè¿è¡Œæœºåˆ¶(æ¬è¿æ•´ç†)</title>
    <link href="undefined2018/11/03/2018-11-2-RabbitMQ%E6%A6%82%E8%BF%B0%E5%92%8C%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6/"/>
    <url>2018/11/03/2018-11-2-RabbitMQ%E6%A6%82%E8%BF%B0%E5%92%8C%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<!-- #  RabbitMQæ¦‚è¿°å’Œè¿è¡Œæœºåˆ¶ --><h1 id="RabbitMQæ¦‚è¿°-æ¬è¿"><a href="#RabbitMQæ¦‚è¿°-æ¬è¿" class="headerlink" title="RabbitMQæ¦‚è¿°[æ¬è¿]"></a>RabbitMQæ¦‚è¿°<code>[æ¬è¿]</code></h1><p><strong>RabbitMQæ¦‚è¿°</strong>ï¼šRabbitMQæ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„å¼€æºæ¶ˆæ¯ä»£ç†ã€‚RabbitMQè½»é‡çº§ï¼Œæ˜“äºåœ¨é›†ç¾¤å†…éƒ¨å’Œäº‘å¹³å°ä¸­éƒ¨ç½²ã€‚å®ƒæ”¯æŒå¤šç§æ¶ˆæ¯ä¼ é€’åè®®ã€‚ å®ƒå¯ä»¥æ»¡è¶³ä¼ä¸šé«˜è§„æ¨¡ï¼Œé«˜å¯ç”¨æ€§çš„è¦æ±‚ã€‚RabbitMQä½¿ç”¨Erlangè¯­è¨€å¼€å‘çš„ã€‚</p><a id="more"></a><p><strong>MQæ¦‚è¿°</strong>ï¼šå…¨ç§°ä¸ºMessage Queue, æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰æ˜¯ä¸€ç§åº”ç”¨ç¨‹åºå¯¹åº”ç”¨ç¨‹åºçš„é€šä¿¡æ–¹æ³•ã€‚åº”ç”¨ç¨‹åºé€šè¿‡è¯»å†™é˜Ÿåˆ—çš„æ¶ˆæ¯ï¼ˆé’ˆå¯¹åº”ç”¨ç¨‹åºçš„æ•°æ®ï¼‰æ¥é€šä¿¡ï¼Œè€Œæ— éœ€ä¸“ç”¨è¿æ¥æ¥é“¾æ¥å®ƒä»¬ã€‚<br><strong>MQè¿è¡Œæœºåˆ¶</strong>ï¼š Pè¡¨ç¤ºç”Ÿäº§è€…ï¼ŒCè¡¨ç¤ºæ¶ˆè´¹è€…ï¼Œçº¢è‰²éƒ¨åˆ†ä¸ºæ¶ˆæ¯é˜Ÿåˆ—</p><p><img src="https://box.kancloud.cn/a02211c868ca3192b4f7f8d9af4bbd7c_536x86.png" srcset="/img/loading.gif" alt=""></p><h2 id="MQå®æˆ˜åœºæ™¯ï¼š"><a href="#MQå®æˆ˜åœºæ™¯ï¼š" class="headerlink" title="MQå®æˆ˜åœºæ™¯ï¼š"></a>MQå®æˆ˜åœºæ™¯ï¼š</h2><p>1.æˆ‘ä»¬åœ¨åŒ11çš„æ—¶å€™ï¼Œå½“æˆ‘ä»¬å‡Œæ™¨å¤§é‡çš„ç§’æ€å’ŒæŠ¢è´­å•†å“ï¼Œç„¶åå»ç»“ç®—çš„æ—¶å€™ï¼Œå°±ä¼šå‘ç°ï¼Œç•Œé¢ä¼šæé†’æˆ‘ä»¬ï¼Œè®©æˆ‘ä»¬ç¨ç­‰ï¼Œä»¥åŠä¸€äº›å‹å¥½çš„å›¾ç‰‡æ–‡å­—æé†’ã€‚è€Œä¸æ˜¯åƒå‰å‡ å¹´çš„æ—¶ä»£ï¼ŒåŠ¨ä¸åŠ¨å°±é¡µé¢å¡æ­»ï¼ŒæŠ¥é”™ç­‰æ¥å‘ˆç°ç»™ç”¨æˆ·ã€‚åœ¨è¿™ä¸ªä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡‡ç”¨é˜Ÿåˆ—çš„æœºåˆ¶æ¥å¤„ç†ï¼Œå› ä¸ºåŒæ—¶ç»“ç®—å°±åªèƒ½è¾¾åˆ°è¿™ä¹ˆå¤šã€‚</p><p><img src="https://box.kancloud.cn/5534033654975dec4f1aa1f746452ee6_869x420.png" srcset="/img/loading.gif" alt=""></p><p><img src="https://box.kancloud.cn/a642a8065db7f6b250bbd8ba04073ab0_680x344.jpg" srcset="/img/loading.gif" alt=""></p><p>2.åœ¨æˆ‘ä»¬å¹³æ—¶çš„è¶…å¸‚ä¸­è´­ç‰©ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå½“æˆ‘ä»¬åœ¨ç»“ç®—çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šä¸€çªèœ‚ä¸€æ ·æ¶Œå…¥æ”¶é“¶å°ï¼Œè€Œæ˜¯æ’é˜Ÿç»“ç®—ã€‚è¿™ä¹Ÿæ˜¯é˜Ÿåˆ—æœºåˆ¶ã€‚ä¸€ä¸ªæ¥ç€ä¸€ä¸ªçš„å¤„ç†ï¼Œä¸èƒ½æ’é˜Ÿã€‚</p><p><img src="https://box.kancloud.cn/0df7fc413ae1f796d04d0f6f052c3a11_1024x683.jpg" srcset="/img/loading.gif" alt=""></p><hr><p><strong>RabbitMQ æ˜¯ä¸€ä¸ªç”± Erlang è¯­è¨€å¼€å‘çš„ AMQP çš„å¼€æºå®ç°ã€‚</strong></p><p>RabbitMQæ˜¯AMQPæœåŠ¡å™¨çš„ä¸€ç§ã€‚<br><strong>AMQPç®€ä»‹</strong>ï¼šAMQPï¼Œå³Advanced Message Queuing Protocolï¼Œ<strong>é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®</strong>ï¼Œæ˜¯åº”ç”¨å±‚åè®®çš„ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œä¸ºé¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶è®¾è®¡ã€‚æ¶ˆæ¯ä¸­é—´ä»¶ä¸»è¦ç”¨äºç»„ä»¶ä¹‹é—´çš„è§£è€¦ï¼Œæ¶ˆæ¯çš„å‘é€è€…æ— éœ€çŸ¥é“æ¶ˆæ¯ä½¿ç”¨è€…çš„å­˜åœ¨ï¼Œåä¹‹äº¦ç„¶ã€‚ AMQPçš„ä¸»è¦ç‰¹å¾æ˜¯é¢å‘æ¶ˆæ¯ã€é˜Ÿåˆ—ã€è·¯ç”±ï¼ˆåŒ…æ‹¬ç‚¹å¯¹ç‚¹å’Œå‘å¸ƒ/è®¢é˜…ï¼‰ã€å¯é æ€§ã€å®‰å…¨ã€‚<br>å®ƒæ˜¯åº”ç”¨å±‚åè®®çš„ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œä¸ºé¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶è®¾è®¡ï¼ŒåŸºäºæ­¤åè®®çš„å®¢æˆ·ç«¯ä¸æ¶ˆæ¯ä¸­é—´ä»¶å¯ä¼ é€’æ¶ˆæ¯ï¼Œ<strong>å¹¶ä¸å—äº§å“ã€å¼€å‘è¯­è¨€ç­‰æ¡ä»¶çš„é™åˆ¶ã€‚</strong></p><p>AMQP é‡Œä¸»è¦è¦è¯´ä¸¤ä¸ªç»„ä»¶ï¼šExchange å’Œ Queue ï¼ˆåœ¨ AMQP 1.0 é‡Œè¿˜ä¼šæœ‰å˜åŠ¨ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç»¿è‰²çš„ X å°±æ˜¯ Exchange ï¼Œçº¢è‰²çš„æ˜¯ Queue ï¼Œè¿™ä¸¤è€…éƒ½åœ¨ Server ç«¯ï¼Œåˆç§°ä½œ Broker ï¼Œè¿™éƒ¨åˆ†æ˜¯ RabbitMQ å®ç°çš„ï¼Œè€Œè“è‰²çš„åˆ™æ˜¯å®¢æˆ·ç«¯ï¼Œé€šå¸¸æœ‰ Producerï¼ˆç”Ÿäº§è€…ï¼‰ å’Œ Consumerï¼ˆæ¶ˆè´¹è€…ï¼‰ ä¸¤ç§ç±»å‹ï¼š<br><img src="https://box.kancloud.cn/d55ac336d3c298d60fcf5e26e6c6fdf1_600x450.png" srcset="/img/loading.gif" alt=""><br>Publisher<br>æ¶ˆæ¯çš„ç”Ÿäº§è€…ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå‘äº¤æ¢å™¨å‘å¸ƒæ¶ˆæ¯çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚<br>Exchange<br>äº¤æ¢å™¨ï¼Œç”¨æ¥æ¥æ”¶ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯å¹¶å°†è¿™äº›æ¶ˆæ¯è·¯ç”±ç»™æœåŠ¡å™¨ä¸­çš„é˜Ÿåˆ—ã€‚<br>Queue<br>æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”¨æ¥ä¿å­˜æ¶ˆæ¯ç›´åˆ°å‘é€ç»™æ¶ˆè´¹è€…ã€‚å®ƒæ˜¯æ¶ˆæ¯çš„å®¹å™¨ï¼Œä¹Ÿæ˜¯æ¶ˆæ¯çš„ç»ˆç‚¹ã€‚ä¸€ä¸ªæ¶ˆæ¯å¯æŠ•å…¥ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚æ¶ˆæ¯ä¸€ç›´åœ¨é˜Ÿåˆ—é‡Œé¢ï¼Œç­‰å¾…æ¶ˆè´¹è€…è¿æ¥åˆ°è¿™ä¸ªé˜Ÿåˆ—å°†å…¶å–èµ°ã€‚<br>Consumer<br>æ¶ˆæ¯çš„æ¶ˆè´¹è€…ï¼Œè¡¨ç¤ºä¸€ä¸ªä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å¾—æ¶ˆæ¯çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚<br>Broker<br>è¡¨ç¤ºæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨å®ä½“ã€‚</p><p>RabbitMQ æœ€åˆèµ·æºäºé‡‘èç³»ç»Ÿï¼Œç”¨äºåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å­˜å‚¨è½¬å‘æ¶ˆæ¯ï¼Œåœ¨æ˜“ç”¨æ€§ã€æ‰©å±•æ€§ã€é«˜å¯ç”¨æ€§ç­‰æ–¹é¢è¡¨ç°ä¸ä¿—ã€‚å…·ä½“ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p><ul><li><p>å¯é æ€§ï¼ˆReliabilityï¼‰<br>RabbitMQ ä½¿ç”¨ä¸€äº›æœºåˆ¶æ¥ä¿è¯å¯é æ€§ï¼Œå¦‚æŒä¹…åŒ–ã€ä¼ è¾“ç¡®è®¤ã€å‘å¸ƒç¡®è®¤ã€‚</p></li><li><p>çµæ´»çš„è·¯ç”±ï¼ˆFlexible Routingï¼‰<br>åœ¨æ¶ˆæ¯è¿›å…¥é˜Ÿåˆ—ä¹‹å‰ï¼Œé€šè¿‡ Exchange æ¥è·¯ç”±æ¶ˆæ¯çš„ã€‚å¯¹äºå…¸å‹çš„è·¯ç”±åŠŸèƒ½ï¼ŒRabbitMQ å·²ç»æä¾›äº†ä¸€äº›å†…ç½®çš„ Exchange æ¥å®ç°ã€‚é’ˆå¯¹æ›´å¤æ‚çš„è·¯ç”±åŠŸèƒ½ï¼Œå¯ä»¥å°†å¤šä¸ª Exchange ç»‘å®šåœ¨ä¸€èµ·ï¼Œä¹Ÿé€šè¿‡æ’ä»¶æœºåˆ¶å®ç°è‡ªå·±çš„ Exchange ã€‚</p></li><li><p>æ¶ˆæ¯é›†ç¾¤ï¼ˆClusteringï¼‰<br>å¤šä¸ª RabbitMQ æœåŠ¡å™¨å¯ä»¥ç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œå½¢æˆä¸€ä¸ªé€»è¾‘ Broker ã€‚</p></li><li><p>é«˜å¯ç”¨ï¼ˆHighly Available Queuesï¼‰<br>é˜Ÿåˆ—å¯ä»¥åœ¨é›†ç¾¤ä¸­çš„æœºå™¨ä¸Šè¿›è¡Œé•œåƒï¼Œä½¿å¾—åœ¨éƒ¨åˆ†èŠ‚ç‚¹å‡ºé—®é¢˜çš„æƒ…å†µä¸‹é˜Ÿåˆ—ä»ç„¶å¯ç”¨ã€‚</p></li><li><p>å¤šç§åè®®ï¼ˆMulti-protocolï¼‰<br>RabbitMQ æ”¯æŒå¤šç§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œæ¯”å¦‚ STOMPã€MQTT ç­‰ç­‰ã€‚</p></li><li><p>å¤šè¯­è¨€å®¢æˆ·ç«¯ï¼ˆMany Clientsï¼‰<br>RabbitMQ å‡ ä¹æ”¯æŒæ‰€æœ‰å¸¸ç”¨è¯­è¨€ï¼Œæ¯”å¦‚ Javaã€.NETã€Ruby ç­‰ç­‰ã€‚</p></li><li><p>ç®¡ç†ç•Œé¢ï¼ˆManagement UIï¼‰<br>RabbitMQ æä¾›äº†ä¸€ä¸ªæ˜“ç”¨çš„ç”¨æˆ·ç•Œé¢ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥ç›‘æ§å’Œç®¡ç†æ¶ˆæ¯ Broker çš„è®¸å¤šæ–¹é¢ã€‚</p></li><li><p>è·Ÿè¸ªæœºåˆ¶ï¼ˆTracingï¼‰<br>å¦‚æœæ¶ˆæ¯å¼‚å¸¸ï¼ŒRabbitMQ æä¾›äº†æ¶ˆæ¯è·Ÿè¸ªæœºåˆ¶ï¼Œä½¿ç”¨è€…å¯ä»¥æ‰¾å‡ºå‘ç”Ÿäº†ä»€ä¹ˆã€‚</p></li><li><p>æ’ä»¶æœºåˆ¶ï¼ˆPlugin Systemï¼‰<br>RabbitMQ æä¾›äº†è®¸å¤šæ’ä»¶ï¼Œæ¥ä»å¤šæ–¹é¢è¿›è¡Œæ‰©å±•ï¼Œä¹Ÿå¯ä»¥ç¼–å†™è‡ªå·±çš„æ’ä»¶ã€‚</p></li></ul><h1 id="RabbitMQ-å®‰è£…"><a href="#RabbitMQ-å®‰è£…" class="headerlink" title="RabbitMQ å®‰è£…"></a>RabbitMQ å®‰è£…</h1><p>RabbitMQæ˜¯ç”¨erlangè¯­è¨€ç¼–å†™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆå®‰è£…erlangè¯­è¨€ç¯å¢ƒ<br>é…ç½®erlangè¯­è¨€ç¯å¢ƒ</p><pre><code>vim /etc/yum.repos.d/rabbitmq-erlang.repo# åœ¨rabbitmq-erlang.repo æ–‡ä»¶ä¸­åŠ å…¥ä¸‹é¢çš„ä»£ç [rabbitmq-erlang]name=rabbitmq-erlangbaseurl=https://dl.bintray.com/rabbitmq/rpm/erlang/20/el/7gpgcheck=1gpgkey=https://dl.bintray.com/rabbitmq/Keys/rabbitmq-release-signing-key.ascenabled=1# æ‰§è¡Œå¯¼å…¥keyrpm --import  https://dl.bintray.com/rabbitmq/Keys/rabbitmq-release-signing-key.asc# å®‰è£…erlangyum install erlang -y  #å®‰è£…erlang</code></pre><p><strong>å®‰è£…rabbitmqæœåŠ¡</strong></p><p>ä¸‹è½½rabbitmq  åœ°å€ï¼š<a href="http://www.rabbitmq.com/download.html" target="_blank" rel="noopener">http://www.rabbitmq.com/download.html</a></p><pre><code>wget https://github.com/rabbitmq/rabbitmq-server/releases/download/v3.7.8/rabbitmq-server-3.7.8-1.el7.noarch.rpmyum install  rabbitmq-server-3.7.8-1.el7.noarch.rpm</code></pre><p>å¯ç”¨RabbitMQçš„webæ’ä»¶ ï¼Œæ–¹ä¾¿åæœŸç®¡ç†ç•Œé¢</p><pre><code>rabbitmq-plugins enable rabbitmq_management</code></pre><pre><code>The following plugins have been configured:  rabbitmq_management  rabbitmq_management_agent  rabbitmq_web_dispatchApplying plugin configuration to rabbit@localhost...The following plugins have been enabled:  rabbitmq_management  rabbitmq_management_agent  rabbitmq_web_dispatchset 3 plugins.Offline change; changes will take effect at broker restart.</code></pre><p>è®¾ç½®å¼€æœºå¯åŠ¨</p><pre><code>systemctl enable rabbitmq-server.service</code></pre><p>å¯åŠ¨æœåŠ¡</p><pre><code>systemctl start rabbitmq-server</code></pre><p>rabbitmqé…ç½®æ–‡ä»¶ä½ç½®</p><pre><code> ls /var/lib/rabbitmq/mnesia</code></pre><p>è®¿é—®æ§åˆ¶å°<br>é»˜è®¤ç”¨æˆ·åå’Œå¯†ç ï¼š guest/guest ã€‚guestç”¨æˆ·ä»…å…è®¸ä»åœ¨æœåŠ¡å™¨ä»¥localhostæˆ–127.0.0.1ä½œä¸ºipç™»å½•</p><p>å¦‚æœè¿œç¨‹ç™»å½•ï¼Œå¦‚ï¼š<a href="http://192.168.1.63:15672/" target="_blank" rel="noopener">http://192.168.1.63:15672/</a>, åˆ™ä¼šæç¤ºé”™è¯¯ï¼Œç™»å½•ä¸äº†ã€‚</p><p>ä¸ºRabbitMQåˆ›å»ºç”¨æˆ·å¹¶èµ‹æƒã€‚</p><pre><code>rabbitmqctl add_user root 123456  #æ·»åŠ ç”¨æˆ·rabbitmqctl set_user_tags root administrator #è®¾ç½®ç”¨æˆ·æƒé™ä¸ºadministrator</code></pre><p>åˆ°æ­¤ï¼Œå·²ç»æ­å»ºæˆåŠŸã€‚</p><h1 id="RabbitMQä½¿ç”¨æ–¹æ³•"><a href="#RabbitMQä½¿ç”¨æ–¹æ³•" class="headerlink" title="RabbitMQä½¿ç”¨æ–¹æ³•"></a>RabbitMQä½¿ç”¨æ–¹æ³•</h1><p><strong>RabbitMQæŸ¥çœ‹ç›¸å…³çš„å‘½ä»¤</strong></p><pre><code> rabbitmqctl list_connections   #ç”¨äºæŸ¥çœ‹å½“å‰çš„è¿æ¥rabbitmqctl list_queues   #ä¼šåˆ—å‡ºæ‰€æœ‰é˜Ÿåˆ—åç§°ï¼Œåè¾¹å¯èƒ½è¿˜ä¼šå¸¦ç€è¿™ä¸ªé˜Ÿåˆ—å½“å‰æ¶ˆæ¯æ•° rabbitmqctl status        #æŸ¥çœ‹å½“å‰é˜Ÿåˆ—ä¿¡æ¯</code></pre><h2 id="RabbitMQçš„vhostç®¡ç†"><a href="#RabbitMQçš„vhostç®¡ç†" class="headerlink" title="RabbitMQçš„vhostç®¡ç†"></a>RabbitMQçš„vhostç®¡ç†</h2><p>å½“æˆ‘ä»¬åœ¨åˆ›å»ºç”¨æˆ·æ—¶ï¼Œä¼šæŒ‡å®šç”¨æˆ·èƒ½è®¿é—®ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œå¹¶ä¸”è¯¥ç”¨æˆ·åªèƒ½è®¿é—®è¯¥è™šæ‹Ÿæœºä¸‹çš„é˜Ÿåˆ—å’Œäº¤æ¢æœºï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤çš„æ˜¯â€/â€;ä¸€ä¸ªrabbitmqæœåŠ¡å™¨ä¸Šå¯ä»¥è¿è¡Œå¤šä¸ªvhostï¼Œä»¥ä¾¿äºé€‚ç”¨ä¸åŒçš„ä¸šåŠ¡éœ€è¦ï¼Œè¿™æ ·åšæ—¢å¯ä»¥æ»¡è¶³æƒé™é…ç½®çš„è¦æ±‚ï¼Œä¹Ÿå¯ä»¥é¿å…ä¸åŒä¸šåŠ¡ä¹‹é—´é˜Ÿåˆ—ã€äº¤æ¢æœºçš„å‘½åå†²çªé—®é¢˜ï¼Œå› ä¸ºä¸åŒvhostä¹‹é—´æ˜¯éš”ç¦»çš„ã€‚</p><p>æ·»åŠ yang-webå’Œyang-bbsä¸¤ä¸ªè™šæ‹Ÿæœºæ¥ç®¡ç†ç½‘ç«™å’Œè®ºå›çš„é˜Ÿåˆ—</p><pre><code>rabbitmqctl add_vhost yang-webrabbitmqctl add_vhost yang-bbs</code></pre><p>æŸ¥çœ‹åˆ›å»ºçš„è™šæ‹Ÿä¸»æœº ç½‘é¡µæŸ¥çœ‹</p><p>åˆ é™¤bbsè™šæ‹Ÿæœº</p><pre><code>rabbitmqctl delete_vhost yang-bbs</code></pre><p>æŸ¥çœ‹è™šæ‹Ÿæœºåˆ—è¡¨</p><pre><code>rabbitmqctl list_vhosts</code></pre><p><strong>â€œ/â€æ˜¯rabbitmqé»˜è®¤çš„è™šæ‹Ÿæœºï¼Œä¹‹å‰é»˜è®¤è¿æ¥çš„éƒ½æ˜¯å®ƒ</strong></p><h1 id="RabbitMQç®¡ç†ç”¨æˆ·ã€è§’è‰²å’Œæƒé™ç®¡ç†"><a href="#RabbitMQç®¡ç†ç”¨æˆ·ã€è§’è‰²å’Œæƒé™ç®¡ç†" class="headerlink" title="RabbitMQç®¡ç†ç”¨æˆ·ã€è§’è‰²å’Œæƒé™ç®¡ç†"></a>RabbitMQç®¡ç†ç”¨æˆ·ã€è§’è‰²å’Œæƒé™ç®¡ç†</h1><p>1ã€ç”¨æˆ·ç®¡ç†è¯­æ³•<br>æ·»åŠ ç”¨æˆ·ï¼šrabbitmqctl add_user {username} {password}<br>åˆ é™¤ç”¨æˆ·ï¼šrabbitmqctl delete_user {username}<br>ä¿®æ”¹å¯†ç ï¼šrabbitmqctl change_password {username} {newpassword} </p><p>2ã€è§’è‰²æƒé™åˆ†é…<br> è®¾ç½®ç”¨æˆ·è§’è‰²è¯­æ³•ï¼šrabbitmqctl set_user_tags {username} {tag}<br>RabbitMQçš„tagç”¨æˆ·è§’è‰²åˆ†ç±»ï¼šnoneã€managementã€policymakerã€monitoringã€administrator<br>tagå¸¸ç”¨è§’è‰²ä¸ºï¼šadministrator, monitoring, management </p><h3 id="RabbitMQå„ç±»è§’è‰²æè¿°ï¼š"><a href="#RabbitMQå„ç±»è§’è‰²æè¿°ï¼š" class="headerlink" title="RabbitMQå„ç±»è§’è‰²æè¿°ï¼š"></a>RabbitMQå„ç±»è§’è‰²æè¿°ï¼š</h3><p>ï¼ˆ1ï¼‰ã€noneè§’è‰²æƒé™ ï¼šä¸èƒ½è®¿é—® management plugin<br>ï¼ˆ2ï¼‰ã€managementè§’è‰²æƒé™ï¼š<br>åˆ—å‡ºè‡ªå·±å¯ä»¥é€šè¿‡AMQPç™»å…¥çš„virtual hosts<br>æŸ¥çœ‹è‡ªå·±çš„virtual hostsä¸­çš„queues, exchanges å’Œ bindings<br>æŸ¥çœ‹å’Œå…³é—­è‡ªå·±çš„channels å’Œ connections<br>æŸ¥çœ‹æœ‰å…³è‡ªå·±çš„virtual hostsçš„â€œå…¨å±€â€çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…å«å…¶ä»–ç”¨æˆ·åœ¨è¿™äº›virtual hostsä¸­çš„æ´»åŠ¨ã€‚</p><p>ï¼ˆ3ï¼‰ã€policymakerè§’è‰²æƒé™   #policymaker  [&#039;pÉ’lÉ™sÉªmeÉªkÉ™(r)]  å†³ç­–è€…<br>æ‹¥æœ‰managementçš„æ‰€æœ‰æƒé™ï¼Œè¿˜æ‹¥æœ‰æŸ¥çœ‹ã€åˆ›å»ºå’Œåˆ é™¤è‡ªå·±çš„virtual hostsæ‰€å±çš„policiesï¼ˆç­–ç•¥ï¼‰å’Œparametersï¼ˆ[pÉ™ËˆrÃ¦mÉªtÉ™(r)] å‚æ•° ï¼‰<br>ï¼ˆ4ï¼‰ã€monitoring è§’è‰²æƒé™<br>æ‹¥æœ‰managementçš„æ‰€æœ‰æƒé™ï¼Œè¿˜æ‹¥æœ‰ï¼š<br>åˆ—å‡ºæ‰€æœ‰virtual hostsï¼ŒåŒ…æ‹¬ä»–ä»¬ä¸èƒ½ç™»å½•çš„virtual hosts<br>æŸ¥çœ‹å…¶ä»–ç”¨æˆ·çš„connectionså’Œchannels<br>æŸ¥çœ‹èŠ‚ç‚¹çº§åˆ«çš„æ•°æ®å¦‚clusteringå’Œmemoryä½¿ç”¨æƒ…å†µ<br>æŸ¥çœ‹çœŸæ­£çš„å…³äºæ‰€æœ‰virtual hostsçš„å…¨å±€çš„ç»Ÿè®¡ä¿¡æ¯<br>ï¼ˆ5ï¼‰ã€administratorè§’è‰²æƒé™<br>æ‹¥æœ‰policymakerå’Œmonitoringçš„æ‰€æœ‰æƒé™ï¼Œè¿˜æ‹¥æœ‰ï¼š<br>åˆ›å»ºå’Œåˆ é™¤virtual hosts<br>æŸ¥çœ‹ã€åˆ›å»ºå’Œåˆ é™¤users<br>æŸ¥çœ‹åˆ›å»ºå’Œåˆ é™¤permissions<br>å…³é—­å…¶ä»–ç”¨æˆ·çš„connections</p><p>TODO</p><h1 id="ä½¿ç”¨pythonè°ƒç”¨rabbitmqæœåŠ¡å™¨"><a href="#ä½¿ç”¨pythonè°ƒç”¨rabbitmqæœåŠ¡å™¨" class="headerlink" title="ä½¿ç”¨pythonè°ƒç”¨rabbitmqæœåŠ¡å™¨"></a>ä½¿ç”¨pythonè°ƒç”¨rabbitmqæœåŠ¡å™¨</h1><p>pip install pika    #å®‰è£…pikaæ¨¡å—ã€‚pythonç”¨pikaæ¨¡å—è°ƒç”¨rabbitmqã€‚<br><strong>æ³¨ï¼š</strong> rabbitmqæœ¬è´¨æ˜¯ä¸€ä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„æ¨¡å‹ç»“æ„ã€‚ç”Ÿäº§è€…-&gt;rabbitmq-&gt;æ¶ˆè´¹è€…ï¼Œå³ç”Ÿäº§è€…äº§ç”Ÿæ¶ˆæ¯ï¼Œç»™åˆ°rabbitmqå­˜å‚¨ï¼Œæ¶ˆè´¹è€…ä»rabbitmqä¸­è¯»å–æ•°æ®ã€‚</p><p>åˆ›å»ºç”Ÿäº§è€…ä»£ç send.py </p><pre><code>import pikaconnection = pika.BlockingConnection(pika.ConnectionParameters(        host=&amp;#039;localhost&amp;#039;))channel = connection.channel()channel.queue_declare(queue=&amp;#039;hello&amp;#039;)channel.basic_publish(exchange=&amp;#039;&amp;#039;,                      routing_key=&amp;#039;hello&amp;#039;,                      body=&amp;#039;Hello World!&amp;#039;)print(&amp;quot; [x] Sent &amp;#039;Hello World!&amp;#039;&amp;quot;)connection.close()æ³¨ï¼šdeclare  [dÉªËˆkleÉ™(r)]  å£°æ˜  ï¼› consuming [kÉ™nËˆsju:mÉªÅ‹]  æ¶ˆè´¹ï¼›publish  [ËˆpÊŒblÉªÊƒ]  é¢å¸ƒ</code></pre><p>åˆ›å»ºæ¶ˆè€—è€…ä»£ç receive.py </p><pre><code>import pikaconnection = pika.BlockingConnection(pika.ConnectionParameters(        host=&amp;#039;localhost&amp;#039;))channel = connection.channel()channel.queue_declare(queue=&amp;#039;hello&amp;#039;)def callback(ch, method, properties, body):    print(&amp;quot; [x] Received %r&amp;quot; % body)channel.basic_consume(callback,                      queue=&amp;#039;hello&amp;#039;,                      no_ack=True)print(&amp;#039; [*] Waiting for messages. To exit press CTRL+C&amp;#039;)channel.start_consuming()</code></pre><h2 id="å¼€å§‹æµ‹è¯•é˜Ÿåˆ—"><a href="#å¼€å§‹æµ‹è¯•é˜Ÿåˆ—" class="headerlink" title="å¼€å§‹æµ‹è¯•é˜Ÿåˆ—"></a>å¼€å§‹æµ‹è¯•é˜Ÿåˆ—</h2><p>python send.py   #æ­¤å‘½ä»¤æ‰§è¡Œä¸¤æ¬¡ï¼Œäº§ç”Ÿä¸¤ä¸ªåå­—å«helloçš„æ¶ˆæ¯<br>rabbitmqctl list_queues  #æŸ¥çœ‹æ¶ˆæ¯é˜Ÿåˆ—ä¸º2</p><p>åœ¨webç•Œé¢æŸ¥çœ‹æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå‘ç°åœ¨2ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ç­‰å¾…å¤„ç†ï¼š<br> python receive.py   #æ¶ˆè´¹æˆ–å¤„ç†è¿™2ä¸ªæ¶ˆæ¯<br>rabbitmqctl list_queues   #æŸ¥çœ‹é˜Ÿåˆ—ï¼Œå·²ç»ä¸º0<br>åœ¨webç•Œé¢ï¼ŒæŸ¥çœ‹é˜Ÿåˆ—ï¼Œä¹Ÿä¸º0äº†</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>linux</tag>
      
      <tag>MQ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Centos 7 ä¸‹éƒ¨ç½²Django + uWSGI + Nginx</title>
    <link href="undefined2018/10/16/2018-10-16-Centos7%E9%83%A8%E7%BD%B2Django/"/>
    <url>2018/10/16/2018-10-16-Centos7%E9%83%A8%E7%BD%B2Django/</url>
    
    <content type="html"><![CDATA[<!-- # Centos 7 ä¸‹éƒ¨ç½²Django + uWSGI + Nginx --><h2 id="ç¯å¢ƒï¼š"><a href="#ç¯å¢ƒï¼š" class="headerlink" title="ç¯å¢ƒï¼š"></a>ç¯å¢ƒï¼š</h2><p>Python: 3.6</p><p>Django: 2.1</p><p>OS: CentOS 7 x86_64</p><p>uwsgi: 2.0.17</p><a id="more"></a><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½• :"></a>ç›®å½• :</h2><ul><li><a href="#å®‰è£…Python3.6">å®‰è£…Python3.6</a><ul><li><a href="#åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ">åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</a></li><li><a href="#å®‰è£…uWSGI">å®‰è£…uWSGI</a></li></ul></li><li><a href="#å®‰è£…Nginx">å®‰è£…Nginx</a></li><li><a href="#é…ç½®é¡¹ç›®">é…ç½®é¡¹ç›®</a><ul><li><a href="#å®‰è£…djangoé¡¹ç›®ä¾èµ–çš„åŒ…">å®‰è£…djangoé¡¹ç›®ä¾èµ–çš„åŒ…</a></li><li><a href="#åœ¨é¡¹ç›®ç›®å½•ä¸‹é…ç½®uwsgiå¯åŠ¨djangoçš„å‚æ•°">åœ¨é¡¹ç›®ç›®å½•ä¸‹é…ç½®uwsgiå¯åŠ¨djangoçš„å‚æ•°</a></li><li><a href="#é…ç½®é¡¹ç›®æ–‡ä»¶">é…ç½®é¡¹ç›®æ–‡ä»¶</a></li></ul></li><li><a href="#é…ç½®nginx">é…ç½®nginx</a></li><li><a href="#é‡å¯Nginx">é‡å¯Nginx</a></li><li><a href="#uwsgiå¯åŠ¨django">uwsgiå¯åŠ¨django</a></li><li><a href="#ä»£ç†">ä»£ç†</a></li><li><a href="#é—®é¢˜æ±‡æ€»">é—®é¢˜æ±‡æ€»</a></li></ul><h2 id="å®‰è£…Python3-6"><a href="#å®‰è£…Python3-6" class="headerlink" title="å®‰è£…Python3.6"></a>å®‰è£…Python3.6</h2><ul><li>ä¸è¦åˆ é™¤è‡ªå¸¦çš„python2.7ï¼Œå¦åˆ™ä¼šå‡ºé—®é¢˜ï¼Œå› ä¸ºcentosè®¸å¤šè½¯ä»¶éœ€è¦ä¾èµ–ç³»ç»Ÿè‡ªå¸¦python</li><li>å®‰è£…ä¾èµ–å·¥å…· yum install openssl-devel bzip2-devel expat-devel gdbm-devel readline-devel sqlite-devel</li><li>ä¸‹è½½ wget <a href="https://www.python.org/ftp/python/3.6.5/Python-3.6.5.tgz" target="_blank" rel="noopener">https://www.python.org/ftp/python/3.6.5/Python-3.6.5.tgz</a></li><li>è§£å‹ tar -zxvf Python-3.6.5.tgz</li><li>ç§»åŠ¨è‡³è§„èŒƒçš„æ”¾è½¯ä»¶çš„ç›®å½•ä¸‹ mv Python-3.6.5 /usr/local</li><li>å®‰è£…ï¼š<pre><code class="bash">cd /usr/local/Python-3.6.5/</code></pre></li></ul><p>./configure</p><p>make &amp; make install</p><pre><code>* éªŒè¯* python -V### åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ* python3.6 -m venv /home/cosmic/py3.6env* source /home/cosmic/py3.6env/bin/activate   è¿›å…¥è™šæ‹Ÿç¯å¢ƒ### å®‰è£…uWSGI* é¦–å…ˆè¿›å…¥è™šæ‹Ÿç¯å¢ƒ,åœ¨è™šæ‹Ÿç¯å¢ƒä¸‹å®‰è£…uwsgi* å®‰è£… pip install uwsgi * éªŒè¯ ```bashdef application(env, start_response):    start_response(&#39;200 OK&#39;, [(&#39;Content-Type&#39;,&#39;text/html&#39;)])    return [b&quot;Hello Django&quot;]</code></pre><pre><code class="bash">uwsgi --http :8001 --wsgi-file test.py</code></pre><p>æµè§ˆå™¨è®¿é—®ï¼Œç½‘é¡µèƒ½æ˜¾ç¤º Hello Django é‚£ä¹ˆå°±æ²¡é—®é¢˜</p><ul><li>å¦‚æœå®‰è£…å¤±è´¥(å¯èƒ½æœªå®‰è£…ä¾èµ–ç¯å¢ƒpython-devel)</li><li>deactivate é€€å‡ºè™šæ‹Ÿç¯å¢ƒ</li><li>yum install -y python-devel </li><li>easy_install uwsgi</li></ul><h2 id="å®‰è£…Nginx"><a href="#å®‰è£…Nginx" class="headerlink" title="å®‰è£…Nginx"></a>å®‰è£…Nginx</h2><ul><li><p>é…ç½®æº<br>  vi /etc/yum.repos.d/nginx.repo æ·»åŠ ä¸‹é¢å†…å®¹</p><pre><code class="bash">  [nginx]  name=nginx repo  baseurl=http://nginx.org/packages/mainline/centos/7/x86_64/  gpgcheck=0  enabled=1</code></pre><p> gpkcheck=0 è¡¨ç¤ºå¯¹ä»è¿™ä¸ªæºä¸‹è½½çš„rpmåŒ…ä¸è¿›è¡Œæ ¡éªŒï¼›<br> enable=1 è¡¨ç¤ºå¯ç”¨è¿™ä¸ªæºã€‚</p><ul><li><p>yum install nginx</p></li><li><p>å¯åŠ¨nginxï¼š<br>systemctl start nginx</p></li><li><p>ä¿®æ”¹é»˜è®¤ç«¯å£å·ï¼ˆé»˜è®¤ä¸º80ï¼‰</p><pre><code class="bash">vim /etc/nginx/conf.d/default.conf</code></pre></li></ul></li></ul><pre><code>server {    listen       8089;    listen [::]:8089;    ...    ...}```</code></pre><ul><li>systemctl restart nginx é‡å¯nginxï¼Œç›´æ¥è®¿é—®<a href="http://ip:8089" target="_blank" rel="noopener">http://ip:8089</a> èƒ½çœ‹åˆ°nginxçš„æ¬¢è¿ç•Œé¢å³å¯ã€‚</li></ul><h2 id="é…ç½®é¡¹ç›®"><a href="#é…ç½®é¡¹ç›®" class="headerlink" title="é…ç½®é¡¹ç›®"></a>é…ç½®é¡¹ç›®</h2><h3 id="å®‰è£…djangoé¡¹ç›®ä¾èµ–çš„åŒ…"><a href="#å®‰è£…djangoé¡¹ç›®ä¾èµ–çš„åŒ…" class="headerlink" title="å®‰è£…djangoé¡¹ç›®ä¾èµ–çš„åŒ…"></a>å®‰è£…djangoé¡¹ç›®ä¾èµ–çš„åŒ…</h3><ul><li>è™šæ‹Ÿç¯å¢ƒä¸‹</li></ul><pre><code>    Django==2.1.2    django-haystack==2.8.1    mysqlclient==1.3.13    pytz==2018.5    uWSGI==2.0.17.1    Whoosh==2.7.4    blablabla...</code></pre><h3 id="åœ¨é¡¹ç›®ç›®å½•ä¸‹é…ç½®uwsgiå¯åŠ¨djangoçš„å‚æ•°"><a href="#åœ¨é¡¹ç›®ç›®å½•ä¸‹é…ç½®uwsgiå¯åŠ¨djangoçš„å‚æ•°" class="headerlink" title="åœ¨é¡¹ç›®ç›®å½•ä¸‹é…ç½®uwsgiå¯åŠ¨djangoçš„å‚æ•°"></a>åœ¨é¡¹ç›®ç›®å½•ä¸‹é…ç½®uwsgiå¯åŠ¨djangoçš„å‚æ•°</h3><pre><code class="bash">vim django_uwsgi.ini # åç§°å¯è‡ªå®šä¹‰,ç”¨äºå¯åŠ¨djangoé¡¹ç›®[uwsgi]# é€šè¿‡uwsgiè®¿é—®djangoéœ€è¦é…ç½®æˆhttp# é€šè¿‡nginxè¯·æ±‚uwsgiæ¥è®¿é—®django éœ€è¦é…ç½®æˆsocket# 9000 æ˜¯djangoçš„ç«¯å£å·socket = 0.0.0.0:9000# webé¡¹ç›®æ ¹ç›®å½•chdir = /home/root/pydj/django_one# moduleæŒ‡å®šé¡¹ç›®è‡ªå¸¦çš„çš„wsgié…ç½®æ–‡ä»¶ä½ç½®module = django_one.wsgi# å…è®¸å­˜åœ¨ä¸»è¿›ç¨‹master = true# å¼€å¯è¿›ç¨‹æ•°é‡processes = 3# æœåŠ¡å™¨é€€å‡ºæ—¶è‡ªåŠ¨æ¸…ç†ç¯å¢ƒvacuum = true</code></pre><h3 id="é…ç½®é¡¹ç›®æ–‡ä»¶"><a href="#é…ç½®é¡¹ç›®æ–‡ä»¶" class="headerlink" title="é…ç½®é¡¹ç›®æ–‡ä»¶"></a>é…ç½®é¡¹ç›®æ–‡ä»¶</h3><blockquote><p>é…ç½®é¡¹ç›®ä¸‹çš„<code>settings.py</code>æ–‡ä»¶</p></blockquote><pre><code class="python">...DEBUG = False  # å…³é—­è°ƒè¯•æ¨¡å¼ALLOWED_HOSTS = [&quot;*&quot;]  # å…è®¸è®¿é—®çš„ä¸»æœº...# æ•°æ®åº“é…ç½®DATABASES = {    &#39;default&#39;: {        &#39;ENGINE&#39;: &#39;django.db.backends.mysql&#39;,        &#39;NAME&#39;: &#39;fresh&#39;,        &#39;HOST&#39;:&#39;192.168.98.1&#39;,  #æ•°æ®åº“æœåŠ¡å™¨çš„åœ°å€        &#39;USER&#39;:&#39;root&#39;,        &#39;PASSWORD&#39;:&#39;123456&#39;,        &#39;PORT&#39;:3306    }}...# é™æ€èµ„æºé…ç½®STATIC_URL = &#39;/static/&#39;   # é»˜è®¤# STATIC_ROOTç”¨äºæ”¶é›†é¡¹ç›®ä¸‹é™æ€èµ„æº,STATICFILES_DIRSå’ŒSTATIC_ROOTä¸èƒ½å…±å­˜,æ³¨é”€STATICFILES_DIRS#STATICFILES_DIRS = [#     os.path.join(BASE_DIR,&#39;static&#39;)# ]STATIC_ROOT = os.path.join(BASE_DIR, &quot;static/&quot;)...</code></pre><blockquote><p>é…ç½®å®Œsettings.pyæ–‡ä»¶ååœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ: python manage.py collectstatic<br>ç”¨äºæ”¶é›†é™æ€æ–‡ä»¶,æ‰§è¡Œååœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„staticæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸€ä¸ªadminçš„æ–‡ä»¶å¤¹</p></blockquote><h2 id="é…ç½®nginx"><a href="#é…ç½®nginx" class="headerlink" title="é…ç½®nginx"></a>é…ç½®nginx</h2><pre><code class="bash">vi /etc/nginx/nginx.confuser root ; # ä»¥rootç”¨æˆ·å¯åŠ¨nginx,å¦åˆ™å¯èƒ½ä¼šå› ä¸ºæƒé™é—®é¢˜è€Œä¸¢å¤±æ‰€æœ‰æ ·å¼...</code></pre><pre><code class="bash">vi /etc/nginx/conf.d/default.conf# åœ¨æ–‡ä»¶æœ€åï¼Œæ–°åŠ ä¸€ä¸ªserver æˆ–è€…åœ¨åŒçº§ç›®å½•ä¸‹æ·»åŠ xxx.confæ–‡ä»¶,åœ¨å…¶ä¸­æ·»åŠ server# å¯æŸ¥çœ‹/etc/nginx/nginx.confä¾¿äºç†è§£server {    listen       8089;    listen      [::]:8089;    server_name 127.0.0.1 192.168.10.114;     location / {        include /etc/nginx/uwsgi_params;        uwsgi_pass 127.0.0.1:9000;    }    location /static{        alias /home/root/pydj/django_one/sign/static;    }}</code></pre><ul><li>8089 æ˜¯å¯¹å¤–çš„ç«¯å£å·</li><li>server_name nginxä»£ç†uwsgiå¯¹å¤–çš„ip,192.168.10.114ä¸ºnginxæœåŠ¡å™¨æ‰€åœ¨çš„ip</li><li>127.0.0.1:9000 å³å½“nginxæœåŠ¡å™¨æ”¶åˆ°8089ç«¯å£çš„è¯·æ±‚æ—¶ï¼Œç›´æ¥å°†è¯·æ±‚è½¬å‘ç»™ 127.0.0.1:9000</li></ul><h2 id="é‡å¯Nginx"><a href="#é‡å¯Nginx" class="headerlink" title="é‡å¯Nginx"></a>é‡å¯Nginx</h2><p>systemctl restart nginx</p><p>secrtcrt<br>filiza<br>xshell</p><h2 id="uwsgiå¯åŠ¨django"><a href="#uwsgiå¯åŠ¨django" class="headerlink" title="uwsgiå¯åŠ¨django"></a>uwsgiå¯åŠ¨django</h2><blockquote><p>ä¸´æ—¶å…³é—­é˜²ç«å¢™</p></blockquote><pre><code class="bash">    systemctl stop firewalld.service</code></pre><blockquote><p>å¦‚æœåœ¨è™šæ‹Ÿæœºä¸­éƒ¨ç½²æµ‹è¯•é¡¹ç›®æ—¶,ä¸»æœºè®¿é—®æ—¶å¯èƒ½éœ€è¦åœ¨æ§åˆ¶é¢æ¿ä¸­å…³é—­é˜²ç«å¢™</p></blockquote><blockquote><p>æ³¨æ„å…ˆè¿›å…¥è™šæ‹Ÿç¯å¢ƒä¸‹,è¿™æ ·åˆ›å»ºçš„venvè™šæ‹Ÿç¯å¢ƒæ‰èƒ½ç”Ÿæ•ˆ</p></blockquote><pre><code class="bash"># è¿›å…¥é¡¹ç›®æ ¹ç›®å½•/home/root/pydj/django_one# å¯åŠ¨uwsgi --ini django_uwsgi.ini</code></pre><h2 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h2><h3 id="1-è½®è¯¢"><a href="#1-è½®è¯¢" class="headerlink" title="1. è½®è¯¢"></a>1. è½®è¯¢</h3><blockquote><p>é…ç½®nginxé…ç½®æ–‡ä»¶,åœ¨<code>/etc/nginx/conf.d/default.conf</code>è¿½åŠ å¦‚ä¸‹å†…å®¹:</p></blockquote><pre><code class="bash">upstream fresh{        # è®¾ç½®å¤šä¸ªuwsgiä»£ç†ç«¯å£        server 192.168.52.193:9000;        server 192.168.52.210:9000;        server 127.0.0.1:9000;}server{        listen  8009;  # nginxç›‘å¬ç«¯å£        location / {                include /etc/nginx/uwsgi_params;                # åº”ç”¨uwsgiä»£ç†ç«¯å£                uwsgi_pass fresh;        }        location /static{                alias /home/zy/fresh/fresh/static;        }}</code></pre><ul><li>ç„¶åè®¿é—®â€™nginxæœåŠ¡å™¨ip:8009/â€¦â€™,ç«¯å£ä¸ºnginxæœåŠ¡ç›‘å¬çš„ç«¯å£,æ­¤æ—¶è½®è¯¢æ¯ä¸ªuwsgiæœåŠ¡.</li></ul><h3 id="2-æŒ‡å®šæƒé‡"><a href="#2-æŒ‡å®šæƒé‡" class="headerlink" title="2. æŒ‡å®šæƒé‡"></a>2. æŒ‡å®šæƒé‡</h3><blockquote><p>æŒ‡å®šè½®è¯¢æ¯”é‡,weightå’Œè®¿é—®çš„æ¯”ç‡æˆæ­£æ¯”,å¸¸ç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡æ—¶</p></blockquote><pre><code class="bash">upstream fresh{        # è®¾ç½®å¤šä¸ªuwsgiä»£ç†ç«¯å£        server 192.168.52.193:9000 weight=10;        server 192.168.52.210 weight=10;        server 127.0.0.1:9000;}</code></pre><h3 id="3-IPç»‘å®šip-hash"><a href="#3-IPç»‘å®šip-hash" class="headerlink" title="3. IPç»‘å®šip_hash"></a>3. IPç»‘å®šip_hash</h3><blockquote><p>æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®ipçš„hasgç»“æœåˆ†é…,è¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨,ç”¨äºè§£å†³sessionä¼šè¯é—®é¢˜</p></blockquote><pre><code class="bash">upstream fresh{        # è®¾ç½®å¤šä¸ªuwsgiä»£ç†ç«¯å£        ip_hash;        server 192.168.52.193:9000;        server 192.168.52.210;        server 127.0.0.1:9000;}</code></pre><h3 id="4-fair-ç¬¬ä¸‰æ–¹"><a href="#4-fair-ç¬¬ä¸‰æ–¹" class="headerlink" title="4. fair(ç¬¬ä¸‰æ–¹)"></a>4. fair(ç¬¬ä¸‰æ–¹)</h3><blockquote><p>æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚,å“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…</p></blockquote><pre><code class="bash">upstream fresh{        # è®¾ç½®å¤šä¸ªuwsgiä»£ç†ç«¯å£        server 192.168.52.193:9000;        server 192.168.52.210;        server 127.0.0.1:9000;        fair;}</code></pre><h3 id="5-url-hash"><a href="#5-url-hash" class="headerlink" title="5. url_hash"></a>5. url_hash</h3><blockquote><p>æŒ‰è®¿é—®urlçš„hashç»“æœæ¥åˆ†é…è¯·æ±‚,æ˜¯æ¯ä¸ªurlå®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨,åç«¯æœåŠ¡å™¨ä¸ºç¼“å­˜æ—¶æ¯”è¾ƒæœ‰æ•ˆ</p></blockquote><pre><code class="bash">upstream fresh{        # è®¾ç½®å¤šä¸ªuwsgiä»£ç†ç«¯å£        server 192.168.52.193:9000;        server 192.168.52.210;        server 127.0.0.1:9000;        hash $request_url;        hash_method crc32;}</code></pre><h2 id="é—®é¢˜æ±‡æ€»"><a href="#é—®é¢˜æ±‡æ€»" class="headerlink" title="é—®é¢˜æ±‡æ€»"></a>é—®é¢˜æ±‡æ€»</h2><blockquote><p>å¯åŠ¨æ—¶åˆ‡æ¢rootç”¨æˆ·ææƒ</p></blockquote><pre><code>su     # åˆ‡æ¢rootç”¨æˆ·su - zy  # åˆ‡æ¢æ™®é€šç”¨æˆ·</code></pre><blockquote><p>æ— æ³•è¿æ¥æ•°æ®åº“,å¯èƒ½æ•°æ®åº“æœªæ­£ç¡®å®‰è£…</p></blockquote><pre><code>yum install mysql-devel gcc gcc-devel python-develsemanage port -l | grep http_port_t</code></pre><blockquote><p>é…ç½®mysqlå¯ä»¥è¢«å±€åŸŸç½‘ä»»æ„ä¸»æœºè®¿é—®; 1130é”™è¯¯ æç¤ºä¸»æœºæ²¡æœ‰è®¿é—®æ•°æ®åº“æƒé™; 1045é”™è¯¯ æç¤ºä¸»æœºæ‹’ç»è®¿é—®</p></blockquote><pre><code>mysql&amp;gt; use mysql; mysql&amp;gt; update user set host = &amp;#039;%&amp;#039; where user = &amp;#039;root&amp;#039;; mysql&amp;gt; select host, user from user; mysql&amp;gt; flush privileges;</code></pre><blockquote><p>[emerg] 31879#31879: bind() to 0.0.0.0:8089 failed (13: Permission denied)</p></blockquote><p>ç»‘å®šç«¯å£å¤±è´¥,ç«¯å£å ç”¨æˆ–è€…ä¸æ”¯æŒæˆ–è€…selinuxæƒé™æ§åˆ¶</p><pre><code>sudo semanage port -l | grep http_port_t      # æŸ¥çœ‹å¯ç”¨ç«¯å£sudo semanage port -a -t http_port_t  -p tcp 8024    # å¯å°†è‡ªå®šä¹‰ç«¯å£åŠ å…¥å…¶ä¸­netstat -lnp|grep 88 , lsof -i : 8000  , ps --help    # æŸ¥çœ‹ç«¯å£çŠ¶æ€kill -9 1777     # æŒ‡å®špidæ€æ‰è¿›ç¨‹</code></pre><blockquote><p>æ ·å¼æ–‡ä»¶å¤±æ•ˆ</p></blockquote><p>Selinux æ§åˆ¶è®¿é—®æƒé™,é»˜è®¤ä¸¥æ ¼æ¨¡å¼,é€šè¿‡ä»¥ä¸‹å‘½ä»¤ä¸´æ—¶æ”¾å®½è®¿é—®æƒé™</p><pre><code># ä¸´æ—¶å…³é—­:[root@localhost ~]# getenforceEnforcing[root@localhost ~]# setenforce 0[root@localhost ~]# getenforcePermissive# æ°¸ä¹…å…³é—­[root@localhost ~]# vim /etc/sysconfig/selinuxSELINUX=enforcing æ”¹ä¸º SELINUX=disabledé‡å¯æœåŠ¡reboot</code></pre><blockquote><p>éƒ¨ç½²å¤§è‡´æµç¨‹</p></blockquote><ul><li>ä¿®æ”¹settingæ–‡ä»¶ä¹‹å</li><li>python manage.py collectstatic æ”¶é›†adminé™æ€æ–‡ä»¶</li><li>ä¿®æ”¹uwsgi.ini</li><li>å¯åŠ¨</li><li>uwsgi â€“ini django_uwsgi.ini   â€“buffer-size 32768</li><li>æ·»åŠ nginxé…ç½®æ–‡ä»¶</li><li>é‡å¯nginx</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>web</tag>
      
      <tag>Django</tag>
      
      <tag>nginx</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¼–ç è§„èŒƒ</title>
    <link href="undefined2018/09/04/2018-09-04-%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/"/>
    <url>2018/09/04/2018-09-04-%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/</url>
    
    <content type="html"><![CDATA[<h1 id="PEP8è§„èŒƒ"><a href="#PEP8è§„èŒƒ" class="headerlink" title="PEP8è§„èŒƒ"></a>PEP8è§„èŒƒ</h1><p>ï¼ˆä¸€ï¼‰ ä»£ç çš„ç¼–æ’<br>1ã€ ç¼©è¿›ã€‚æ¯è¡Œéœ€è¦4ä¸ªç©ºæ ¼çš„ç¼©è¿›ï¼Œä¸è¦ä½¿ç”¨Tapé”®ï¼Œæ›´ä¸èƒ½æ··åˆä½¿ç”¨Tapé”®å’Œç©ºæ ¼ã€‚<br>2 ã€æ¯è¡Œæœ€å¤§é•¿åº¦79ï¼Œæ¢è¡Œå¯ä»¥ä½¿ç”¨åæ–œæ ï¼Œä½†æœ€å¥½ä½¿ç”¨åœ†æ‹¬å·ã€‚æ¢è¡Œç‚¹è¦åœ¨æ“ä½œç¬¦çš„åè¾¹æ•²å›è½¦ã€‚<br>3 ã€ç±»å’Œtop-levelå‡½æ•°å®šä¹‰ä¹‹é—´ç©ºä¸¤è¡Œï¼›ç±»ä¸­çš„æ–¹æ³•å®šä¹‰ä¹‹é—´ç©ºä¸€è¡Œï¼›å‡½æ•°å†…é€»è¾‘æ— å…³æ®µè½ä¹‹é—´ç©ºä¸€è¡Œï¼›å…¶ä»–åœ°æ–¹å°½é‡ä¸è¦å†ç©ºè¡Œã€‚</p><a id="more"></a><p>ï¼ˆäºŒ ï¼‰æ–‡æ¡£çš„ç¼–æ’<br>1ã€ æ¨¡å—å†…å®¹çš„é¡ºåºï¼šæ¨¡å—è¯´æ˜å’Œdocstringâ€”importâ€”globals&amp;constantsâ€”å…¶ä»–å®šä¹‰ã€‚å…¶ä¸­importéƒ¨åˆ†ï¼ŒåˆæŒ‰æ ‡å‡†ã€ç¬¬ä¸‰æ–¹å’Œè‡ªå·±ç¼–å†™é¡ºåºä¾æ¬¡æ’æ”¾ï¼Œä¹‹é—´ç©ºä¸€è¡Œã€‚</p><p>from django.db import models<br>from datetime import datetime</p><p>from django.contrib.auth.models import AbstractUser</p><h1 id="è‡ªå·±å®šä¹‰ä»£ç æ”¾ç½®å¤„"><a href="#è‡ªå·±å®šä¹‰ä»£ç æ”¾ç½®å¤„" class="headerlink" title="è‡ªå·±å®šä¹‰ä»£ç æ”¾ç½®å¤„"></a>è‡ªå·±å®šä¹‰ä»£ç æ”¾ç½®å¤„</h1><p>2 ã€ä¸è¦åœ¨ä¸€è¡Œimportå¤šä¸ªåº“ï¼Œæ¯”å¦‚import os, sysï¼Œè™½è¯´æ²¡æœ‰é”™è¯¯ä½†æ˜¯å¹¶ä¸æ¨èã€‚<br>3ã€ å¦‚æœé‡‡ç”¨from xx import xxçš„æ–¹å¼æ¥å¼•ç”¨æŸä¸ªåº“ï¼Œå¯ä»¥çœç•¥module.ï¼Œä½†æ˜¯å¯èƒ½ä¼šå‡ºç°å‘½åçš„å†²çªï¼Œæ‰€ä»¥è¿™æ—¶å°±è¦é‡‡ç”¨import xxçš„æ–¹å¼ã€‚</p><p>ï¼ˆä¸‰ï¼‰ç©ºæ ¼çš„ä½¿ç”¨<br>æ€»ä½“åŸåˆ™ï¼Œé¿å…ä¸å¿…è¦çš„ç©ºæ ¼ã€‚<br>1ã€ å„ç§å³æ‹¬å·å‰ä¸è¦åŠ ç©ºæ ¼ã€‚<br>2ã€ é€—å·ã€å†’å·ã€åˆ†å·å‰ä¸è¦åŠ ç©ºæ ¼ã€‚<br>3 ã€å‡½æ•°çš„å·¦æ‹¬å·å‰ä¸è¦åŠ ç©ºæ ¼ã€‚å¦‚function(1)ã€‚<br>4 ã€åºåˆ—çš„å·¦æ‹¬å·å‰ä¸è¦åŠ ç©ºæ ¼ã€‚å¦‚list[2]ã€‚<br>5ã€æ“ä½œç¬¦å·¦å³å„åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œä¸è¦ä¸ºäº†å¯¹é½å¢åŠ ç©ºæ ¼ã€‚<br>6 ã€å‡½æ•°é»˜è®¤å‚æ•°ä½¿ç”¨çš„èµ‹å€¼ç¬¦å·¦å³çœç•¥ç©ºæ ¼ã€‚<br>7ã€ä¸è¦å°†å¤šå¥è¯­å¥å†™åœ¨åŒä¸€è¡Œï¼Œå°½ç®¡ä½¿ç”¨ï¼›å…è®¸ã€‚<br>8ã€ if/for/whileè¯­å¥ä¸­ï¼Œå³ä½¿æ‰§è¡Œè¯­å¥åªæœ‰ä¸€å¥ï¼Œä¹Ÿå¿…é¡»å¦èµ·ä¸€è¡Œã€‚</p><p>ï¼ˆå››ï¼‰å‘½åçš„è§„èŒƒ<br>æ€»ä½“åŸåˆ™ï¼Œæ–°ç¼–ä»£ç å¿…é¡»æŒ‰ä¸‹é¢å‘½åé£æ ¼è¿›è¡Œï¼Œç°æœ‰åº“çš„ç¼–ç å°½é‡ä¿æŒé£æ ¼ã€‚<br>1 ã€å°½é‡å•ç‹¬ä½¿ç”¨å°å†™å­—æ¯â€˜lâ€™ï¼Œå¤§å†™å­—æ¯â€˜Oâ€™ç­‰å®¹æ˜“æ··æ·†çš„å­—æ¯ã€‚<br>2ã€ æ¨¡å—å‘½åå°½é‡çŸ­å°ï¼Œä½¿ç”¨å…¨éƒ¨å°å†™çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚<br>3ã€ åŒ…å‘½åå°½é‡çŸ­å°ï¼Œä½¿ç”¨å…¨éƒ¨å°å†™çš„æ–¹å¼ï¼Œä¸å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚<br>4ã€ ç±»çš„å‘½åä½¿ç”¨CapWordsçš„æ–¹å¼ï¼Œæ¨¡å—å†…éƒ¨ä½¿ç”¨çš„ç±»é‡‡ç”¨_CapWordsçš„æ–¹å¼ã€‚<br>5ã€ å¼‚å¸¸å‘½åä½¿ç”¨CapWords+Erroråç¼€çš„æ–¹å¼ã€‚<br>6 ã€å…¨å±€å˜é‡å°½é‡åªåœ¨æ¨¡å—å†…æœ‰æ•ˆï¼Œç±»ä¼¼Cè¯­è¨€ä¸­çš„staticã€‚å®ç°æ–¹æ³•æœ‰ä¸¤ç§ï¼Œä¸€æ˜¯allæœºåˆ¶;äºŒæ˜¯å‰ç¼€ä¸€ä¸ªä¸‹åˆ’çº¿ã€‚<br>7 ã€å‡½æ•°å‘½åä½¿ç”¨å…¨éƒ¨å°å†™çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚<br>8 ã€å¸¸é‡å‘½åä½¿ç”¨å…¨éƒ¨å¤§å†™çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚<br>9 ã€ç±»çš„å±æ€§ï¼ˆæ–¹æ³•å’Œå˜é‡ï¼‰å‘½åä½¿ç”¨å…¨éƒ¨å°å†™çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚<br>10ã€ç±»çš„å±æ€§æœ‰3ç§ä½œç”¨åŸŸpublicã€non-publicå’Œsubclass APIï¼Œå¯ä»¥ç†è§£æˆC++ä¸­çš„publicã€privateã€protectedï¼Œnon-publicå±æ€§å‰ï¼Œå‰ç¼€ä¸€æ¡ä¸‹åˆ’çº¿ã€‚<br>11 ã€ç±»çš„å±æ€§è‹¥ä¸å…³é”®å­—åå­—å†²çªï¼Œåç¼€ä¸€ä¸‹åˆ’çº¿ï¼Œå°½é‡ä¸è¦ä½¿ç”¨ç¼©ç•¥ç­‰å…¶ä»–æ–¹å¼ã€‚<br>12 ã€ä¸ºé¿å…ä¸å­ç±»å±æ€§å‘½åå†²çªï¼Œåœ¨ç±»çš„ä¸€äº›å±æ€§å‰ï¼Œå‰ç¼€ä¸¤æ¡ä¸‹åˆ’çº¿ã€‚æ¯”å¦‚ï¼šç±»Fooä¸­å£°æ˜<strong>a,è®¿é—®æ—¶ï¼Œåªèƒ½é€šè¿‡`Foo._Foo</strong>a`ï¼Œé¿å…æ­§ä¹‰ã€‚å¦‚æœå­ç±»ä¹Ÿå«Fooï¼Œé‚£å°±æ— èƒ½ä¸ºåŠ›äº†ã€‚<br>13 ã€ç±»çš„æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯selfï¼Œè€Œé™æ€æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯clsã€‚</p><p>ï¼ˆäº”ï¼‰ç¼–ç çš„å»ºè®®<br>1ã€ç¼–ç ä¸­è€ƒè™‘åˆ°å…¶ä»–pythonå®ç°çš„æ•ˆç‡ç­‰é—®é¢˜ï¼Œæ¯”å¦‚è¿ç®—ç¬¦â€˜+â€™åœ¨CPythonï¼ˆPythonï¼‰ä¸­æ•ˆç‡å¾ˆé«˜ï¼Œéƒ½æ˜¯Jythonä¸­å´éå¸¸ä½ï¼Œæ‰€ä»¥åº”è¯¥é‡‡ç”¨.join()çš„æ–¹å¼ã€‚<br>2 ã€å°½å¯èƒ½ä½¿ç”¨â€˜isâ€™â€˜is notâ€™å–ä»£â€˜==â€™ï¼Œæ¯”å¦‚if x is not None è¦ä¼˜äºif xã€‚<br>3 ã€ä½¿ç”¨åŸºäºç±»çš„å¼‚å¸¸ï¼Œæ¯ä¸ªæ¨¡å—æˆ–åŒ…éƒ½æœ‰è‡ªå·±çš„å¼‚å¸¸ç±»ï¼Œæ­¤å¼‚å¸¸ç±»ç»§æ‰¿è‡ªExceptionã€‚<br>4 ã€å¼‚å¸¸ä¸­ä¸è¦ä½¿ç”¨è£¸éœ²çš„exceptï¼Œexceptåè·Ÿå…·ä½“çš„exceptionsã€‚<br>5 ã€å¼‚å¸¸ä¸­tryçš„ä»£ç å°½å¯èƒ½å°‘ã€‚æ¯”å¦‚ï¼š</p><pre><code>try:value = collection[key]except KeyError:return key_not_found(key)else:return handle_value(value)</code></pre><p>è¦ä¼˜äº</p><pre><code>try:# Too broad!return handle_value(collection[key])except KeyError:# Will also catch KeyError raised by handle_value()return key_not_found(key)</code></pre><p>6 ã€ä½¿ç”¨startswith() and endswith()ä»£æ›¿åˆ‡ç‰‡è¿›è¡Œåºåˆ—å‰ç¼€æˆ–åç¼€çš„æ£€æŸ¥ã€‚æ¯”å¦‚:<br>Yes: if foo.startswith(â€˜barâ€™):ä¼˜äºNo: if foo[:3] == â€˜barâ€™:<br>7 ã€ä½¿ç”¨isinstance()æ¯”è¾ƒå¯¹è±¡çš„ç±»å‹ã€‚æ¯”å¦‚:<br>Yes: if isinstance(obj, int):ä¼˜äºNo: if type(obj) is type(1):<br>8ã€ åˆ¤æ–­åºåˆ—ç©ºæˆ–ä¸ç©ºï¼Œæœ‰å¦‚ä¸‹è§„åˆ™:</p><p>Yes: if not seq:<br>if seq:<br>ä¼˜äº</p><p>No: if len(seq)<br>if not len(seq)<br>9 ã€å­—ç¬¦ä¸²ä¸è¦ä»¥ç©ºæ ¼æ”¶å°¾ã€‚<br>10ã€äºŒè¿›åˆ¶æ•°æ®åˆ¤æ–­ä½¿ç”¨ if boolvalueçš„æ–¹å¼ã€‚</p><p>å¦‚æœä½ æƒ³è·å¾—æ›´å¤šå…³äºPEP8çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥é˜…è¿™ç¯‡ä¿¡æ¯PEP8 Python ç¼–ç è§„èŒƒæ•´ç†æˆ–è€…å®˜æ–¹æ–‡æ¡£PEP8çš„å®˜æ–¹æ–‡æ¡£</p>]]></content>
    
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>web</tag>
      
      <tag>Django</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Djangoä½¿ç”¨</title>
    <link href="undefined2018/09/04/2018-09-04-Django%E4%BD%BF%E7%94%A8/"/>
    <url>2018/09/04/2018-09-04-Django%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬ç¯‡å†…å®¹éœ€å…·å¤‡ä¸Šç¯‡<a href="https://zyboy.top/2018/09/03/2018-09-03-Django/">Djangoç®€ä»‹</a>åŸºç¡€</p></blockquote><a id="more"></a><h3 id="æ•°æ®æ¨¡å‹models-py"><a href="#æ•°æ®æ¨¡å‹models-py" class="headerlink" title="æ•°æ®æ¨¡å‹models.py"></a>æ•°æ®æ¨¡å‹<code>models.py</code></h3><blockquote><p>é€šè¿‡å‘½ä»¤<code>django-admin startapp myApp</code>åˆ›å»º<code>myApp</code>åå³å¯å‘<code>models.py</code>æ·»åŠ å†…å®¹:</p></blockquote><pre><code class="python">from django.db import models# Create your models here.class Table1(models.Model):    name = models.CharField(max_length=20,unique=True)    age = models.IntegerField()    # è‡ªå®šä¹‰æ˜¾ç¤ºæŸ¥è¯¢ç»“æœçš„å­—æ®µ å¦åˆ™ä¸ºobjectå¯¹è±¡     def __str__(self):        return self.name+&#39;,&#39;+self.age</code></pre><blockquote><p>åœ¨ç»ˆç«¯ä¸­åˆ‡æ¢ç›®å½•åˆ°é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤:</p></blockquote><pre><code>\&gt; python manage.py makemigrations</code></pre><blockquote><p>æŸ¥çœ‹åœ¨<code>migrations</code>æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆçš„è¿ç§»æ–‡ä»¶:</p></blockquote><pre><code class="python"># Generated by Django 2.1.1 on 2018-09-04 12:34from django.db import migrations, modelsclass Migration(migrations.Migration):    initial = True    dependencies = [    ]    operations = [        migrations.CreateModel(            name=&#39;Table1&#39;,            fields=[                (&#39;id&#39;, models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name=&#39;ID&#39;)),                (&#39;name&#39;, models.CharField(max_length=20, unique=True)),                (&#39;age&#39;, models.IntegerField()),            ],        ),    ]</code></pre><blockquote><p>è¿ç§»æ–‡ä»¶:</p></blockquote><pre><code>\&gt; python manage.py migrate</code></pre><blockquote><p>æ­¤æ—¶æ•°æ®åº“å¯ç”¨</p></blockquote><blockquote><p>æµ‹è¯•æ•°æ®åº“å¯åœ¨å‘½ä»¤äº¤äº’ç•Œé¢è¿›è¡Œ:</p></blockquote><pre><code>\&gt; python manage.py shell\&gt;[]: from myApp.models import First   -- å¼•å…¥æ•°æ®æ¨¡å‹:&lt;!-- æ·»åŠ æ•°æ®çš„æ–¹å¼1 --&gt;\&gt;[]: first = First(name=&quot;lisi&quot;,des=&quot;my first friend&quot;)\&gt;[]: first.save()&lt;!-- æ–¹å¼2 --&gt;\&gt;[]: second = First.objects.create(name=&quot;hello&quot;,des=&quot;world&quot;)&lt;!-- è·å–æ•°æ® --&gt;\&gt;[]: First.objects.all() ----æŸ¥çœ‹æ‰€æœ‰æ•°æ®,å¢åŠ äº†def __str__()æ–¹æ³•åèƒ½å‹å¥½æ˜¾ç¤º\&gt;[]: user = First.objects.get(id=&quot;&quot;/name=&quot;&quot;/des=&quot;&quot;)\&gt;[]: user.name\&gt;[]: user.des\&gt;[]: user.id&lt;!-- é€€å‡ºshell --&gt;\&gt;[]: exit()</code></pre><blockquote><p>æŸ¥çœ‹ä¿å­˜çš„æ•°æ®,é¡»åœ¨<code>views.py</code>ä¸­è®¾ç½®,æ–¹æ³•åŒä¸Š:</p><blockquote><p>1.å¼•å…¥æ¨¡å‹ è·å–æ‰€æœ‰æ•°æ®<code>First.objects.all()</code><br>2.return</p></blockquote></blockquote><blockquote><p><a href="https://github.com/zysxm/Learning.github.io/tree/master/Python/9.04/Django-models/myModels" target="_blank" rel="noopener" title="ç‚¹å‡»è¿›å…¥">å‚è€ƒæºç </a></p></blockquote><h3 id="urls-py"><a href="#urls-py" class="headerlink" title="urls.py"></a>urls.py</h3><blockquote><p>1.é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹çš„<code>urls.py</code></p></blockquote><pre><code class="python">from django.contrib import adminfrom django.urls import pathfrom django.urls.conf import include# å¯¼å…¥appä¸­çš„è§†å›¾æ–‡ä»¶from myFirst import viewsurlpatterns = [    path(&#39;admin/&#39;, admin.site.urls),    # path(&#39;regist/&#39;,views.regist) ,    # path(&#39;login/&#39;,views.login),    # åœ¨localhostç«¯å£åé¢æ·»åŠ ä¸€ä¸ªè·¯å¾„first    # è¯¥è·¯å¾„ä¸‹é¢è¿˜æœ‰å…¶ä»–ä¸¤ä¸ªè·¯å¾„  registå’Œlogin    path(&#39;first/&#39;,include(&#39;myFirst.urls&#39;)),    path(&#39;second/&#39;,include(&#39;mySecond.urls&#39;)),    path(r&#39;third/&#39;,include(&#39;myThird.urls&#39;))]</code></pre><blockquote><p>2.åº”ç”¨<code>myApp</code>ä¸­çš„<code>urls.py</code></p></blockquote><pre><code class="python">from django.urls import pathfrom django.conf.urls import urlfrom . import views# å¯¹åº”é¡¹ç›®ä¸‹çš„åº”ç”¨myFirsturlpatterns = [    path(r&#39;regist/&#39;,views.regist),    path(r&#39;login/&#39;,views.login)]# å¯¹åº”é¡¹ç›®ä¸‹çš„åº”ç”¨mySecondurlpatterns=[    url(r&#39;add/&#39;,views.add),    url(r&#39;addTwo/&#39;,views.addTwo)]# å¯¹åº”é¡¹ç›®ä¸‹çš„åº”ç”¨myThirdurlpatterns = [    url(r&#39;red/&#39;,views.myFirst),    url(r&#39;black/&#39;,views.mySecond)]</code></pre><blockquote><p>åœ¨æ¯ä¸ªåº”ç”¨ä¸‹çš„<code>views.py</code>æ–‡ä»¶ä¸­æ·»åŠ æ¸²æŸ“ä»£ç ,å¦‚åº”ç”¨ä¸­çš„<code>myFirst</code>ä¸‹çš„<code>views.py</code>æ–‡ä»¶</p></blockquote><blockquote><p>æ­¤æ—¶æ•´ä¸ªé¡¹ç›®çš„ç›®å½•ç»“æ„:</p></blockquote><pre><code class="cmd">ddjangoUrlsâ”‚  â”‚  __init__.pyâ”‚  â”‚â”‚  â””â”€myUrlsâ”‚      â”‚  db.sqlite3â”‚      â”‚  manage.pyâ”‚      â”‚  __init__.pyâ”‚      â”‚â”‚      â”œâ”€myFirstâ”‚      â”‚  â”‚  admin.pyâ”‚      â”‚  â”‚  apps.pyâ”‚      â”‚  â”‚  models.pyâ”‚      â”‚  â”‚  tests.pyâ”‚      â”‚  â”‚  urls.pyâ”‚      â”‚  â”‚  views.pyâ”‚      â”‚  â”‚  __init__.pyâ”‚      â”‚  â”‚â”‚      â”‚  â”œâ”€migrationsâ”‚      â”‚  â”‚  â”‚  __init__.pyâ”‚      â”‚  â”‚  â”‚â”‚      â”‚  â”‚  â””â”€__pycache__â”‚      â”‚  â”‚          __init__.cpython-36.pycâ”‚      â”‚  â”‚â”‚      â”‚  â””â”€__pycache__â”‚      â”‚          ...â”‚      â”‚â”‚      â”œâ”€mySecondâ”‚      â”‚          ...â”‚      â”‚â”‚      â”œâ”€myThirdâ”‚      â”‚  â”‚       ...â”‚      â””â”€myUrlsâ”‚          â”‚  settings.pyâ”‚          â”‚  urls.pyâ”‚          â”‚  wsgi.pyâ”‚          â”‚  __init__.pyâ”‚          â”‚â”‚          â””â”€__pycache__â”‚                  ...</code></pre><pre><code class="python">from django.shortcuts import renderfrom django.http import HttpResponse# Create your views here.def regist(request):    return HttpResponse(&#39;myFirsté‡Œé¢çš„æ³¨å†Œé¡µé¢&#39;)def login(request):    return HttpResponse(&#39;myFirsté‡Œé¢çš„ç™»å½•é¡µé¢&#39;)</code></pre><blockquote><p><a href="https://github.com/zysxm/Learning.github.io/tree/master/Python/9.04/3.django-argument/myArgu" target="_blank" rel="noopener" title="ç‚¹å‡»è¿›å…¥">å‚è€ƒæºç </a></p></blockquote><h3 id="ä¼ é€’å‚æ•°-argument"><a href="#ä¼ é€’å‚æ•°-argument" class="headerlink" title="ä¼ é€’å‚æ•°(argument)"></a>ä¼ é€’å‚æ•°(argument)</h3><h3 id="æ¨¡æ¿ä½¿ç”¨-templates"><a href="#æ¨¡æ¿ä½¿ç”¨-templates" class="headerlink" title="æ¨¡æ¿ä½¿ç”¨(templates)"></a>æ¨¡æ¿ä½¿ç”¨(templates)</h3><h3 id="æ¨¡æ¿ç»§æ‰¿"><a href="#æ¨¡æ¿ç»§æ‰¿" class="headerlink" title="æ¨¡æ¿ç»§æ‰¿"></a>æ¨¡æ¿ç»§æ‰¿</h3><h3 id="è¡¨å•-forms"><a href="#è¡¨å•-forms" class="headerlink" title="è¡¨å•(forms)"></a>è¡¨å•(forms)</h3><h3 id="é‚®ä»¶å‘é€"><a href="#é‚®ä»¶å‘é€" class="headerlink" title="é‚®ä»¶å‘é€"></a>é‚®ä»¶å‘é€</h3>]]></content>
    
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>web</tag>
      
      <tag>Django</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Djangoç®€ä»‹</title>
    <link href="undefined2018/09/03/2018-09-03-Django/"/>
    <url>2018/09/03/2018-09-03-Django/</url>
    
    <content type="html"><![CDATA[<a id="more"></a><h3 id="1-å®‰è£…Django"><a href="#1-å®‰è£…Django" class="headerlink" title="1.å®‰è£…Django:"></a>1.å®‰è£…Django:</h3><blockquote><p>pip install django</p></blockquote><pre><code>        å®‰è£…æŒ‡å®šç‰ˆæœ¬ pip install django==1.8</code></pre><blockquote><p>æ¢æº: </p></blockquote><pre><code>        pip install -i https://pypi.tuna.tsinghua.edu.cn/simple django </code></pre><blockquote><p>æŸ¥çœ‹å®‰è£…æ˜¯å¦æˆåŠŸ:</p></blockquote><pre><code>        django-admin --version</code></pre><h3 id="2-åˆ›å»ºé¡¹ç›®"><a href="#2-åˆ›å»ºé¡¹ç›®" class="headerlink" title="2.åˆ›å»ºé¡¹ç›®"></a>2.åˆ›å»ºé¡¹ç›®</h3><blockquote><p>åˆ›å»ºä»»æ„ç›®å½•(django-first)</p></blockquote><blockquote><p>è¿›å…¥django-firstç›®å½•åˆ›å»ºé¡¹ç›®myFirst:</p></blockquote><pre><code>django-admin startproject myFirst</code></pre><blockquote><p>æ­¤æ—¶ç›®å½•ç»“æ„ä¸º: </p></blockquote><p><img src="/img/Django/1.png" srcset="/img/loading.gif" alt="img" title="img"></p><h3 id="3-å¯åŠ¨é¡¹ç›®-ä¸€å®šè¦è¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œå‘½ä»¤"><a href="#3-å¯åŠ¨é¡¹ç›®-ä¸€å®šè¦è¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œå‘½ä»¤" class="headerlink" title="3.å¯åŠ¨é¡¹ç›®(ä¸€å®šè¦è¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œå‘½ä»¤)"></a>3.å¯åŠ¨é¡¹ç›®(ä¸€å®šè¦è¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œå‘½ä»¤)</h3><blockquote><p>è¿›å…¥myFirstç›®å½•:</p></blockquote><pre><code>cd myFirst</code></pre><blockquote><p>æ‰§è¡Œå‘½ä»¤: </p></blockquote><pre><code>python manage.py runserver</code></pre><blockquote><p>å¦‚å›¾æ˜¾ç¤º å¯åŠ¨æˆåŠŸ.</p></blockquote><p><img src="/img/Django/2.png" srcset="/img/loading.gif" alt="img" title="img"></p><blockquote><p>ä¿®æ”¹é»˜è®¤ç«¯å£å·: </p></blockquote><pre><code>python manage.py runserver 8080</code></pre><h3 id="4-myFirstç›®å½•ä¸‹åˆ›å»ºapp"><a href="#4-myFirstç›®å½•ä¸‹åˆ›å»ºapp" class="headerlink" title="4.myFirstç›®å½•ä¸‹åˆ›å»ºapp:"></a>4.myFirstç›®å½•ä¸‹åˆ›å»ºapp:</h3><pre><code>django-admin startapp myApp</code></pre><h3 id="5-æ¸²æŸ“views-py-HttpResponse"><a href="#5-æ¸²æŸ“views-py-HttpResponse" class="headerlink" title="5.æ¸²æŸ“views.py  HttpResponse"></a>5.æ¸²æŸ“views.py  HttpResponse</h3><pre><code class="python">from django.shortcuts import renderfrom django.http import HttpResponse# Create your views here.def firstPage(request):    # æ³¨æ„ æ­¤å¤„éœ€è¦æ¥å—ä¸€ä¸ªè¯·æ±‚å¯¹è±¡ å¹¶ä¸”è¿”å›ä¸€ä¸ªå“åº”å¯¹è±¡    return HttpResponse(&#39;hello world&#39;)</code></pre><h3 id="6-urls-py-å½“ä¸­è®¾ç½®è·¯å¾„"><a href="#6-urls-py-å½“ä¸­è®¾ç½®è·¯å¾„" class="headerlink" title="6.urls.py å½“ä¸­è®¾ç½®è·¯å¾„"></a>6.urls.py å½“ä¸­è®¾ç½®è·¯å¾„</h3><pre><code class="python">&quot;&quot;&quot;myFirst URL ConfigurationThe `urlpatterns` list routes URLs to views. For more information please see:    https://docs.djangoproject.com/en/2.1/topics/http/urls/Examples:Function views    1. Add an import:  from my_app import views    2. Add a URL to urlpatterns:  path(&#39;&#39;, views.home, name=&#39;home&#39;)Class-based views    1. Add an import:  from other_app.views import Home    2. Add a URL to urlpatterns:  path(&#39;&#39;, Home.as_view(), name=&#39;home&#39;)Including another URLconf    1. Import the include() function: from django.urls import include, path    2. Add a URL to urlpatterns:  path(&#39;blog/&#39;, include(&#39;blog.urls&#39;))&quot;&quot;&quot;from django.contrib import adminfrom django.urls import pathfrom myApp import viewsurlpatterns = [    path(&#39;admin/&#39;, admin.site.urls),    path(r&#39;first/&#39;,views.firstPage,name=&#39;first&#39;)]</code></pre><blockquote><p>æ­¤æ—¶æµè§ˆå™¨ä¸­è¾“å…¥<code>http://127.0.0.1:8080/first</code>è®¿é—®</p></blockquote><h3 id="7-åˆ›å»ºtemplatesæ¨¡æ¿-views-pyä¸­è¿›è¡Œæ¸²æŸ“-settings-pyä¸­çš„TEMPLATESè¿›è¡Œè®¾ç½®"><a href="#7-åˆ›å»ºtemplatesæ¨¡æ¿-views-pyä¸­è¿›è¡Œæ¸²æŸ“-settings-pyä¸­çš„TEMPLATESè¿›è¡Œè®¾ç½®" class="headerlink" title="7.åˆ›å»ºtemplatesæ¨¡æ¿, views.pyä¸­è¿›è¡Œæ¸²æŸ“,settings.pyä¸­çš„TEMPLATESè¿›è¡Œè®¾ç½®"></a>7.åˆ›å»ºtemplatesæ¨¡æ¿, views.pyä¸­è¿›è¡Œæ¸²æŸ“,settings.pyä¸­çš„TEMPLATESè¿›è¡Œè®¾ç½®</h3><blockquote><p>åœ¨myFirsté¡¹ç›®ä¸‹åˆ›å»ºtemplatesæ¨¡æ¿æ–‡ä»¶å¤¹,å‘å…¶ä¸­æ·»åŠ first.htmlæ–‡ä»¶:</p></blockquote><p><img src="/img/Django/3.png" srcset="/img/loading.gif" alt="img" title="img"></p><blockquote><p>views.pyä¸­è¿›è¡Œæ¸²æŸ“,ä¿®æ”¹views.pyæ–‡ä»¶:</p></blockquote><pre><code class="python">from django.shortcuts import renderfrom django.http import HttpResponse# Create your views here.def firstPage(request):    # æ³¨æ„ æ­¤å¤„éœ€è¦æ¥å—ä¸€ä¸ªè¯·æ±‚å¯¹è±¡ å¹¶ä¸”è¿”å›ä¸€ä¸ªå“åº”å¯¹è±¡    # return HttpResponse(&#39;hello world&#39;)    return render(request,&#39;first.html&#39;)</code></pre><blockquote><p>settings.pyä¸­è®¾ç½®</p></blockquote><pre><code class="python">TEMPLATES = [    {        ...        # å°†templatesæ–‡ä»¶å¤¹è·¯å¾„æ·»åŠ è¿›æ¥        &#39;DIRS&#39;: [os.path.join(BASE_DIR,&#39;templates&#39;)],        ...            ],        },    },]INSTALLED_APPS = [    ...    # å°†åˆ›å»ºçš„appæ·»åŠ è¿›æ¥    &#39;myFirst&#39;,    &#39;mySecond&#39;,    &#39;myThird&#39;]</code></pre><blockquote><p>templatesä¸­first.htmlå†…å®¹:</p></blockquote><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;Djangoç¬¬ä¸€ä¸ªé¡µé¢&lt;/title&gt;    &lt;style&gt;        h1{            color: red;        }    &lt;/style&gt;&lt;/head&gt;&lt;body&gt;    &lt;h1&gt;è¿™æ˜¯æˆ‘å­¦ä¹ Djangoçš„ç¬¬ä¸€ä¸ªé¡µé¢&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><blockquote><p>å†æ¬¡è®¿é—®<code>http://127.0.0.1:8080/first</code></p></blockquote><p><img src="/img/Django/4.png" srcset="/img/loading.gif" alt="img" title="img"></p>]]></content>
    
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>web</tag>
      
      <tag>Django</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>node.jsè¿›é˜¶</title>
    <link href="undefined2018/08/30/2018-8-30-node.js%E8%BF%9B%E9%98%B6/"/>
    <url>2018/08/30/2018-8-30-node.js%E8%BF%9B%E9%98%B6/</url>
    
    <content type="html"><![CDATA[<blockquote><ul><li><p><a href="#getæ–¹æ³•">getæ–¹æ³•</a></p></li><li><p><a href="#postæ–¹æ³•">post</a></p></li><li><p><a href="#xhr">xhr(XMLHttpRequest)</a></p></li><li><p><a href="#formsè¡¨å•">formsè¡¨å•</a></p></li><li><p><a href="#fs">fs(æ–‡ä»¶è¯»å†™)</a></p></li><li><p><a href="#å°é¡¹ç›®ç»ƒä¹ ">å°é¡¹ç›®ç»ƒä¹ </a></p></li></ul></blockquote><a id="more"></a><h3 id="getæ–¹æ³•"><a href="#getæ–¹æ³•" class="headerlink" title="getæ–¹æ³•"></a>getæ–¹æ³•</h3><blockquote><p><code>index.html</code>,<a href="https://github.com/zysxm/Learning.github.io/tree/master/Python/8.30/form" target="_blank" rel="noopener" title="ç‚¹å‡»æŸ¥çœ‹">å‚è€ƒæºç </a></p></blockquote><pre><code class="html">...&lt;form action=&quot;/regist&quot;&gt;    &lt;h1&gt;regist&lt;/h1&gt;    &lt;label for=&quot;&quot;&gt;è´¦å·:&lt;/label&gt;    &lt;input name=&quot;user&quot; type=&quot;text&quot; placeholder=&quot;è¯·è¾“å…¥è´¦å·&quot;&gt;    &lt;br&gt;    &lt;label for=&quot;&quot;&gt;å¯†ç :&lt;/label&gt;    &lt;input name=&quot;psw&quot; type=&quot;password&quot; placeholder=&quot;è¯·è¾“å…¥å¯†ç &quot;&gt;    &lt;br&gt;    &lt;label for=&quot;&quot;&gt;é‡å¤å¯†ç :&lt;/label&gt;    &lt;input name=&quot;pswa&quot; type=&quot;password&quot; placeholder=&quot;è¯·é‡å¤å¯†ç &quot;&gt;    &lt;br&gt;    &lt;input type=&quot;submit&quot; value=&quot;æ³¨å†Œ&quot;&gt;&lt;/form&gt;...</code></pre><blockquote><p><code>index.js</code></p></blockquote><pre><code class="js">var express = require(&#39;express&#39;)// postè¯·æ±‚æ–¹å¼ä¼šå°†å‚æ•°æ”¾å…¥åˆ°è¯·æ±‚ä½“å½“ä¸­// æ‰€ä»¥éœ€è¦å¼•å…¥è§£æè¯·æ±‚ä½“çš„æ¨¡å—var bodyParser = require(&#39;body-parser&#39;)var web = express()web.use(express.static(&#39;public&#39;))// è®¾ç½®å¯¹urlè¿›è¡Œç¼–ç  å¹¶ä¸”ä¸å…è®¸urlè¿›è¡Œæ‰©å±•// å¦‚æœè®¾ç½®ä¸ºfalse é‚£ä¹ˆå‚æ•°åªèƒ½ä¸ºæ•°å€¼æˆ–è€…å­—ç¬¦ä¸²// å¦‚æœè®¾ç½®ä¸ºTrue é‚£ä¹ˆå‚æ•°ä¸ºä»»æ„ç±»å‹web.use(bodyParser.urlencoded({extended:false}))// å­˜å‚¨æ³¨å†ŒæˆåŠŸä»¥åçš„è´¦å·å’Œå¯†ç account = &#39;&#39;psw = &#39;&#39;web.get(&#39;/regist&#39;,function(req,res){    var password = req.query.psw    var password2 = req.query.pswa    var user = req.query.user    if(user != account &amp;&amp; password == password2){        account = user        psw = password        res.send(&#39;æ­å–œæ³¨å†Œç™»é™†æˆåŠŸ! è´¦å·æ˜¯&#39; + user + &#39;,å¯†ç æ˜¯&#39; + password + &#39;,è¯·å¦¥å–„ä¿ç®¡&#39;)    }    else{        res.send(&#39;æ³¨å†Œå¤±è´¥,è´¦å·å·²ç»æ³¨å†Œæˆ–è€…å¯†ç ä¸ä¸€è‡´&#39;)    }    console.log(password)    console.log(password2)})</code></pre><h3 id="postæ–¹æ³•"><a href="#postæ–¹æ³•" class="headerlink" title="postæ–¹æ³•"></a>postæ–¹æ³•</h3><blockquote><p><code>index.html</code>,<a href="https://github.com/zysxm/Learning.github.io/tree/master/Python/8.30/form" target="_blank" rel="noopener" title="ç‚¹å‡»æŸ¥çœ‹">å‚è€ƒæºç </a></p></blockquote><pre><code class="html">&lt;form action=&quot;/login&quot; method=&quot;POST&quot;&gt;    &lt;h1&gt;login&lt;/h1&gt;    &lt;label for=&quot;&quot;&gt;è´¦å·:&lt;/label&gt;    &lt;input name=&quot;user&quot; type=&quot;text&quot; placeholder=&quot;è¯·è¾“å…¥è´¦å·&quot;&gt;    &lt;br&gt;    &lt;label for=&quot;&quot;&gt;å¯†ç :&lt;/label&gt;    &lt;input name=&quot;password&quot; type=&quot;text&quot; placeholder=&quot;è¯·è¾“å…¥å¯†ç &quot;&gt;    &lt;br&gt;    &lt;input type=&quot;submit&quot; value=&quot;ç™»é™†&quot;&gt;&lt;/form&gt;</code></pre><blockquote><p><code>index.js</code></p></blockquote><pre><code class="js">web.post(&#39;/login&#39;,function(req,res){    var name = req.body.user    var password = req.body.password    if(name == account &amp;&amp; password == psw){        res.send(&#39;æ­å–œç™»é™†æˆåŠŸ&#39;)    }    else{        res.send(&#39;ç™»é™†å¤±è´¥,è¯·æ£€æŸ¥è´¦å·å’Œå¯†ç &#39;)    }})</code></pre><h3 id="xhr"><a href="#xhr" class="headerlink" title="xhr"></a>xhr</h3><blockquote><p><code>index.html</code>,<a href="https://github.com/zysxm/Learning.github.io/tree/master/Python/8.30/xhr" target="_blank" rel="noopener" title="ç‚¹å‡»æŸ¥çœ‹">å‚è€ƒæºç </a></p></blockquote><pre><code class="html">&lt;!-- &lt;form action=&quot;/login&quot;&gt;        &lt;input type=&quot;submit&quot;&gt;    &lt;/form&gt; --&gt;    &lt;!--     xhr    XMLHTTPRequest æ˜¯ajaxçš„æ ¸å¿ƒ    ajaxæ˜¯æ•°æ®è¯·æ±‚æ–¹å¼çš„ä¸€ç§    ç‰¹ç‚¹:    1.å‰ç«¯å¯ä»¥å‘é€æ•°æ®åˆ°åç«¯    2.å¯ä»¥æ¥å—ä»åç«¯å‘é€è¿‡æ¥çš„æ•°æ®    3.å¯ä»¥è§£æä»åç«¯ä¼ è¿‡æ¥çš„æ•°æ®    3.å¯ä»¥å¯¹é¡µé¢è¿›è¡Œå±€éƒ¨åˆ·æ–°æ“ä½œ    --&gt;    &lt;button onclick=&quot;get()&quot;&gt;xhrä¹‹getè¯·æ±‚&lt;/button&gt;    &lt;button onclick=&quot;post()&quot;&gt;xhrä¹‹postè¯·æ±‚&lt;/button&gt;    &lt;script&gt;        function get(){            // åˆ›å»ºä¸€ä¸ªæ•°æ®è¯·æ±‚çš„å®ä¾‹åŒ–å¯¹è±¡            var xhr =new XMLHttpRequest()            // on åœ¨...æ—¶å€™ ready å‡†å¤‡ state çŠ¶æ€ change æ”¹å˜            // åœ¨xhrçš„å‡†å¤‡çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ è°ƒç”¨è¯¥æ–¹æ³•            xhr.onreadystatechange = function(){                // åˆ¤æ–­xhrçš„å‡†å¤‡çŠ¶æ€                switch(xhr.readyState){                    case 0:{                        console.log(&#39;openæ–¹æ³•å·²ç»è°ƒç”¨, ä½†æ˜¯sendæ–¹æ³•æ²¡æœ‰è°ƒç”¨&#39;)                        break                    }                    case 1:{                        console.log(&#39;sendæ–¹æ³•å·²ç»è°ƒç”¨, ä½†æ˜¯æœåŠ¡å™¨å¹¶æ²¡æœ‰è¿”å›æ•°æ®&#39;)                        break                    }                    case 2:{                        console.log(&#39;sendæ–¹æ³•å·²ç»è°ƒç”¨, æœåŠ¡å™¨å¼€å§‹è¿”å›æ•°æ®&#39;)                        break                    }                    case 3:{                        console.log(&#39;æœåŠ¡å™¨å·²ç»è¿”å›éƒ¨åˆ†æ•°æ®&#39;)                        break                    }                    case 4:{                        console.log(&#39;æœåŠ¡å™¨å·²ç»è¿”å›å…¨éƒ¨æ•°æ®&#39;)                        console.log(xhr.response)                        console.log(xhr.responseText)                        console.log(xhr.responseURL)                        console.log(xhr.status)                        console.log(xhr.statusText)                        console.log(xhr.getAllResponseHeaders())                        break                    }                }            }            // openæ–¹æ³•é‡Œé¢ä¸¤ä¸ªå‚æ•°            // å‚æ•°1:æ•°æ®è¯·æ±‚æ–¹å¼ get post            // å‚æ•°2:è¯·æ±‚çš„æ¥å£ å‚æ•°æ‰æ¥å£åé¢è¿›è¡Œæ‹¼æ¥,åœ°å€æ æ–¹å¼ä¼ å‚            xhr.open(&#39;get&#39;,&#39;/getTest?name=å¦¹å­UI&amp;des=å‰ç«¯appæ¡†æ¶&#39;)            // å‘é€æ•°æ®åˆ°åç«¯            xhr.send()        }        function post(){            var xhr = new XMLHttpRequest()            // postè¯·æ±‚æ–¹å¼ æ¥å£åé¢ä¸èƒ½è¿½åŠ å‚æ•°            xhr.open(&#39;post&#39;,&#39;/postTest&#39;)            // å¦‚æœä½¿ç”¨postè¯·æ±‚æ–¹å¼ è€Œä¸”å‚æ•°æ˜¯ä»¥key=valueè¿™ç§æ–¹å¼æäº¤çš„            // é‚£ä¹ˆéœ€è¦è®¾ç½®è¯·æ±‚å¤´çš„ç±»å‹            xhr.setRequestHeader(&#39;Content-Type&#39;,&#39;application/x-www-form-urlencoded&#39;)            xhr.send(&#39;star=1&amp;des=ä¸œè¥¿å¾ˆå¥½,ä»·æ ¼å…¬é“,ä½†æ˜¯å·®è¯„,äººç”Ÿå°±æ˜¯è¿™ä¹ˆå¥‡å¦™&#39;)            xhr.onreadystatechange = function(){                if(xhr.readyState == 4){                    console.log(xhr.responseText)                }            }        }    &lt;/script&gt;</code></pre><blockquote><p><code>index.js</code></p></blockquote><pre><code class="js">var express = require(&#39;express&#39;)var bodyParser = require(&#39;body-parser&#39;)var web = express()web.use(express.static(&#39;public&#39;))web.use(bodyParser.urlencoded({extended:false}))web.get(&#39;/getTest&#39;,function(req,res){    var name = req.query.name    var des = req.query.des    setTimeout(function(){        res.send(&#39;å¬è¯´æœ‰ä¸€ç§&#39; + des + &quot;éå¸¸å‰å®³,å«åš&quot; + name)    },2000)})web.post(&#39;/postTest&#39;,function(req,res){    var star = req.body.star    var des = req.body.des    setTimeout(function(){        res.send(&#39;å•†å“è¯„ä»·æˆåŠŸ&#39;)    },2000)})web.listen(&#39;8080&#39;,function(){    console.log(&#39;æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ...&#39;)})</code></pre><h3 id="formè¡¨å•"><a href="#formè¡¨å•" class="headerlink" title="formè¡¨å•"></a>formè¡¨å•</h3><blockquote><p><code>public/index.html</code>,<a href="https://github.com/zysxm/Learning.github.io/tree/master/Python/8.30/form" target="_blank" rel="noopener" title="ç‚¹å‡»æŸ¥çœ‹">å‚è€ƒæºç </a></p></blockquote><pre><code class="html">&lt;button onclick=&quot;form1()&quot;&gt;xhrä¹‹formè¯·æ±‚&lt;/button&gt;    &lt;script&gt;        function form1() {            var xhr = new XMLHttpRequest()            // åˆå§‹åŒ–ä¸€ä¸ªformå¯¹è±¡            var form = new FormData()            form.append(&#39;name&#39;, &#39;å°é’å¹´&#39;)            form.append(&#39;age&#39;, &#39;17&#39;)            form.append(&#39;fond&#39;, &#39;ç©&#39;)            xhr.open(&#39;post&#39;, &#39;/test&#39;)            xhr.send(form)            xhr.onreadystatechange = function () {                if (xhr.readyState == 4) {                    console.log(xhr.responseText)                }            }        }    &lt;/script&gt;</code></pre><blockquote><p><code>index.js</code></p></blockquote><pre><code class="js">var express = require(&#39;express&#39;)var bodyParser = require(&#39;body-parser&#39;)var multer = require(&#39;multer&#39;)var web = express()var form = multer()web.use(express.static(&#39;public&#39;))web.use(bodyParser.urlencoded({extended:false}))// å¦‚æœä½¿ç”¨çš„æ—¶FormDataè¿™ç§æ•°æ®æäº¤æ–¹å¼çš„è¯// é‚£ä¹ˆéœ€è¦multeré‡Œé¢çš„array()æ–¹æ³•è¿›è¡Œæ•°æ®å‰¥ç¦»web.post(&#39;/test&#39;,form.array(),function(req,res){    name = req.body.name    age = req.body.age    fond = req.body.fond    res.send(&#39;å§“åæ˜¯&#39;+name + &quot;,å¹´é¾„æ˜¯&quot; + age + &#39;,çˆ±å¥½æ˜¯&#39;+fond)})</code></pre><h3 id="fs"><a href="#fs" class="headerlink" title="fs"></a>fs</h3><blockquote><p><code>index.js</code> æºç å‚è€ƒ(<a href="https://github.com/zysxm/Learning.github.io/tree/master/Python/8.30/fs" target="_blank" rel="noopener">https://github.com/zysxm/Learning.github.io/tree/master/Python/8.30/fs</a> â€œç‚¹å‡»æŸ¥çœ‹â€)</p></blockquote><pre><code class="js">// å¼•å…¥æ–‡ä»¶è¯»å†™æ¨¡å— ç³»ç»Ÿé»˜è®¤åŒ…å«fsæ¨¡å— æ‰€ä»¥æ— éœ€ä¸‹è½½var fs = require(&#39;fs&#39;)var gameRoleInfo = {    name: &#39;èŠ½è¡£&#39;,    level: &#39;20&#39;,    equipment: [&#39;æ‘æ­£&#39;, &#39;åœ£ç—•&#39;, &#39;å¤§ç åˆ€&#39;, &#39;é«˜å°„ç‚®&#39;, &#39;èè‰è£…&#39;, &#39;äº”é€Ÿé‹&#39;],    blood: &#39;3500&#39;}// å°†å­—å…¸å¯¹è±¡è½¬åŒ–æˆå­—ç¬¦ä¸²å¯¹è±¡var gameRoleInfoString = JSON.stringify(gameRoleInfo)// writeFileåé¢è·Ÿä¸‰ä¸ªå€¼// 1.å†™å…¥æ–‡ä»¶çš„è·¯å¾„// 2.å†™å…¥çš„å†…å®¹// 3.å†™å…¥ä»¥åçš„å›è°ƒå‡½æ•°fs.writeFile(&#39;data/game.txt&#39;,gameRoleInfoString,function(err){    if(err){        console.log(&#39;æ–‡ä»¶å†™å…¥å¤±è´¥:&#39;,err)    }    else{        console.log(&#39;æ–‡ä»¶å†™å…¥æˆåŠŸ&#39;)    }})// readFileé‡Œé¢ä¸¤ä¸ªå‚æ•°// å‚æ•°1.è¯»å–çš„æ–‡ä»¶è·¯å¾„// å‚æ•°2.è¯»å–æ–‡ä»¶ä»¥åçš„å›è°ƒå‡½æ•°// å›è°ƒå‡½æ•°é‡Œé¢æœ‰ä¸¤ä¸ªå‚æ•°// å‚æ•°1.è¯»å–å¤±è´¥ä»¥åçš„ä¿¡æ¯// å‚æ•°2.è¯»å–æˆåŠŸä»¥åçš„ä¿¡æ¯fs.readFile(&#39;data/game.txt&#39;,function(err,data){    if(err){        console.log(&#39;è¯»å–å¤±è´¥&#39;,err)    }    else{        // JSON.parse å°†å­—å…¸æ ¼å¼çš„å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå­—å…¸å¯¹è±¡        // console.log(&#39;è¯»å–æˆåŠŸ:&#39;+JSON.parse(data))        console.log(&#39;è¯»å–æˆåŠŸ:&#39;)        console.log(JSON.parse(data))    }})</code></pre><h3 id="å°é¡¹ç›®ç»ƒä¹ "><a href="#å°é¡¹ç›®ç»ƒä¹ " class="headerlink" title="å°é¡¹ç›®ç»ƒä¹ "></a>å°é¡¹ç›®ç»ƒä¹ </h3><blockquote><p>å°é¡¹ç›®ç»ƒä¹ ,<a href="https://github.com/zysxm/Learning.github.io/tree/master/Python/8.30/%E5%91%98%E5%B7%A5%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/info" target="_blank" rel="noopener" title="ç‚¹å‡»æŸ¥çœ‹">å‘˜å·¥ä¿¡æ¯ç®¡ç†</a>,<a href="https://github.com/zysxm/Learning.github.io/tree/master/Python/9.03/messagebox" target="_blank" rel="noopener" title="ç‚¹å‡»æŸ¥çœ‹">ç•™è¨€æ¿</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>node.js</tag>
      
      <tag>html</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>node.jsä½¿ç”¨</title>
    <link href="undefined2018/08/29/2018-08-29-node.js%E4%BD%BF%E7%94%A8/"/>
    <url>2018/08/29/2018-08-29-node.js%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>ç®€å•çš„è¯´ Node.js å°±æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ JavaScriptã€‚</p><p>Node.js æ˜¯ä¸€ä¸ªåŸºäºChrome JavaScript è¿è¡Œæ—¶å»ºç«‹çš„ä¸€ä¸ªå¹³å°ã€‚</p><p>Node.jsæ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨I/OæœåŠ¡ç«¯JavaScriptç¯å¢ƒï¼ŒåŸºäºGoogleçš„V8å¼•æ“ï¼ŒV8å¼•æ“æ‰§è¡ŒJavascriptçš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ€§èƒ½éå¸¸å¥½ã€‚</p><a id="more"></a><p>1.<a href="https://nodejs.org/dist/v4.4.3/node-v4.4.3-x64.msi" target="_blank" rel="noopener" title="node.js">node.js</a>,æŒ‰ç…§æç¤º<code>next</code>,å®‰è£…ååœ¨ç»ˆç«¯ä¸­é”®å…¥ <code>node -v</code> æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ</p><blockquote><p><img src="/img/Pictures/node/1.png" srcset="/img/loading.gif" alt="ç¤ºä¾‹å›¾" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾"></p></blockquote><p>2.å®‰è£…åæ³¨é”€/é‡å¯,ä½¿npmåŒ…ç®¡ç†å·¥å…·ç”Ÿæ•ˆ</p><p>3.åˆ›å»ºé¡¹ç›®<code>nodebasic</code>(åç§°éšæ„)</p><p>4.å³é”®é¡¹ç›®åœ¨ç»ˆç«¯ä¸­æ‰“å¼€</p><blockquote><p><img src="/img/Pictures/node/2.png" srcset="/img/loading.gif" alt="ç¤ºä¾‹å›¾" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾"></p></blockquote><p>5.é”®å…¥å‘½ä»¤ <code>npm init</code>  â€”â€”-åˆå§‹åŒ–é¡¹ç›®</p><blockquote><p>a.æ ¹æ®æç¤ºè¾“å…¥å†…å®¹,é…ç½®ä¿¡æ¯å¯å…¨éƒ¨å›è½¦<br>b.æˆåŠŸåè‡ªåŠ¨åˆ›å»ºpackage.jsonæ–‡ä»¶</p></blockquote><p>6.åœ¨é¡¹ç›®ä¸‹åˆ›å»ºé™æ€æ–‡ä»¶å¤¹<code>public</code></p><blockquote><p><code>public</code>æ–‡ä»¶å¤¹ä¸‹åˆ›å»º<code>html</code>æ–‡ä»¶<code>index.html</code>(åç§°å›ºå®š),å†…å®¹å¦‚ä¸‹:</p></blockquote><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;    &lt;title&gt;node.jsç¬¬ä¸€ä¸ªé¡¹ç›®&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;!-- action æäº¤åˆ°çš„æ¥å£ --&gt;    &lt;form action=&quot;/book&quot;&gt;        &lt;input type=&quot;submit&quot; value=&quot;æäº¤ä¹¦ç±ä¿¡æ¯&quot;&gt;    &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>7.å†æ¬¡å³é”®é¡¹ç›®åœ¨ç»ˆç«¯ä¸­æ‰“å¼€</p><blockquote><p>a.é”®å…¥å¦‚ä¸‹å‘½ä»¤</p><pre><code>  npm install express ----å®‰è£…Node.js webæ¡†æ¶æ¨¡å—expressä»¥åŠæ‰€æœ‰ä¾èµ–é¡¹</code></pre><p>b.å¦‚æœæç¤ºç½‘ç»œé”™è¯¯,æ›´æ”¹é•œåƒæºåœ°å€</p><pre><code>  npm config set registry http://registry.cnpmjs.org</code></pre></blockquote><p>8.é¡¹ç›®ä¸‹åˆ›å»ºindex.js,é‡Œé¢ä¸ºæœåŠ¡ç«¯ä»£ç ,å†…å®¹å¦‚ä¸‹:</p><blockquote><pre><code class="javascript">// å¼•å…¥expressæ¨¡å—  expressæ¨¡å—ä¸ºæ•°æ®è¯·æ±‚åŸºç¡€æ¨¡å—// å¦‚æœå‘ç”Ÿæ•°æ®è¯·æ±‚ é‚£ä¹ˆä¸€å®šéœ€è¦ä½¿ç”¨è¿™ä¸ªæ¨¡å—var express = require(&#39;express&#39;)// åˆ›å»ºæ¨¡å—çš„ä¸€ä¸ªå®ä¾‹åŒ–å¯¹è±¡var web = express()// static é™æ€ è®©webå¯¹è±¡ä½¿ç”¨å·¥ç¨‹ä¸­çš„é™æ€èµ„æº publicæ–‡ä»¶å¤¹web.use(express.static(&#39;public&#39;))// get è¡¨ç¤ºä½¿ç”¨getæ–¹æ³• æ–¹æ³•åé¢è¿½åŠ ä¸¤ä¸ªå‚æ•° // å‚æ•°1: è¯·æ±‚çš„æ¥å£// å‚æ•°2: å›è°ƒå‡½æ•° //     å›è°ƒå‡½æ•°é‡Œé¢æœ‰ä¸¤ä¸ªå‚æ•°//     å‚æ•°1: å‰ç«¯ä»åç«¯ä¼ çš„å€¼//     å‚æ•°2: åç«¯å¾€å‰ç«¯ä¼ çš„å€¼web.get(&#39;/book&#39;,function(req , res){    res.send(&#39;å¤ä»Šå¥‡ä¹¦&lt;&lt;èŠæ–‹å¿—å¼‚&gt;&gt;&#39;)})// è®©ç¨‹åºç›‘å¬nodeç«¯å£web.listen(&#39;8080&#39;,function(){    console.log(&#39;æœåŠ¡å™¨å¯åŠ¨......&#39;)})</code></pre></blockquote><p>9.æ­¤æ—¶ç›®å½•ç»“æ„å¦‚ä¸‹</p><blockquote><p><img src="/img/Pictures/node/3.png" srcset="/img/loading.gif" alt="img" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾"></p></blockquote><p>10.å¯åŠ¨æœåŠ¡ç«¯å¹¶è®¿é—®</p><blockquote><p>a.node index.js<br>b.åœ°å€æ :localhost:ç«¯å£å·(index.jsä¸­å®šä¹‰)<br>c.æ³¨æ„ : ä¿®æ”¹æœåŠ¡ç«¯ä»£ç å éœ€é‡å¯æœåŠ¡å™¨,åŒä¸€ä¸ªæœåŠ¡å™¨ç¨‹åº,ä¸èƒ½åœ¨å¤šç»ˆç«¯ä¸­å¯åŠ¨</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>node.js</tag>
      
      <tag>html</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>scrapy_redisè®¾ç½®åŠåˆ†å¸ƒå¼çˆ¬è™«æ¡ˆä¾‹åˆ†æ</title>
    <link href="undefined2018/08/16/2018-08-16-scrapy_redis%E8%AE%BE%E7%BD%AE%E5%8F%8A%E5%88%86%E5%B8%83%E5%BC%8F%E7%88%AC%E8%99%AB%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90/"/>
    <url>2018/08/16/2018-08-16-scrapy_redis%E8%AE%BE%E7%BD%AE%E5%8F%8A%E5%88%86%E5%B8%83%E5%BC%8F%E7%88%AC%E8%99%AB%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>ç›®å½•:</p><p><a href="#æºç ">æºç </a></p><p><a href="#å®‰è£…">å®‰è£…</a></p><p><a href="#settings">settings</a></p><p><a href="#examples">examples</a></p><p><a href="#ä¿®æ”¹æ™®é€šçˆ¬è™«é¡¹ç›®ä¸ºåˆ†å¸ƒå¼çˆ¬è™«">ä¿®æ”¹scrapyæ™®é€šçˆ¬è™«é¡¹ç›®ä¸ºåˆ†å¸ƒå¼çˆ¬è™«</a></p><a id="more"></a><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><blockquote><h4 id="scrapy-redisä¸¤ç§è·å–æ–¹å¼"><a href="#scrapy-redisä¸¤ç§è·å–æ–¹å¼" class="headerlink" title="scrapy_redisä¸¤ç§è·å–æ–¹å¼"></a><a href="https://github.com/scrapy/scrapy" target="_blank" rel="noopener" title="è¿›å…¥è¯¦æƒ…é¡µ">scrapy_redis</a>ä¸¤ç§è·å–æ–¹å¼</h4><blockquote><ul><li>å®‰è£…gitå®¢æˆ·ç«¯,å…‹éš†<code>scrapy_redis</code>ä»“åº“åˆ°æœ¬åœ°:</li></ul><pre><code class="bash">$ git clone &quot;https://github.com/scrapy/scrapy.git&quot;</code></pre><ul><li>ç›´æ¥ä¸‹è½½é¡¹ç›®å‹ç¼©åŒ…,è§£å‹åˆ°æœ¬åœ°</li></ul></blockquote><p>ä½¿ç”¨<code>Pycharm</code>æ‰“å¼€é¡¹ç›®</p></blockquote><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><blockquote><h4 id="åœ¨çº¿å®‰è£…scrapy-redisæ¨¡å—"><a href="#åœ¨çº¿å®‰è£…scrapy-redisæ¨¡å—" class="headerlink" title="åœ¨çº¿å®‰è£…scrapy_redisæ¨¡å—"></a>åœ¨çº¿å®‰è£…<code>scrapy_redis</code>æ¨¡å—</h4><pre><code class="cmd">\&gt; pip install scrapy_redis</code></pre></blockquote><h3 id="settings"><a href="#settings" class="headerlink" title="settings"></a>settings</h3><pre><code class="python">SPIDER_MODULES = [&#39;example.spiders&#39;]NEWSPIDER_MODULE = &#39;example.spiders&#39;# ä½¿ç”¨scrapy_redisçš„å»é‡ç±»  ä¸ä½¿ç”¨scrapyé»˜è®¤çš„å»é‡ç±»DUPEFILTER_CLASS = &quot;scrapy_redis.dupefilter.RFPDupeFilter&quot;# ä½¿ç”¨srcpy_redisçš„è°ƒåº¦å™¨  ä¸ä½¿ç”¨scrapyé»˜è®¤çš„è°ƒåº¦å™¨SCHEDULER = &quot;scrapy_redis.scheduler.Scheduler&quot;# æ§åˆ¶çˆ¬è™«æ˜¯å¦å…è®¸æš‚åœSCHEDULER_PERSIST = True# é˜Ÿåˆ—å½¢å¼ å…ˆè¿›å…ˆå‡º å…ˆæ”¾å…¥é˜Ÿåˆ—çš„è¯·æ±‚å…ˆæ‰§è¡Œ#SCHEDULER_QUEUE_CLASS = &quot;scrapy_redis.queue.SpiderPriorityQueue&quot;# æ ˆå½¢å¼  å…ˆè¿›åå‡º#SCHEDULER_QUEUE_CLASS = &quot;scrapy_redis.queue.SpiderQueue&quot;#SCHEDULER_QUEUE_CLASS = &quot;scrapy_redis.queue.SpiderStack&quot;ITEM_PIPELINES = {    &#39;example.pipelines.ExamplePipeline&#39;: 300,    # ä½¿ç”¨redisæ•°æ®åº“æ‰€è¦æ·»åŠ çš„ç®¡é“,å¿…é¡»    &#39;scrapy_redis.pipelines.RedisPipeline&#39;: 400,}# log æ—¥å¿— level ç­‰çº§# LOG_LEVEL = &#39;DEBUG&#39;# Introduce an artifical delay to make use of parallelism. to speed up the# crawl.# é™åˆ¶çˆ¬è™«é€Ÿåº¦# DOWNLOAD_DELAY = 1# åŸŸåä¸ºå­—ç¬¦ä¸² å¦‚æœä¸å†™ é»˜è®¤ä¸ºæœ¬æœºæ•°æ®åº“çš„ipREDIS_HOST = &#39;127.0.0.1&#39;# ç«¯å£ä¸ºæ•°å­—REIDS_PORT = 6379</code></pre><h3 id="examples"><a href="#examples" class="headerlink" title="examples"></a>examples</h3><pre><code class="python">from scrapy.spiders import Rulefrom scrapy.linkextractors import LinkExtractorfrom scrapy_redis.spiders import RedisCrawlSpiderfrom ..items import ExampleItemclass MyCrawler(RedisCrawlSpider):    &quot;&quot;&quot;Spider that reads urls from redis queue (myspider:start_urls).&quot;&quot;&quot;    name = &#39;mycrawler_redis&#39;    # æ¨èå†™æ³• ç±»å: + start_urls    redis_key = &#39;mycrawler:start_urls&#39;    rules = (        # follow all links        Rule(LinkExtractor(), callback=&#39;parse_page&#39;, follow=True),        # Rule(LinkExtractor(),callback=&#39;fun&#39;)    )    # åˆå§‹åŒ–æ–¹æ³•    def __init__(self, *args, **kwargs):        # åŠ¨æ€åœ°å®šä¹‰å…è®¸çš„åŸŸååˆ—è¡¨        # Dynamically define the allowed domains list.        domain = kwargs.pop(&#39;domain&#39;, &#39;&#39;)        self.allowed_domains = filter(None, domain.split(&#39;,&#39;))        # å›ºå®šå†™æ³•,ç»§æ‰¿è‡ªå½“å‰æ–¹æ³•çš„ç±»å        super(MyCrawler, self).__init__(*args, **kwargs)    def parse_page(self, response):        # return {        #     &#39;name&#39;: response.css(&#39;title::text&#39;).extract_first(),        #     &#39;url&#39;: response.url,        # }        item = ExampleItem()        item[&#39;link&#39;] = response.url        yield item</code></pre><h3 id="ä¿®æ”¹æ™®é€šçˆ¬è™«é¡¹ç›®ä¸ºåˆ†å¸ƒå¼çˆ¬è™«"><a href="#ä¿®æ”¹æ™®é€šçˆ¬è™«é¡¹ç›®ä¸ºåˆ†å¸ƒå¼çˆ¬è™«" class="headerlink" title="ä¿®æ”¹æ™®é€šçˆ¬è™«é¡¹ç›®ä¸ºåˆ†å¸ƒå¼çˆ¬è™«"></a>ä¿®æ”¹æ™®é€šçˆ¬è™«é¡¹ç›®ä¸ºåˆ†å¸ƒå¼çˆ¬è™«</h3><blockquote><p>1.ä¸»çˆ¬è™«æ–‡ä»¶<code>myspider.py</code>åšå¦‚ä¸‹ä¿®æ”¹,å…¶ä»–ä¸åšä¿®æ”¹:</p></blockquote><pre><code class="python">import scrapyfrom ..items import MyItem # å¯¼å…¥æ•°æ®æ¨¡å‹from scrapy_redis.spiders import RedisSpider #å¯¼å…¥scrapy_redisæ¨¡å—# 1.ä¿®æ”¹scrapy.spiderä¸ºRedisSpiderclass MySpider(RedisSpider):    # 2.æ³¨é‡Šstart_urls,æ·»åŠ redis_key    redis_key = &#39;myspider:start_urls&#39;    ...</code></pre><blockquote><p>2.<code>settings</code>æ·»åŠ å¦‚ä¸‹ä»£ç :</p></blockquote><pre><code class="python"># 1.å¿…é¡». ä½¿ç”¨scrapy_redisçš„å»é‡ç»„ä»¶,åœ¨redisæ•°æ®åº“é‡Œåšå»é‡DUPEFILTER_CLASS = &quot;scrapy_redis.dupefilter.RFPDupeFilter&quot;# 2.å¿…é¡». ä½¿ç”¨scrapy_redisçš„è°ƒåº¦å™¨,åœ¨redisé‡Œåˆ†é…è¯·æ±‚SCHEDULER = &quot;scrapy_redis.scheduler.Scheduler&quot;# 3.å¯é€‰. åœ¨redisä¸­ä¿æŒscrapy-redisç”¨åˆ°çš„å„ä¸ªé˜Ÿåˆ—,ä»è€Œå…è®¸æš‚åœå’Œæš‚åœåæ¢å¤,ä¹Ÿå°±æ˜¯ä¸æ¸…ç†redis queuesSCHEDULER_PERSIST = True# redisæœåŠ¡å™¨åœ°å€REDIS_HOST = &quot;127.0.0.1&quot;# redisæœåŠ¡å™¨ç«¯å£REDIS_PORT = 6379# ç®¡é“å­˜å‚¨,å°†æ•°æ®å­˜å‚¨åˆ°redisé‡ŒITEM_PIPELINES = {    &#39;scrapy_redis.pipelines.RedisPipeline&#39;:100}</code></pre><blockquote><p>3.åˆ†å‘ä»£ç ,é€‰æ‹©ä¸€å°æœºå™¨ä½œä¸ºæœåŠ¡å™¨,åˆ‡æ¢åˆ°<code>redis</code>å®‰è£…ç›®å½•,ä¿®æ”¹é…ç½®æ–‡ä»¶<a href="https://zyboy.top/2018/08/14/2018-08-13-redis%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D/" title="æŸ¥çœ‹è¯¦æƒ…">å‚è§</a>,å¦‚ä¸‹å‘½ä»¤å¼€å¯<code>redis</code>æ•°æ®åº“æœåŠ¡å™¨</p></blockquote><pre><code class="cmd">\&gt; redis-server redis.windows.conf</code></pre><blockquote><p>4.å®¢æˆ·ç«¯ä¿®æ”¹<code>settings.py</code>æ–‡ä»¶,å°†<code>REDIS_HOST</code>çš„å€¼æ”¹ä¸º<code>redis</code>æœåŠ¡ç«¯çš„IPåœ°å€,åœ¨æœåŠ¡ç«¯æ‰“å¼€å‘½ä»¤è¡Œç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹IPåœ°å€:</p></blockquote><pre><code class="cmd">\&gt; ipconfig</code></pre><p>æˆ–è€…åœ¨<code>settings.py</code>æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç æŒ‡å®šæœåŠ¡å™¨:</p><pre><code class="python"># 192.168.52.215 ä¸ºæœåŠ¡å™¨IPåœ°å€, 6397 ä¸ºç«¯å£å·REDIS_URL=&#39;redis://root:@192.168.52.215:6379&#39; </code></pre><p>å¦‚æœä¸åœ¨<code>settings</code>æ–‡ä»¶ä¸­æŒ‡å®šæœåŠ¡å™¨ip,å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥åœ¨<code>redis</code>é…ç½®æ–‡ä»¶ä¸­ç»‘å®šæœåŠ¡å™¨IPåœ°å€:</p><pre><code class="cmd">bind 192.168.52.215  ----ç»‘å®šæœåŠ¡å™¨IP</code></pre><blockquote><p>5.è¿è¡Œå®¢æˆ·ç«¯çˆ¬è™«ç¨‹åº,æ§åˆ¶å°å¯çœ‹åˆ°ç¨‹åºå¤„äºç­‰å¾…çŠ¶æ€ä¸­(æœåŠ¡å™¨ç«¯ä¹Ÿå¯ä»¥å¼€å¯çˆ¬è™«ç¨‹åº,åŒæ ·å¤„äºç­‰å¾…çŠ¶æ€),æ­¤æ—¶åœ¨æœåŠ¡å™¨ç«¯å†æ¬¡æ‰“å¼€ä¸€ä¸ªç»ˆç«¯,è¿æ¥<code>redis</code>æ•°æ®åº“å¹¶å‘å…¶ä¸­æ·»åŠ åˆå§‹<code>url</code>:</p></blockquote><pre><code class="cmd">\&gt; redis-cli127.0.0.1:6379&gt; lpush myspider:start_urls http://www.......</code></pre><p>æ­¤æ—¶å†æ¬¡è§‚å¯ŸæœåŠ¡å™¨ç»ˆç«¯,å„ä¸ªçˆ¬è™«ç¨‹åºç»ˆç«¯,å¯è§‚å¯Ÿåˆ°ç¨‹åºæ­£åœ¨çˆ¬å–é¡µé¢</p><blockquote><p>6.çˆ¬å–åˆ°äº†é¡µé¢,é‚£ä¹ˆå°±è¦è¿›è¡Œè¯»å–æŸ¥çœ‹,å¯ä½¿ç”¨<code>Redis Desktop Manager</code>å¯è§†åŒ–å·¥å…·è¿æ¥æ•°æ®åº“,so easy!</p></blockquote><!-- <meta http-equiv="refresh" content="2"> -->]]></content>
    
    
    
    <tags>
      
      <tag>scrapy</tag>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>redisæ•°æ®åº“ç®€å•ä»‹ç»</title>
    <link href="undefined2018/08/14/2018-08-13-redis%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D/"/>
    <url>2018/08/14/2018-08-13-redis%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D/</url>
    
    <content type="html"><![CDATA[<blockquote><p>Redis æ˜¯å®Œå…¨å¼€æºå…è´¹çš„ï¼Œéµå®ˆBSDåè®®ï¼Œæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„key-valueæ•°æ®åº“ã€‚</p></blockquote><a id="more"></a><blockquote><p>Redis ä¸å…¶ä»– key - value ç¼“å­˜äº§å“æœ‰ä»¥ä¸‹ä¸‰ä¸ªç‰¹ç‚¹ï¼š</p><ul><li>Redisæ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ã€‚</li><li>Redisä¸ä»…ä»…æ”¯æŒç®€å•çš„key-valueç±»å‹çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜æä¾›listï¼Œsetï¼Œzsetï¼Œhashç­‰æ•°æ®ç»“æ„çš„å­˜å‚¨ã€‚</li><li>Redisæ”¯æŒæ•°æ®çš„å¤‡ä»½ï¼Œå³master-slaveæ¨¡å¼çš„æ•°æ®å¤‡ä»½ã€‚</li></ul></blockquote><blockquote><p><code>redis</code>æ•°æ®åº“ä¸‹è½½å®‰è£…</p></blockquote><ol><li>ä¸‹è½½åœ°å€: <a href="https://github.com/MSOpenTech/redis/releases" target="_blank" rel="noopener" title="ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ">redis</a></li><li>è§£å‹å®‰è£…åŒ…</li><li>å°†è§£å‹å‡ºæ¥çš„æ–‡ä»¶å¤¹æ”¹åä¸º<code>redis</code></li><li>ä¿®æ”¹æˆ–æ·»åŠ <code>redis</code>æ•°æ®åº“çš„å¯åŠ¨é…ç½®æ–‡ä»¶<code>redis.windows.conf</code>å¦‚ä¸‹å†…å®¹:<pre><code class="cmd">\&gt; # bind 127.0.0.1  ------å…³é—­ç»‘å®šæœ¬åœ°ç¯å›åœ°å€\&gt; protected-mode no ------å…³é—­ä¿æŠ¤æ¨¡å—\&gt; daemonize yes     ------æ‰“å¼€å®ˆæŠ¤è¿›ç¨‹\&gt; Ctrl + s ------ä¿å­˜</code></pre></li><li><code>cd</code>åˆ°<code>redis</code>ç›®å½•æ‰§è¡Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¼€å¯æœ¬åœ°æœåŠ¡å™¨ç›‘å¬(æ³¨æ„:å¯ç”¨æœ¬åœ°é…ç½®æ–‡ä»¶å¯åŠ¨<code>redis</code>æœåŠ¡ç«¯):<pre><code class="cmd">\&gt; redis-server redis.windows.conf</code></pre></li><li>æ‰“å¼€å¦ä¸€ä¸ª<code>cmd</code>ç»ˆç«¯<code>cd</code>åˆ°<code>redis</code>ç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿æ¥<code>redis</code>æ•°æ®åº“å¹¶å†™å…¥æ•°æ®å’Œå–æ•°æ®<pre><code class="cmd">\&gt; redis-cli -h 127.0.0.1\&gt; set task1 spider_baidu\&gt; set task2 spider_taobao\&gt; get task1`\&gt; get task2`</code></pre></li><li>é…ç½®ç¯å¢ƒå˜é‡</li><li>å±€åŸŸç½‘ä¸‹è¿æ¥serveræœåŠ¡å™¨,éœ€æŒ‡å®šæœ¬åœ°å±€åŸŸç½‘ä¸‹serveræœåŠ¡å™¨ipåœ°å€<pre><code class="cmd">\&gt; redis-cli -h æœåŠ¡å™¨ip</code></pre></li><li>è¿™æ—¶å°±èƒ½è®¿é—®<code>redis</code>æœåŠ¡å™¨è¯»å†™æ•°æ®äº†</li></ol><!-- <meta http-equiv="refresh" content="1"> -->]]></content>
    
    
    
    <tags>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>phantomjsä½¿ç”¨</title>
    <link href="undefined2018/08/11/2018-08-11-phantomjs%E4%BD%BF%E7%94%A8/"/>
    <url>2018/08/11/2018-08-11-phantomjs%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<pre><code class="python">from selenium import webdriver# ä½¿ç”¨webkitæ— ç•Œé¢æµè§ˆå™¨# å¦‚æœè·¯å¾„ä¸ºexeå¯åŠ¨ç¨‹åºçš„è·¯å¾„ é‚£ä¹ˆè¯¥è·¯å¾„éœ€è¦åŠ ä¸€ä¸ªrdriver = webdriver.PhantomJS(executable_path=r&#39;D:/phantomjs-2.1.1-windows/bin/phantomjs.exe&#39;)# è·å–æŒ‡å®šç½‘é¡µçš„æ•°æ®driver.get(&#39;http://news.sohu.com/scroll/&#39;)print(driver.find_element_by_class_name(&#39;title&#39;).text)</code></pre><a id="more"></a><h3 id="ä»¥çˆ¬å–æ·˜å®æœç´¢ç•Œé¢ä¿¡æ¯ä¸ºä¾‹è¯´æ˜"><a href="#ä»¥çˆ¬å–æ·˜å®æœç´¢ç•Œé¢ä¿¡æ¯ä¸ºä¾‹è¯´æ˜" class="headerlink" title="ä»¥çˆ¬å–æ·˜å®æœç´¢ç•Œé¢ä¿¡æ¯ä¸ºä¾‹è¯´æ˜:"></a>ä»¥çˆ¬å–æ·˜å®æœç´¢ç•Œé¢ä¿¡æ¯ä¸ºä¾‹è¯´æ˜:</h3><blockquote><p><code>taobao.py</code></p></blockquote><pre><code class="python"># -*- coding: utf-8 -*-import scrapyfrom selenium import webdriverfrom ..items import TaobaospiderItemclass TaobaoSpider(scrapy.Spider):    name = &#39;taobao&#39;    allowed_domains = [&#39;taobao.com&#39;]    start_urls = [&#39;https://s.taobao.com/search?q=%E7%AC%94%E8%AE%B0%E6%9C%AC%E7%94%B5%E8%84%91&amp;imgfile=&amp;js=1&amp;stats_click=search_radio_all%3A1&amp;initiative_id=staobaoz_20180809&amp;ie=utf8&#39;]    def __init__(self):        self.driver = webdriver.PhantomJS()    def parse(self, response):        print(&#39;================================&#39;)        print(response)        div_info = response.xpath(&#39;//div[@class=&quot;info-cont&quot;]&#39;)        print(&#39;======&#39;)        print(div_info)        for div in div_info:            title = div.xpath(&#39;.//div[@class=&quot;title-row &quot;]/a/text()&#39;).extract_first(&#39;&#39;)            price = div.xpath(&#39;.//div[@class=&quot;sale-row row&quot;]/div/span[2]/strong/text()&#39;).extract_first(&#39;&#39;)            print(&#39;---------------------------------&#39;)            print(title)            print(price)            item = TaobaospiderItem()            item[&#39;title&#39;] = title            item[&#39;price&#39;] = price            yield item    def closed(self, reason):        print(u&#39;çˆ¬è™«å…³é—­äº†, åŸå› ï¼š&#39;,reason)        self.driver.quit()</code></pre><blockquote><p><code>items.py</code></p></blockquote><pre><code class="python"># -*- coding: utf-8 -*-# Define here the models for your scraped items## See documentation in:# https://doc.scrapy.org/en/latest/topics/items.htmlimport scrapyclass TaobaospiderItem(scrapy.Item):    # define the fields for your item here like:    # name = scrapy.Field()    title = scrapy.Field()    price = scrapy.Field()</code></pre><blockquote><p><code>middlewares.py</code></p></blockquote><pre><code class="python"># -*- coding: utf-8 -*-# Define here the models for your spider middleware## See documentation in:# https://doc.scrapy.org/en/latest/topics/spider-middleware.htmlfrom scrapy import signalsfrom selenium import webdriverfrom scrapy.http.response.html import HtmlResponsefrom scrapy.http.response import Responseclass SeleniumSpiderMiddleware(object):    def process_request(self,request,spider):        # å½“å¼•æ“ä»è°ƒåº¦å™¨å–å‡ºrequestè¿›è¡Œè¯·æ±‚å‘é€ä¸‹è½½å™¨ä¹‹å‰        # ä¼šå…ˆæ‰§è¡Œå½“å‰çš„çˆ¬è™«ä¸­é—´ä»¶,åœ¨ä¸­é—´ä»¶é‡Œé¢ä½¿ç”¨selenium        # è¯·æ±‚è¿™ä¸ªrequest,æ‹¿åˆ°åŠ¨æ€ç½‘ç«™çš„æ•°æ®,ç„¶åå°†è¯·æ±‚è¿”å›ç»™        # spiderçˆ¬è™«å¯¹è±¡        print(&#39;++++++++++++++++++++++++++++++&#39;)        if spider.name == &#39;taobao&#39;:            # ä½¿ç”¨çˆ¬è™«æ–‡ä»¶çš„åœ°å€            spider.driver.get(request.url)            for x in range(1,12,2):                i = float(x) / 11                js = &#39;document.body.scrollTop=document.body.scrollHeight * %f&#39; % i                spider.driver.execute_script(js)            # è®¾ç½®å“åº”ä¿¡æ¯,å“åº”çš„urlä¸ºè¯·æ±‚çš„url,å“åº”çš„ç½‘é¡µå†…å®¹ä¸ºè¯·æ±‚ç½‘é¡µçš„æºç             # å“åº”çš„ç¼–ç ä¸ºutf-8 è¯·æ±‚çš„ä¿¡æ¯ä¸ºè·å–çš„ä¿¡æ¯            response = HtmlResponse(url=request.url,body=spider.driver.page_source,encoding=&#39;utf-8&#39;,request=request)            # è¿™ä¸ªåœ°æ–¹åªèƒ½è¿”å›response            # å¦‚æœè¿”å›äº†responseå¯¹è±¡            # é‚£ä¹ˆå¯ä»¥ç›´æ¥è·³è¿‡ä¸‹è½½ä¸­é—´ä»¶            # å°†responseçš„å€¼ä¼ é€’ç»™å¼•æ“            # å¼•æ“æœ‰ä¼ é€’ç»™spiderè¿›è¡Œè§£æ            print(&#39;+++++++++++++--------------------&#39;)            return responseclass TaobaospiderSpiderMiddleware(object):    # Not all methods need to be defined. If a method is not defined,    # scrapy acts as if the spider middleware does not modify the    # passed objects.    @classmethod    def from_crawler(cls, crawler):        # This method is used by Scrapy to create your spiders.        s = cls()        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)        return s    def process_spider_input(self, response, spider):        # Called for each response that goes through the spider        # middleware and into the spider.        # Should return None or raise an exception.        return None    def process_spider_output(self, response, result, spider):        # Called with the results returned from the Spider, after        # it has processed the response.        # Must return an iterable of Request, dict or Item objects.        for i in result:            yield i    def process_spider_exception(self, response, exception, spider):        # Called when a spider or process_spider_input() method        # (from other spider middleware) raises an exception.        # Should return either None or an iterable of Response, dict        # or Item objects.        pass    def process_start_requests(self, start_requests, spider):        # Called with the start requests of the spider, and works        # similarly to the process_spider_output() method, except        # that it doesnâ€™t have a response associated.        # Must return only requests (not items).        for r in start_requests:            yield r    def spider_opened(self, spider):        spider.logger.info(&#39;Spider opened: %s&#39; % spider.name)class TaobaospiderDownloaderMiddleware(object):    # Not all methods need to be defined. If a method is not defined,    # scrapy acts as if the downloader middleware does not modify the    # passed objects.    @classmethod    def from_crawler(cls, crawler):        # This method is used by Scrapy to create your spiders.        s = cls()        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)        return s    def process_request(self, request, spider):        # Called for each request that goes through the downloader        # middleware.        # Must either:        # - return None: continue processing this request        # - or return a Response object        # - or return a Request object        # - or raise IgnoreRequest: process_exception() methods of        #   installed downloader middleware will be called        return None    def process_response(self, request, response, spider):        # Called with the response returned from the downloader.        # Must either;        # - return a Response object        # - return a Request object        # - or raise IgnoreRequest        return response    def process_exception(self, request, exception, spider):        # Called when a download handler or a process_request()        # (from other downloader middleware) raises an exception.        # Must either:        # - return None: continue processing this exception        # - return a Response object: stops process_exception() chain        # - return a Request object: stops process_exception() chain        pass    def spider_opened(self, spider):        spider.logger.info(&#39;Spider opened: %s&#39; % spider.name)</code></pre><blockquote><p><code>pipelines.py</code></p></blockquote><pre><code class="python"># -*- coding: utf-8 -*-# Define your item pipelines here## Don&#39;t forget to add your pipeline to the ITEM_PIPELINES setting# See: https://doc.scrapy.org/en/latest/topics/item-pipeline.htmlimport sqlite3class TaobaospiderPipeline(object):    def __init__(self):        self.con = sqlite3.connect(&#39;taobaoDB&#39;)        self.cursor = self.con.cursor()        self.cursor.execute(&#39;create table if not exists taobaoTable(title text,price text)&#39;)    def process_item(self, item, spider):        self.cursor.execute(&#39;insert into taobaoTable VALUES (&quot;{}&quot;,&quot;{}&quot;)&#39;.format(item[&#39;title&#39;],item[&#39;price&#39;]))        self.con.commit()        return item    def close_spider(self,spider):        self.cursor.close()        self.con.commit()</code></pre><blockquote><p><code>settings.py</code></p></blockquote><pre><code class="python"># -*- coding: utf-8 -*-# Scrapy settings for taobaospider project## For simplicity, this file contains only settings considered important or# commonly used. You can find more settings consulting the documentation:##     https://doc.scrapy.org/en/latest/topics/settings.html#     https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#     https://doc.scrapy.org/en/latest/topics/spider-middleware.htmlBOT_NAME = &#39;taobaospider&#39;SPIDER_MODULES = [&#39;taobaospider.spiders&#39;]NEWSPIDER_MODULE = &#39;taobaospider.spiders&#39;# Crawl responsibly by identifying yourself (and your website) on the user-agent#USER_AGENT = &#39;taobaospider (+http://www.yourdomain.com)&#39;# Obey robots.txt rules# ROBOTSTXT_OBEY = True# Configure maximum concurrent requests performed by Scrapy (default: 16)#CONCURRENT_REQUESTS = 32# Configure a delay for requests for the same website (default: 0)# See https://doc.scrapy.org/en/latest/topics/settings.html#download-delay# See also autothrottle settings and docs#DOWNLOAD_DELAY = 3# The download delay setting will honor only one of:#CONCURRENT_REQUESTS_PER_DOMAIN = 16#CONCURRENT_REQUESTS_PER_IP = 16# Disable cookies (enabled by default)#COOKIES_ENABLED = False# Disable Telnet Console (enabled by default)#TELNETCONSOLE_ENABLED = False# Override the default request headers:#DEFAULT_REQUEST_HEADERS = {#   &#39;Accept&#39;: &#39;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#39;,#   &#39;Accept-Language&#39;: &#39;en&#39;,#}# Enable or disable spider middlewares# See https://doc.scrapy.org/en/latest/topics/spider-middleware.html# SPIDER_MIDDLEWARES = {#    &#39;taobaospider.middlewares.TaobaospiderSpiderMiddleware&#39;: 543,# }# Enable or disable downloader middlewares# See https://doc.scrapy.org/en/latest/topics/downloader-middleware.htmlDOWNLOADER_MIDDLEWARES = {    &#39;taobaospider.middlewares.SeleniumSpiderMiddleware&#39;:1}# Enable or disable extensions# See https://doc.scrapy.org/en/latest/topics/extensions.html#EXTENSIONS = {#    &#39;scrapy.extensions.telnet.TelnetConsole&#39;: None,#}# Configure item pipelines# See https://doc.scrapy.org/en/latest/topics/item-pipeline.htmlITEM_PIPELINES = {   &#39;taobaospider.pipelines.TaobaospiderPipeline&#39;: 300,}# Enable and configure the AutoThrottle extension (disabled by default)# See https://doc.scrapy.org/en/latest/topics/autothrottle.html#AUTOTHROTTLE_ENABLED = True# The initial download delay#AUTOTHROTTLE_START_DELAY = 5# The maximum download delay to be set in case of high latencies#AUTOTHROTTLE_MAX_DELAY = 60# The average number of requests Scrapy should be sending in parallel to# each remote server#AUTOTHROTTLE_TARGET_CONCURRENCY = 1.0# Enable showing throttling stats for every response received:#AUTOTHROTTLE_DEBUG = False# Enable and configure HTTP caching (disabled by default)# See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings#HTTPCACHE_ENABLED = True#HTTPCACHE_EXPIRATION_SECS = 0#HTTPCACHE_DIR = &#39;httpcache&#39;#HTTPCACHE_IGNORE_HTTP_CODES = []#HTTPCACHE_STORAGE = &#39;scrapy.extensions.httpcache.FilesystemCacheStorage&#39;</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
      <tag>scrapy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>scrapyä¸­é—´ä»¶</title>
    <link href="undefined2018/08/11/2018-08-11-scrapy%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    <url>2018/08/11/2018-08-11-scrapy%E4%B8%AD%E9%97%B4%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h3 id="ä¸­é—´ä»¶å¤šç”¨äºè®¾ç½®è¯·æ±‚å¤´ä¿¡æ¯-è¯·æ±‚æ•°æ®ç­‰"><a href="#ä¸­é—´ä»¶å¤šç”¨äºè®¾ç½®è¯·æ±‚å¤´ä¿¡æ¯-è¯·æ±‚æ•°æ®ç­‰" class="headerlink" title="ä¸­é—´ä»¶å¤šç”¨äºè®¾ç½®è¯·æ±‚å¤´ä¿¡æ¯,è¯·æ±‚æ•°æ®ç­‰"></a>ä¸­é—´ä»¶å¤šç”¨äºè®¾ç½®è¯·æ±‚å¤´ä¿¡æ¯,è¯·æ±‚æ•°æ®ç­‰</h3><a id="more"></a><pre><code class="python"># -*- coding: utf-8 -*-# Define here the models for your spider middleware## See documentation in:# https://doc.scrapy.org/en/latest/topics/spider-middleware.htmlfrom scrapy import signalsfrom fake_useragent import UserAgent# çˆ¬è™«ä¸­é—´ä»¶ è®¾ç½®åœ¨è¯·æ±‚è¿‡ç¨‹ä¸­çš„ä¿¡æ¯class BaiduspiderSpiderMiddleware(object):    # Not all methods need to be defined. If a method is not defined,    # scrapy acts as if the spider middleware does not modify the    # passed objects.    @classmethod    # åˆ›å»ºçˆ¬è™«æ—¶è°ƒç”¨    def from_crawler(cls, crawler):        print(&#39;çˆ¬è™«åˆ›å»º&#39;)        # This method is used by Scrapy to create your spiders.        s = cls()        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)        return s    # å¤„ç†ä¸‹è½½å™¨è¿”å›çš„responseå¯¹è±¡    def process_spider_input(self, response, spider):        print(&#39;inå‡½æ•°è¢«æ‰§è¡Œ&#39;)        # Called for each response that goes through the spider        # middleware and into the spider.        # Should return None or raise an exception.        return None    # å½“responseå¯¹è±¡è¢«spiderè§£æå®Œæˆå,è¿”å›ç»“æœç»è¿‡è¿™ä¸ªå‡½æ•°    def process_spider_output(self, response, result, spider):        print(&#39;outå‡½æ•°è¢«æ‰§è¡Œ&#39;)        # Called with the results returned from the Spider, after        # it has processed the response.        # Must return an iterable of Request, dict or Item objects.        for i in result:            yield i    # å½“çˆ¬è™«çš„ä¸­é—´ä»¶å‡ºç°å¼‚å¸¸çš„æ—¶å€™è¢«è°ƒç”¨    def process_spider_exception(self, response, exception, spider):        print(&#39;çˆ¬è™«å‡ºç°å¼‚å¸¸&#39;)        # Called when a spider or process_spider_input() method        # (from other spider middleware) raises an exception.        # Should return either None or an iterable of Response, dict        # or Item objects.        pass    # å½“çˆ¬è™«å¼€å§‹çš„æ—¶å€™ ä»start_urlsä¸­å‘èµ·request    def process_start_requests(self, start_requests, spider):        print(&#39;start_urlè¯·æ±‚å¯åŠ¨&#39;)        # Called with the start requests of the spider, and works        # similarly to the process_spider_output() method, except        # that it doesnâ€™t have a response associated.        # Must return only requests (not items).        for r in start_requests:            yield r    # å½“çˆ¬è™«ç¨‹åºå¯åŠ¨çš„æ—¶å€™æ‰§è¡Œ    def spider_opened(self, spider):        print(&#39;çˆ¬è™«ç¨‹åºå¯åŠ¨&#39;)        spider.logger.info(&#39;Spider opened: %s&#39; % spider.name)&quot;&quot;&quot;1.è¯·æ±‚åœ¨å¼€å§‹çš„æ—¶å€™,ä¼šä¼˜å…ˆä»settingsé‡Œé¢æ‰¾User-Agent,å¦‚æœé‡Œé¢æ²¡æœ‰è®¾ç½®ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„&#39;User-Agent&#39;:&#39;scrapy&#39;2.è®¾ç½®User-Agentçš„å¦å¤–ä¸€ç§æ–¹å¼ å°±æ˜¯åœ¨è¿™é‡Œè®¾ç½®scrapyå†…éƒ¨ä¼šå¯åŠ¨ä¸€ä¸ªçˆ¬è™«ä¸­é—´ä»¶ UserAgentMiddleware è®¾ç½®è¯·æ±‚ä¿¡æ¯çš„è¯éœ€è¦åœ¨è¿™é‡Œé¢è®¾ç½®,å› æ­¤æ­¤ä¸­é—´ä»¶åŒ…å«äº†ä¸€ä¸ª&quot;&quot;&quot;class RandomUserAgentMiddleware(object):    def __init__(self,crawler):        super(RandomUserAgentMiddleware).__init__()        self.ua = UserAgent()        # ä»é…ç½®æ–‡ä»¶settingsä¸­è¯»å–Random_ua_typeå€¼,å¦‚æœä¸å­˜åœ¨        # åˆ™é‡‡ç”¨é»˜è®¤çš„randomè¿›è¡Œéšæœº        self.ua_type = crawler.settings.get(&#39;RANDOM_UA_TYPE&#39;,&#39;random&#39;)    # åˆ›å»ºçˆ¬è™«å¼€å§‹çš„æ–¹æ³•    # æ³¨æ„: æ–¹æ³•å’Œå‚æ•°å¿…é¡»å’Œç³»ç»Ÿæ–¹æ³•å’Œå‚æ•°ä¿æŒä¸€è‡´    @classmethod    def from_crawler(cls,crawler):        # è¿”å›å½“å‰responseçš„å¯¹è±¡        print(&#39;user-agent111111111111111111111111111&#39;)        return cls(crawler)    # å½“è¿›ç¨‹è¿›è¡Œè¯·æ±‚çš„æ—¶å€™    def process_request(self,request,spider):        print(&#39;user-agent22222222222222222222222222222&#39;)        def user_agent():            return getattr(self.ua,self.ua_type)        request.headers.setdefault(&#39;User-Agent&#39;,user_agent())# ä¸‹è½½ä¸­é—´ä»¶ è®¾ç½®ä¸‹è½½æ–‡ä»¶ä¿¡æ¯class BaiduspiderDownloaderMiddleware(object):    # Not all methods need to be defined. If a method is not defined,    # scrapy acts as if the downloader middleware does not modify the    # passed objects.    @classmethod    def from_crawler(cls, crawler):        # This method is used by Scrapy to create your spiders.        s = cls()        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)        return s    def process_request(self, request, spider):        # Called for each request that goes through the downloader        # middleware.        # Must either:        # - return None: continue processing this request        # - or return a Response object        # - or return a Request object        # - or raise IgnoreRequest: process_exception() methods of        #   installed downloader middleware will be called        return None    def process_response(self, request, response, spider):        # Called with the response returned from the downloader.        # Must either;        # - return a Response object        # - return a Request object        # - or raise IgnoreRequest        return response    def process_exception(self, request, exception, spider):        # Called when a download handler or a process_request()        # (from other downloader middleware) raises an exception.        # Must either:        # - return None: continue processing this exception        # - return a Response object: stops process_exception() chain        # - return a Request object: stops process_exception() chain        pass    def spider_opened(self, spider):        spider.logger.info(&#39;Spider opened: %s&#39; % spider.name)</code></pre><p><code>settings.py</code>æ–‡ä»¶ä¸­å¯ç”¨çˆ¬è™«ä¸­é—´ä»¶</p><pre><code class="python"># Enable or disable spider middlewares# See https://doc.scrapy.org/en/latest/topics/spider-middleware.html# å¯ç”¨çˆ¬è™«ä¸­é—´ä»¶SPIDER_MIDDLEWARES = {   &#39;baiduspider.middlewares.BaiduspiderSpiderMiddleware&#39;: 543,    &#39;baiduspider.middlewares.RandomUserAgentMiddleware&#39;:555}</code></pre><!-- <meta http-equiv="refresh" content="1"> -->]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
      <tag>scrapy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>scrapyå¸®åŠ©</title>
    <link href="undefined2018/08/11/2018-08-11-scrapy%E5%B8%AE%E5%8A%A9/"/>
    <url>2018/08/11/2018-08-11-scrapy%E5%B8%AE%E5%8A%A9/</url>
    
    <content type="html"><![CDATA[<blockquote><p>çˆ¬è™«æ–‡ä»¶ç›®å½•spiderä¸‹,åˆ›å»ºä»»æ„åç§°çš„<code>.py</code>æ–‡ä»¶å†™å…¥å¦‚ä¸‹å†…å®¹,å³é”®è¿è¡Œ,å¯åœ¨pycharmä¸­æ¨¡æ‹Ÿå‘½ä»¤è¡Œç»ˆç«¯</p></blockquote><a id="more"></a><pre><code class="python">form scrapy import cmdline# blablaä¸ºçˆ¬è™«æ–‡ä»¶çš„`name`å€¼cmdline.execute(&quot;scrapy crawl blabla&quot;.split())</code></pre><blockquote><p>çˆ¬è™«æ–‡ä»¶ä¸­çš„<code>name</code>,<code>allowed_domains</code>å’Œ<code>start_urls</code>:</p></blockquote><pre><code class="python">name = &#39;&#39;   --------------# çˆ¬è™«æ–‡ä»¶spiderçš„åç§°allowed_domains = [&#39;&#39;] ----------------# å…è®¸çˆ¬å–çš„åŸŸå# é€šå¸¸ä¼šä¿®æ”¹çˆ¬è™«ç¨‹åºçš„start_urlsstart_urls = [&#39;&#39;] -----------------# å¼€å§‹çˆ¬å–çš„ç½‘å€,å¤šä¸ªç½‘å€æ—¶,å¤šçº¿ç¨‹è¿›è¡Œè¯·æ±‚</code></pre><!-- more --><blockquote><p><em>çˆ¬å–ç½‘ç«™è¿‡ç¨‹</em></p><ol><li><code>items.py</code>æ–‡ä»¶å®šä¹‰æ•°æ®æ¨¡å‹,ä¹Ÿå°±æ˜¯ç”¨äºå­˜å‚¨ä¸»çˆ¬è™«ç¨‹åºçˆ¬å–çš„å†…å®¹çš„å­—æ®µ</li><li>ç„¶ååœ¨çˆ¬è™«æ–‡ä»¶ä¸­å¯¼å…¥<code>from ..items import</code> è‡ªåŠ¨ç”Ÿæˆçš„çˆ¬è™«itemç±»</li><li>åˆå§‹åŒ–æ•°æ®æ¨¡å‹å¯¹è±¡,å¯¹æ•°æ®æ¨¡å‹å­—æ®µèµ‹å€¼,<code>yield</code>é€æ¡è¿”å›item</li><li>è¿”å›çš„<code>item</code>è¿›å…¥ç®¡é“æ–‡ä»¶<code>pipelines</code>è¿›è¡Œå¤„ç†å’Œè¿”å›,ä»¥åŠè‡ªå®šä¹‰ç®¡é“</li><li><code>middlewares</code>ä¸­é—´ä»¶å¤šç”¨äºè¯·æ±‚æ•°æ®,åŒæ—¶è‡ªå®šä¹‰è®¾ç½®è¯·æ±‚å¤´ä¿¡æ¯,è‡ªå®šä¹‰ä¸­é—´ä»¶</li><li><code>settings</code>æ–‡ä»¶ç”¨äºé…ç½®é¡¹ç›®ä¿¡æ¯,åŒ…æ‹¬è¯·æ±‚ä¿¡æ¯,ç®¡é“è°ƒç”¨å’Œä¼˜å…ˆçº§,å»¶è¿Ÿdelay,ä¸­é—´ä»¶ç­‰ç­‰</li></ol></blockquote><blockquote><p> ä¸»çˆ¬è™«æ–‡ä»¶ä¸­çš„<code>def parse(self,response)</code>å‡½æ•°</p></blockquote><pre><code class="python"># -*- coding: utf-8 -*-import scrapyclass BaiduspiderSpider(scrapy.Spider):    # çˆ¬è™«å    name = &#39;baiduSpider&#39;    # å…è®¸çˆ¬è™«çš„èŒƒå›´    # allowed_domains = [&#39;baidu.com&#39;]    start_urls = [&#39;http://www.baidu.com/&#39;]    # response ä¸ºscrapyçš„é»˜è®¤ä¸‹è½½ä¸­é—´è¯·æ±‚start_urlsåè¿”å›çš„ç»“æœ    def parse(self, response):        # è¯·æ±‚çš„å“åº”æ–‡æœ¬        # print(response.text)        # bodyä¸ºå“åº”ä½“        # print(response.body)        # å“åº”å¤´        # print(response.headers)        # è·å–å½“å‰çŠ¶æ€        # print(response.status)        code = response.body.decode()        # è·å–çš„responseå¯ç›´æ¥ä½¿ç”¨xpathè·å–å†…å®¹        result = response.xpath(&#39;.//div[@class=&quot;cover&quot;]/@cover-text&#39;)        # ä»èƒ½å¯¹å…¶ä½¿ç”¨xpathå–æ•°æ®        result = result.xpath(......)        # æ­¤æ—¶`result`ä¸º`[&#39;selector=&lt;...&gt;,data=&lt;...&gt;&#39;]`æ ·å¼        result = result.extract()  # ä½¿å…¶è½¬åŒ–ä¸ºåˆ—è¡¨        result = result[0]    # å–ç¬¬ä¸€ä¸ªå…ƒç´         # ä¹Ÿå¯ä»¥ä¸€æ­¥åˆ°ä½:        # retult = response.xpath(&#39;.//div[@class=&quot;cover&quot;]/@cover-text&#39;).extract_first(&#39;&#39;)        # å°†items.pyä½œä¸ºæ¨¡å—ä¸­å¯¼å…¥å…¶ä¸­çš„classç±»`MokoItem`        from ..items import MokoItem        for ul in ul_list:            # åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡MokoItemç±»            item = MokoItem()            # ä¸ºæ•°æ®æ¨¡å‹ä¸­çš„å­—æ®µèµ‹å€¼            item[&#39;title&#39;] = retult            # é€ä¸ªæ•°æ®æ¨¡å‹æ¯ä¸ªitemå¯¹è±¡            yield item</code></pre><blockquote><p>åœ¨æ§åˆ¶å°è¿è¡Œçˆ¬è™«æ—¶å¯ä»¥åŒæ—¶ä¿å­˜è¿”å›çš„itemä¸ºæœ¬åœ°æ–‡ä»¶</p></blockquote><pre><code class="python"># å°†æ–‡ä»¶å­˜å‚¨ä¸ºæŒ‡å®šç±»å‹ æ”¯æŒå››ç§æ•°æ®ç±»å‹text,json,xml,csvcrapy crwl meikong -o meikong.xml# è½¬æ¢ç¼–ç scrapy crawl meikong -o mei.json -s FEED_EXPORT_ENCODING=UTF-8</code></pre><blockquote><p><code>settings</code>éƒ¨åˆ†é…ç½®è¯´æ˜</p></blockquote><pre><code class="python">BOT_NAME = &#39;baidu&#39;# çˆ¬è™«æ‰€åœ¨åœ°SPIDER_MODULES = [&#39;baidu.spiders&#39;]NEWSPIDER_MODULE = &#39;baidu.spiders&#39;# éµå®ˆçˆ¬è™«åè®®ROBOTSTXT_OBEY = False# Configure maximum concurrent requests performed by Scrapy (default: 16)# æœ€å¤§è¯·æ±‚å¹¶å‘é‡ é»˜è®¤16# CONCURRENT_REQUESTS = 32# configure é…ç½® è¯·æ±‚å»¶è¿Ÿ# Configure a delay for requests for the same website (default: 0)# See https://doc.scrapy.org/en/latest/topics/settings.html#download-delay# See also autothrottle settings and docs#DOWNLOAD_DELAY = 3# The download delay setting will honor only one of:#CONCURRENT_REQUESTS_PER_DOMAIN = 16#CONCURRENT_REQUESTS_PER_IP = 16# Disable cookies (enabled by default)# æ˜¯å¦ä½¿ç”¨cookie#COOKIES_ENABLED = False# è¯·æ±‚å¤´ä¿¡æ¯,å¯æ·»åŠ ç”¨æˆ·è¡¨ç¤ºUser-AgentDEFAULT_REQUEST_HEADERS = {  &#39;Accept&#39;: &#39;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#39;,  &#39;Accept-Language&#39;: &#39;en&#39;}SPIDER_MIDDLEWARES = {        # å€¼è¶Šå°,ä¼˜å…ˆçº§è¶Šé«˜,ä¼˜å…ˆçº§è¶Šé«˜,è¶Šå…ˆæ‰§è¡Œ   &#39;baidu.middlewares.BaiduSpiderMiddleware&#39;: 543,}# ä¸‹è½½ä¸­é—´ä»¶OWNLOADER_MIDDLEWARES = {        # å€¼è¶Šå°,ä¼˜å…ˆçº§è¶Šé«˜,ä¼˜å…ˆçº§è¶Šé«˜,è¶Šå…ˆæ‰§è¡Œ   &#39;baidu.middlewares.BaiduDownloaderMiddleware&#39;: 543,}# Enable or disable extensions æ˜¯å¦è¿›è¡Œæ‰©å±•# See https://doc.scrapy.org/en/latest/topics/extensions.html#EXTENSIONS = {#    &#39;scrapy.extensions.telnet.TelnetConsole&#39;: None,#}ITEM_PIPELINES = {    # å€¼è¶Šå°,ä¼˜å…ˆçº§è¶Šé«˜,ä¼˜å…ˆçº§è¶Šé«˜,è¶Šå…ˆæ‰§è¡Œ   &#39;baidu.pipelines.BaiduPipeline&#39;: 1,}</code></pre><blockquote><p>ä¸»çˆ¬è™«æ–‡ä»¶ä¸­å›¾ç‰‡å’Œæ–‡ä»¶é“¾æ¥å­—æ®µ<code>[]</code>å’Œå›è°ƒå‡½æ•°<code>callback=</code>.</p><p>`settings.pyâ€™æ–‡ä»¶ä¸­ä½¿ç”¨ç³»ç»Ÿæ–‡ä»¶,å›¾ç‰‡å¤„ç†ç®¡é“ä¸‹è½½å›¾ç‰‡å’Œæ–‡ä»¶.</p></blockquote><ul><li>spider.py<pre><code class="pthon"># -*- coding: utf-8 -*-import scrapyfrom ..items import ImagenetItem</code></pre></li></ul><p>class ImageSpider(scrapy.Spider):<br>    name = â€˜imageâ€™<br>    allowed_domains = [â€˜pic.netbian.comâ€™]<br>    # è¯·æ±‚æœ€å¼€å§‹çš„url<br>    start_urls = [â€˜<a href="http://pic.netbian.com/4kmeishi/&#39;]" target="_blank" rel="noopener">http://pic.netbian.com/4kmeishi/&#39;]</a></p><pre><code>def parse(self, response):    # æ ¹æ®å“åº”æ¥æ‰¾åˆ°åˆ¶å®šçš„å†…å®¹ ç°åœ¨æ‰¾çš„æ˜¯imgçš„srcå±æ€§    img_list = response.xpath(&#39;//ul[@class=&quot;clearfix&quot;]/li/a/img/@src&#39;)    # print(img_list)    # æ‰¾åˆ°å¤šä¸ªå±æ€§å€¼ éå†    for img in img_list:        # ä½¿ç”¨åœ¨items.pyä¸­å®šä¹‰çš„æ•°æ®æ¨¡å‹item        item = ImagenetItem()        img_src =&#39;http://pic.netbian.com&#39; + img.extract()        # print(img_src)        # å°†ä¸‹è½½åœ°å€æ”¾å…¥æ•°æ®æ¨¡å‹ä¸­        # ä¸‹è½½åœ°å€è¦åŒ…åœ¨listå½“ä¸­        item[&#39;img_src&#39;] = [img_src]        item[&#39;fileUrl&#39;] = [fileUrl]        # å°†æ•°æ®ä¼ è¾“ç»™ç®¡é“        yield item    next_url = response.xpath(&#39;//div[@class=&quot;page&quot;]/a[text()=&quot;ä¸‹ä¸€é¡µ&quot;]/@href&#39;).extract()    if len(next_url) != 0:        url = &#39;http://pic.netbian.com&#39; + next_url[0]        # å°†urlä¼ ç»™scrapy.Request  å¾—åˆ°çš„ç»“æœç»§ç»­ç”¨self.parseç»§ç»­å¤„ç†        yield scrapy.Request(url,callback=self.parse)</code></pre><pre><code>* settings.py```pythonITEM_PIPELINES = {   # &#39;imageNet.pipelines.ImagenetPipeline&#39;: 300,   #  scrapyä¸­ä¸“é—¨è´Ÿè´£å›¾ç‰‡ä¸‹è½½çš„ç®¡é“    &#39;scrapy.pipelines.images.ImagesPipeline&#39; : 1,    # æ–‡ä»¶ä¸‹è½½ç®¡é“    &#39;scrapy.pipelines.files.FilesPipeline&#39;:2}# ä½“ç‰‡çš„å­˜å‚¨è·¯å¾„IMAGES_STORE = &#39;D:/imageDownLoad&#39;# å›¾ç‰‡çš„ä¸‹è½½åœ°å€ æ ¹æ®itemä¸­çš„å­—æ®µæ¥è®¾ç½®å“ªä¸€ä¸ªå†…å®¹éœ€è¦è¢«ä¸‹è½½IMAGES_URLS_FIELD = &#39;img_src&#39;FILES_STORE = &#39;d:/qishu/book/&#39;FILES_URLS_FIELD = &#39;fileUrl&#39;</code></pre><blockquote><p>è‡ªå®šä¹‰ç®¡é“æ–‡ä»¶å°†itemså­—æ®µä¿å­˜åˆ°<code>sqlite</code>æ•°æ®åº“</p><p>æ³¨æ„<code>settings.py</code>æ–‡ä»¶ä¸­å¯ç”¨ç®¡é“</p></blockquote><pre><code class="python"># -*- coding: utf-8 -*-# Define your item pipelines here## Don&#39;t forget to add your pipeline to the ITEM_PIPELINES setting# See: https://doc.scrapy.org/en/latest/topics/item-pipeline.htmlimport sqlite3class HongxiutianxiangPipeline(object):    def process_item(self, item, spider):        return itemclass HongXiuDBPipeline(object):    def open_spider(self,spider):        self.con = sqlite3.connect(&#39;hongxiuDB&#39;)        self.cursor = self.con.cursor()        self.cursor.execute(&#39;create table if not exists bookTable(name text,author text,img text,intro text)&#39;)        self.con.commit()    def process_item(self,item,spider):        print(&#39;--------------------------------------&#39;)        self.cursor.execute(&#39;insert into bookTable VALUES (&quot;{}&quot;,&quot;{}&quot;,&quot;{}&quot;,&quot;{}&quot;)&#39;.format(item[&#39;name&#39;],item[&#39;author&#39;],item[&#39;img&#39;],item[&#39;intro&#39;]))        self.con.commit()        return item    def close_spider(self,spider):        self.cursor.close()        self.con.close()</code></pre><blockquote><p>è‡ªå®šä¹‰ç®¡é“ä¿å­˜itemsåˆ°jsonæ–‡ä»¶ä¸­</p></blockquote><pre><code class="python"># -*- coding: utf-8 -*-# Define your item pipelines here## Don&#39;t forget to add your pipeline to the ITEM_PIPELINES setting# See: https://doc.scrapy.org/en/latest/topics/item-pipeline.html# ç”¨æ¥æ‰“å¼€æŒ‡å®šæ–‡ä»¶,å¹¶ä¸”å¯¹æ–‡ä»¶è¿›è¡Œè½¬ç  é˜²æ­¢å‡ºç°ä¹±ç é—®é¢˜import codecsimport jsonimport osclass XiaoshuoPipeline(object):    def __init__(self):        # w å†™æ–‡ä»¶        # w+è¯»å†™æ–‡ä»¶ r+ è¯»å†™æ–‡ä»¶        # å‰è€…è¯»å†™æ–‡ä»¶ å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»º        # åè€…è¯»å†™æ–‡ä»¶ å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ åˆ™æŠ›å‡ºå¼‚å¸¸        self.file = codecs.open(filename=&#39;book.json&#39;,mode=&#39;w+&#39;,encoding=&#39;utf-8&#39;)        self.file.write(&#39;&quot;list&quot;:[&#39;)    # å¦‚æœæƒ³è¦å°†æ•°æ®å†™å…¥æœ¬åœ°æˆ–è€…ä½¿ç”¨æ•°æ®åº“çš„æ—¶å€™ è¿™ä¸ªæ–¹æ³•éœ€è¦ä¿ç•™    def process_item(self, item, spider):        # å°†itemå¯¹è±¡è½¬åŒ–æˆä¸€ä¸ªå­—å…¸å¯¹è±¡        res = dict(item)        # dumpså°†å­—å…¸å¯¹è±¡è½¬åŒ–æˆå­—ç¬¦ä¸² asciiç¼–ç æ˜¯å¦å¯ç”¨        # å¦‚æœç›´æ¥å°†å­—å…¸å½¢å¼çš„æ•°æ®å†™å…¥åˆ°æ–‡ä»¶å½“ä¸­  ä¼šå‘ç”Ÿé”™è¯¯        # æ‰€ä»¥éœ€è¦å°†å­—å…¸å½¢å¼çš„å€¼,è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶        str  = json.dumps(res,ensure_ascii=False)        # å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶å½“ä¸­        self.file.write(str)        self.file.write(&#39;,\n&#39;)        return item    def open_spider(self,spider):        print(&#39;çˆ¬è™«å¼€å§‹&#39;)    def close_spider(self,spider):        # åˆ é™¤æ–‡ä»¶å½“ä¸­æœ€åä¸€ä¸ªå­—ç¬¦        # -1 è¡¨ç¤ºåç§»é‡        # SEEK_END å®šä½åˆ°æ–‡ä»¶æœ€åä¸€ä¸ªå­—ç¬¦        self.file.seek(-1,os.SEEK_END)        # å¼€å§‹æ‰§è¡Œ        self.file.truncate()        self.file.seek(-1,os.SEEK_END)        self.file.truncate()        self.file.write(&#39;]&#39;)        self.file.close()        print(&#39;çˆ¬è™«ç»“æŸ&#39;)</code></pre><!-- <meta http-equiv="refresh" content="1"> -->]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
      <tag>scrapy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>phantomjsç¯å¢ƒé…ç½®</title>
    <link href="undefined2018/08/10/2018-08-09-phantomjs/"/>
    <url>2018/08/10/2018-08-09-phantomjs/</url>
    
    <content type="html"><![CDATA[<h3 id="phantomjsç®€ä»‹"><a href="#phantomjsç®€ä»‹" class="headerlink" title="phantomjsç®€ä»‹"></a>phantomjsç®€ä»‹</h3><p>æœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æµè§ˆå™¨å¤„ç†ç½‘é¡µï¼Œä½†å¹¶ä¸éœ€è¦æµè§ˆï¼Œæ¯”å¦‚ç”Ÿæˆç½‘é¡µçš„æˆªå›¾ã€æŠ“å–ç½‘é¡µæ•°æ®ç­‰æ“ä½œã€‚PhantomJSçš„åŠŸèƒ½ï¼Œå°±æ˜¯æä¾›ä¸€ä¸ªæµè§ˆå™¨ç¯å¢ƒçš„å‘½ä»¤è¡Œæ¥å£ï¼Œä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œä¸€ä¸ªâ€œè™šæ‹Ÿæµè§ˆå™¨â€ï¼Œé™¤äº†ä¸èƒ½æµè§ˆï¼Œå…¶ä»–ä¸æ­£å¸¸æµè§ˆå™¨ä¸€æ ·ã€‚å®ƒçš„å†…æ ¸æ˜¯WebKitå¼•æ“ï¼Œä¸æä¾›å›¾å½¢ç•Œé¢ï¼Œåªèƒ½åœ¨å‘½ä»¤è¡Œä¸‹ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒå®Œæˆä¸€äº›ç‰¹æ®Šçš„ç”¨é€”ã€‚</p><a id="more"></a><h3 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h3><blockquote><ol><li>ä¸‹è½½<a href="http://phantomjs.org/download.html" target="_blank" rel="noopener" title="è¯¦æƒ…é¡µ">phantomjs</a>,é€‰æ‹©é€‚åˆå¹³å°</li></ol></blockquote><blockquote><ol start="2"><li>è§£å‹å‹ç¼©åŒ…åˆ°ä»»æ„ä½ç½®,ä¾‹å¦‚æˆ‘çš„:</li></ol></blockquote><p><img src="/img/Pictures/phantomjs/1.png" srcset="/img/loading.gif" alt="img" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="3"><li>æ·»åŠ ç³»ç»Ÿç¯å¢ƒå˜é‡,å°†åˆšæ‰è§£å‹åçš„è·¯å¾„æ·»åŠ è¿›å»,å¦‚å›¾æ‰€ç¤º:</li></ol></blockquote><p><img src="/img/Pictures/phantomjs/2.png" srcset="/img/loading.gif" alt="img" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="4"><li>ä½¿ç”¨:é€šå¸¸é…åˆseleniumä½¿ç”¨</li></ol></blockquote><pre><code class="python">from selenium import webdriverdriver = webdriver.PhantomJS()driver.get(&#39;http://www.baidu.com&#39;)code = driver.page_sourceprint(code)</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mysqlå®‰è£…</title>
    <link href="undefined2018/08/09/2018-08-08-mysql%E5%AE%89%E8%A3%85/"/>
    <url>2018/08/09/2018-08-08-mysql%E5%AE%89%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<p>Mysqlå®‰è£…è¯¦ç»†æ­¥éª¤:</p><a id="more"></a><blockquote><ol><li>æ¥å—ä½¿ç”¨æ¡æ¬¾</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql2.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="2"><li>é€‰æ‹©é»˜è®¤å¼€å‘ç‰ˆå³å¯</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql3.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="3"><li>å®‰è£…è·¯å¾„é»˜è®¤å³å¯</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql4.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="4"><li>å®‰è£…äº§å“åŠä¾èµ–ç»„ä»¶å…ˆæ‰§è¡Œ<code>Excute</code>å†next</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql5.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="5"><li>å®‰è£…<code>Excute</code></li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql6.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="6"><li>next</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql7.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="7"><li>åˆ›å»ºå¯†ç </li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql8.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="8"><li>é»˜è®¤next</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql9.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="9"><li>finish</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql10.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="10"><li>next</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql11.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="11"><li>ç™»é™†</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql12.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="12"><li>Excute</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql13.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="13"><li>finish</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql14.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="14"><li>next</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql15.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="15"><li>next</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql16.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><blockquote><ol start="16"><li>é™ç­‰ç‰‡åˆ»</li></ol></blockquote><p><img src="/img/Pictures/mysql/mysql17.png" srcset="/img/loading.gif" alt="img" title="åŒå‡»æŸ¥çœ‹å¤§å›¾"></p><!-- <meta http-equiv="refresh" content="1"> -->]]></content>
    
    
    
    <tags>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xpathè·å–æ–‡æœ¬</title>
    <link href="undefined2018/08/04/2018-08-03-xpath%E8%8E%B7%E5%8F%96%E6%96%87%E6%9C%AC/"/>
    <url>2018/08/04/2018-08-03-xpath%E8%8E%B7%E5%8F%96%E6%96%87%E6%9C%AC/</url>
    
    <content type="html"><![CDATA[<h3 id="ä»¥çˆ¬å–ç™¾åº¦è´´å§contentè¯´æ˜"><a href="#ä»¥çˆ¬å–ç™¾åº¦è´´å§contentè¯´æ˜" class="headerlink" title="ä»¥çˆ¬å–ç™¾åº¦è´´å§contentè¯´æ˜:"></a>ä»¥çˆ¬å–ç™¾åº¦è´´å§contentè¯´æ˜:</h3><ol><li>è·å–æœ€å¤–è¾¹æ ‡ç­¾,éå†å†…éƒ¨æ‰€æœ‰å­æ ‡ç­¾,è·å–æ ‡ç­¾æ–‡æœ¬<pre><code class="python">content =div.xpath(&#39;.//cc/div[@class=&quot;d_post_content j_d_post_content &quot;]//text()&#39;).extract()`</code></pre></li><li>æ­£åˆ™å»æ‰æ‰€æœ‰æ ‡ç­¾ &lt;.*?&gt;      re.sub(â€˜â€™,content)<pre><code class="python">content = div.xpath(&#39;.//cc/div[@class=&quot;d_post_content j_d_post_content &quot;]&#39;)</code></pre></li></ol><p>pattern = re.compile(â€˜&lt;.*?&gt;â€™)</p><p>content = pattern.sub(â€˜â€™,content)</p><pre><code>3. /text() è·å–æ ‡ç­¾çš„æ–‡æœ¬   //text()è·å–æ ‡ç­¾ä»¥åŠå­æ ‡ç­¾çš„æ–‡æœ¬```pythoncontent_list = div.xpath(&#39;.//div[@class=&quot;d_post_content j_d_post_content &quot;]//text()&#39;).extract()</code></pre><ol start="4"><li>ä½¿ç”¨xpath(â€˜string(.)â€™)è¿™ç§æ–¹å¼è·å–æ‰€æœ‰æ–‡æœ¬ å¹¶ä¸”æ‹¼æ¥<pre><code class="python"> content = div.xpath(&#39;.//div[@class=&quot;d_post_content j_d_post_content &quot;]&#39;).xpath(&#39;string(.)&#39;).extract()[0] + &#39;\n&#39;</code></pre>æ–‡æœ¬å†…å®¹è·å–ä¹‹å<code>print(content)</code>æŸ¥çœ‹å†…å®¹,å¦‚éœ€å¤„ç†æ ¼å¼,åˆ™å¦‚ä¸‹:</li></ol><pre><code class="python">remove = re.compile(&#39;\s&#39;)content = &#39;&#39;for string in content_list:    string = remove.sub(&#39;&#39;,string)    content += stringself.f.write(content + &#39;\n&#39;)</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é…·å®‰</title>
    <link href="undefined2018/08/01/2018-07-31-%E9%85%B7%E5%AE%89/"/>
    <url>2018/08/01/2018-07-31-%E9%85%B7%E5%AE%89/</url>
    
    <content type="html"><![CDATA[<h2 id="çˆ¬å–é…·å®‰appä¿¡æ¯"><a href="#çˆ¬å–é…·å®‰appä¿¡æ¯" class="headerlink" title="çˆ¬å–é…·å®‰appä¿¡æ¯"></a>çˆ¬å–é…·å®‰appä¿¡æ¯</h2><a id="more"></a><pre><code class="python">from urllib.request import Request,urlopenfrom lxml import etreefrom fake_useragent import UserAgentimport xlwtclass Kuan(object):    def __init__(self):        self.base_url = &#39;https://www.coolapk.com/apk?p=642&#39;        self.headers = UserAgent()        self.workBook = None        self.sheet = None        self.record = 1    def spider(self):        self.createWorkBook()        self.get_code_with_url(self.base_url)        self.workBook.save(&#39;D:/é…·å®‰.xls&#39;)    def get_code_with_url(self,url):        headers = {            &#39;User-Agent&#39;:self.headers.random        }        print(headers)        request = Request(url,headers=headers)        response = urlopen(request).read().decode()        print(response)        code = etree.HTML(response)        items = code.xpath(&#39;//div[@class=&quot;app_left_list&quot;]/a&#39;)        for item in items:            title = item.xpath(&#39;.//p[@class=&quot;list_app_title&quot;]/text()&#39;)[0]            info = item.xpath(&#39;.//p[@class=&quot;list_app_info&quot;]//text()&#39;)            grade = info[0].split(&#39; &#39;)[0]            large = info[0].split(&#39; &#39;)[2]            download = info[1].split(&#39; &#39;)[0]            status = info[1].split(&#39; &#39;)[2]            # print(grade,large,download,status)            des = item.xpath(&#39;.//p[@class=&quot;list_app_description&quot;]/text()&#39;)            if len(des) == 0:                des = &#39;&#39;            else:                des = des[0]            list = [title,grade,large,download,status,des]            for index,item in enumerate(list):                self.sheet.write(self.record,index,item)            self.record += 1        self.next_page(code)    def next_page(self,code):        next_page_url = code.xpath(&#39;//ul[@class=&quot;pagination&quot;]/li[last()-1]/a/@href&#39;)[0]        if next_page_url == &#39;javascript:void(0);&#39;:            print(&#39;å·²ç»åˆ°æœ€åä¸€é¡µäº†&#39;)            return        self.get_code_with_url(&#39;https://www.coolapk.com&#39;+next_page_url)    def createWorkBook(self):        list = [&#39;åº”ç”¨åç§°&#39;,&#39;è¯„åˆ†&#39;,&#39;å¤§å°&#39;,&#39;ä¸‹è½½é‡&#39;,&#39;æ›´æ–°çŠ¶æ€&#39;,&#39;åº”ç”¨ç®€ä»‹&#39;]        self.workBook = xlwt.Workbook(encoding=&#39;utf-8&#39;)        self.sheet = self.workBook.add_sheet(&#39;app&#39;)        for index,item in enumerate(list):            self.sheet.write(0,index,item)kuan = Kuan()kuan.spider()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>seleniumæ¨¡æ‹Ÿè‡ªç„¶äººæ“ä½œç¾é£Ÿæ°ç½‘ç«™</title>
    <link href="undefined2018/08/01/2018-07-31-selenium%E6%A8%A1%E6%8B%9F%E8%87%AA%E7%84%B6%E4%BA%BA%E6%93%8D%E4%BD%9C%E7%BE%8E%E9%A3%9F%E6%9D%B0%E7%BD%91%E7%AB%99/"/>
    <url>2018/08/01/2018-07-31-selenium%E6%A8%A1%E6%8B%9F%E8%87%AA%E7%84%B6%E4%BA%BA%E6%93%8D%E4%BD%9C%E7%BE%8E%E9%A3%9F%E6%9D%B0%E7%BD%91%E7%AB%99/</url>
    
    <content type="html"><![CDATA[<blockquote><p>Pycharm æ§åˆ¶æµè§ˆå™¨æ‰“å¼€ç¾é£Ÿæ°ç½‘ç«™:[<a href="https://www.meishij.net/]" target="_blank" rel="noopener">https://www.meishij.net/]</a><br>é¼ æ ‡è‡ªåŠ¨ç§»åŠ¨åˆ°<code>èœå•å¤§å…¨</code>,ç‚¹å‡»<code>å­•å¦‡</code>æ ‡ç­¾,è¿›å…¥é¡µé¢,æ»šåŠ¨æ¡è‡ªåŠ¨ä¸‹æ»‘<br>åŒæ—¶æ§åˆ¶å°æ‰“å°èœå</p></blockquote><a id="more"></a><pre><code class="python">from selenium import webdriverfrom selenium.webdriver.support.ui import WebDriverWaitfrom selenium.webdriver.common.action_chains import ActionChainsimport timedriver = webdriver.Chrome()driver.get(&#39;https://www.meishij.net/&#39;)# é¼ æ ‡ç§»åŠ¨åˆ°èœè°±å¤§å…¨order = driver.find_element_by_css_selector(&#39;.hasmore a&#39;)WebDriverWait(driver,10).until(lambda driver: order.is_displayed())action = ActionChains(driver).move_to_element(order).perform()# é¼ æ ‡ç‚¹å‡»å­•å¦‡æ ‡ç­¾women = driver.find_element_by_link_text(u&#39;å­•å¦‡&#39;)WebDriverWait(driver,10).until(lambda driver: women.is_displayed())women.click()for page in range(1,3):    print(&#39;æ­£åœ¨æŸ¥è¯¢ç¬¬{}é¡µ&#39;.format(page))    # è®¾ç½®æ»šåŠ¨æ¡æ¯æ¬¡æ»šåŠ¨å››åˆ†ä¹‹ä¸€    for long in range(1,5):        x = float(long) / 4        js = &#39;document.documentElement.scrollTop = document.documentElement.scrollHeight * %f&#39; %x        driver.execute_script(js)        time.sleep(3)    # è·å–èœå    titles = driver.find_elements_by_xpath(&#39;//div[@class=&quot;listtyle1&quot;]/a&#39;)    # titles = driver.find_elements_by_xpath(&#39;//div[@class=&quot;listtyle1&quot;]/a/@title&#39;)    for title in titles:        title = title.get_attribute(&#39;title&#39;)        print(title)    # ä¸‹ä¸€é¡µ    next_page = driver.find_element_by_link_text(u&#39;ä¸‹ä¸€é¡µ&#39;).click()time.sleep(20)driver.quit()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gitä½¿ç”¨</title>
    <link href="undefined2018/07/31/2018-07-30-git%E4%BD%BF%E7%94%A8/"/>
    <url>2018/07/31/2018-07-30-git%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•:"></a>ç›®å½•:</h1><h2 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h2><ol><li><a href="#gitçš„åˆå§‹åŒ–">gitçš„åˆå§‹åŒ–</a><ul><li>Gité…ç½®</li></ul></li><li><a href="#è·å¾—ä¸€ä¸ªGitä»“åº“">è·å¾—ä¸€ä¸ªGitä»“åº“</a><ul><li>Cloneä¸€ä¸ªä»“åº“</li><li>åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä»“åº“</li></ul></li><li><a href="#æ­£å¸¸çš„å·¥ä½œæµç¨‹">æ­£å¸¸çš„å·¥ä½œæµç¨‹</a><ul><li>åˆ›å»ºæˆ–ä¿®æ”¹æ–‡ä»¶</li><li>ä½¿ç”¨<code>git add</code>åŠ å…¥ç¼“å­˜åŒº</li><li>ä½¿ç”¨<code>git commit</code>æäº¤ä¿®æ”¹</li></ul></li><li><a href="#åˆ†æ”¯ä¸åˆå¹¶">åˆ†æ”¯ä¸åˆå¹¶</a><ul><li>åˆ›å»ºåˆ†æ”¯</li><li>åˆ‡æ¢åˆ†æ”¯</li><li>åˆå¹¶åˆ†æ”¯</li><li>åˆ é™¤åˆ†æ”¯</li><li>æ’¤é”€ä¸€ä¸ªåˆå¹¶</li><li>å¿«é€Ÿå‘å‰åˆå¹¶</li></ul></li><li><a href="#Gitæ—¥å¿—">æ—¥å¿—</a><ul><li>æŸ¥çœ‹æ—¥å¿—</li><li>æ—¥å¿—ç»Ÿè®¡</li><li>æ ¼å¼åŒ–æ—¥å¿—</li><li>æ—¥å¿—æ’åº</li></ul></li><li><a href="#å°ç»“">å°ç»“</a></li></ol><a id="more"></a><h3 id="gitçš„åˆå§‹åŒ–"><a href="#gitçš„åˆå§‹åŒ–" class="headerlink" title="gitçš„åˆå§‹åŒ–"></a>gitçš„åˆå§‹åŒ–</h3><h4 id="gité…ç½®"><a href="#gité…ç½®" class="headerlink" title="gité…ç½®"></a>gité…ç½®</h4><p>é…ç½®å…¨å±€å˜é‡,ç”¨æˆ·åå’Œé‚®ç®±ä¸ºæäº¤<code>commit</code>æ—¶çš„ç­¾å</p><pre><code class="bash">`$ git config --global user.name &quot;zysxm&quot;` --zysxm ä¸ºgithubç”¨æˆ·å`$ git config --global user.email &quot;451253127@qq.com&quot; ` --githubæ³¨å†Œé‚®ç®±</code></pre><p>é…ç½®å®Œæˆåä¼šåœ¨æœ¬åœ°ç³»ç»Ÿå½“å‰ç³»ç»Ÿç”¨æˆ·ç›®å½•ä¸‹åˆ›å»º<code>.gitconf</code>éšè—æ–‡ä»¶ å¯ä»¥è¾“å…¥<code>cat/echo .gitconfig</code>å‘½ä»¤æŸ¥çœ‹å†…å®¹</p><pre><code class="bash">$ cat ~/.gitconfig[user]        name = zysxm        email = 451253127@qq.comä¸Šé¢çš„é…ç½®æ–‡ä»¶å°±æ˜¯Gitå…¨å±€é…ç½®çš„æ–‡ä»¶ï¼Œä¸€èˆ¬é…ç½®æ–¹æ³•æ˜¯:    git config --global &lt;é…ç½®åç§°&gt; &lt;é…ç½®çš„å€¼&gt;é…ç½®å±€éƒ¨å˜é‡(åˆ‡æ¢é¡¹ç›®è·¯å¾„):    git config    å‘½ä»¤ä¸å¸¦--globalé€‰é¡¹æ¥è®¾ç½®æ­¤å‘½ä»¤ä¼šåœ¨å½“å‰ç›®å½•åˆ›å»º`.git/config`,åªé’ˆå¯¹å½“å‰é¡¹ç›®çš„é…ç½®</code></pre><h3 id="è·å¾—ä¸€ä¸ªGitä»“åº“"><a href="#è·å¾—ä¸€ä¸ªGitä»“åº“" class="headerlink" title="è·å¾—ä¸€ä¸ªGitä»“åº“"></a>è·å¾—ä¸€ä¸ªGitä»“åº“</h3><pre><code>1. ä»å·²æœ‰gitä»“åº“clone2. æ–°å»ºä»“åº“,è¿›è¡Œç‰ˆæœ¬æ§åˆ¶</code></pre><h4 id="Cloneä¸€ä¸ªä»“åº“"><a href="#Cloneä¸€ä¸ªä»“åº“" class="headerlink" title="Cloneä¸€ä¸ªä»“åº“"></a>Cloneä¸€ä¸ªä»“åº“</h4><pre><code>git clone ä»“åº“åœ°å€</code></pre><h4 id="åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä»“åº“"><a href="#åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä»“åº“" class="headerlink" title="åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä»“åº“"></a>åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä»“åº“</h4><pre><code class="bash">åœ¨å·²å­˜åœ¨çš„ç›®å½•`D:/newdir`ä¸‹:    git initgitä¼šè¾“å‡º:    Initialized empty Git repository in D:newdir/.git/è¾“å…¥`ls -la `å‡ºç°`.git`ç›®å½•,å³åˆå§‹åŒ–æˆåŠŸ</code></pre><h3 id="æ­£å¸¸çš„å·¥ä½œæµç¨‹"><a href="#æ­£å¸¸çš„å·¥ä½œæµç¨‹" class="headerlink" title="æ­£å¸¸çš„å·¥ä½œæµç¨‹"></a>æ­£å¸¸çš„å·¥ä½œæµç¨‹</h3><pre><code>1. åˆ›å»º,ä¿®æ”¹2. `git add` æ·»åŠ åˆ›å»ºæˆ–ä¿®æ”¹åˆ°æœ¬åœ°ç¼“å­˜(index)3. `git commit`æäº¤åˆ°æœ¬åœ°ä»£ç åº“4. `git push`å°†æœ¬åœ°ä»£ç åº“åŒæ­¥åˆ°è¿œç«¯</code></pre><h4 id="åˆ›å»ºæˆ–ä¿®æ”¹æ–‡ä»¶"><a href="#åˆ›å»ºæˆ–ä¿®æ”¹æ–‡ä»¶" class="headerlink" title="åˆ›å»ºæˆ–ä¿®æ”¹æ–‡ä»¶"></a>åˆ›å»ºæˆ–ä¿®æ”¹æ–‡ä»¶</h4><pre><code class="bash">å¢åˆ æ”¹åä½¿ç”¨`git status`æŸ¥çœ‹å½“å‰gitä»“åº“çŠ¶æ€æ–‡ä»¶å¤„äº`untarcked`çŠ¶æ€æ—¶,ä½¿ç”¨`git add`åŠ å…¥ç¼“å­˜(index)</code></pre><h4 id="ä½¿ç”¨git-addåŠ å…¥ç¼“å­˜åŒº"><a href="#ä½¿ç”¨git-addåŠ å…¥ç¼“å­˜åŒº" class="headerlink" title="ä½¿ç”¨git addåŠ å…¥ç¼“å­˜åŒº"></a>ä½¿ç”¨<code>git add</code>åŠ å…¥ç¼“å­˜åŒº</h4><pre><code class="bash">å°†æ‰€æœ‰ä¿®æ”¹æ·»åŠ ç¼“å­˜åŒº:    git add . æ·»åŠ :    git add newfileæŸ¥çœ‹çŠ¶æ€:    git statusæ­¤æ—¶å·²ä¸º`commit`åšå¥½å‡†å¤‡ä½¿ç”¨`git diff`åŠ ä¸Š`--cached`å‚æ•°,æŸ¥çœ‹ç¼“å­˜åŒºé‚£äº›æ–‡ä»¶è¢«ä¿®æ”¹,æŒ‰`q`é€€å‡º    git diff --cachedä¸åŠ `--cached`å‚æ•°æ—¶,æ˜¾ç¤ºå½“å‰å·²åšçš„æ‰€æœ‰æ›´æ”¹</code></pre><h4 id="ä½¿ç”¨git-commitæäº¤ä¿®æ”¹"><a href="#ä½¿ç”¨git-commitæäº¤ä¿®æ”¹" class="headerlink" title="ä½¿ç”¨git commitæäº¤ä¿®æ”¹"></a>ä½¿ç”¨<code>git commit</code>æäº¤ä¿®æ”¹</h4><pre><code class="bash">åŠ å…¥ç¼“å­˜åŒºä¸­çš„æ–‡ä»¶ä½¿ç”¨`git commit`æäº¤åˆ°æœ¬åœ°ä»“åº“    git commit -m &quot;add newfile&quot;ä½¿æ–°å»ºçš„æœ¬åœ°ä»“åº“å…³è”è¿œç¨‹ä»“åº“:    git remote add origin è¿œç¨‹ä»“åº“åœ°å€åŒæ­¥:    git push origin master</code></pre><h3 id="åˆ†æ”¯ä¸åˆå¹¶"><a href="#åˆ†æ”¯ä¸åˆå¹¶" class="headerlink" title="åˆ†æ”¯ä¸åˆå¹¶"></a>åˆ†æ”¯ä¸åˆå¹¶</h3><blockquote><p><code>Git</code>çš„åˆ†æ”¯<code>branch</code>æ˜¯å°†ä»£ç æäº¤åˆ°ä¸»çº¿(master)ä¹‹å¤–,åŒæ—¶ä¸ä¼šå½±å“ä»£ç åº“ä¸»çº¿.</p><p>åˆ†æ”¯çš„ä½œç”¨ä¸»è¦ä½“ç°åœ¨å¤šäººåˆä½œå¼€å‘,æ¯”å¦‚Aç å†œè´Ÿè´£ä¸€ä¸ªç‹¬ç«‹åŠŸèƒ½éœ€è¦ä¸€ä¸ªæœˆæ—¶é—´å®Œæˆ,å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªåˆ†æ”¯,åªæŠŠè¯¥åŠŸèƒ½çš„ä»£ç æäº¤åˆ°è¿™ä¸ªåˆ†æ”¯,è€Œå…¶ä»–ç å†œä»ç„¶å¯ä»¥ç»§ç»­ä½¿ç”¨ä¸»çº¿å¼€å‘,Aç å†œæ¯å¤©çš„æäº¤ä¸ä¼šå¯¹ä»–ä»¬é€ æˆä»»ä½•å½±å“.æµ‹è¯•é€šè¿‡åå†å°†åŠŸèƒ½åˆ†æ”¯æäº¤åˆ°ä¸»çº¿.</p></blockquote><h4 id="åˆ›å»ºåˆ†æ”¯"><a href="#åˆ›å»ºåˆ†æ”¯" class="headerlink" title="åˆ›å»ºåˆ†æ”¯"></a>åˆ›å»ºåˆ†æ”¯</h4><blockquote><p>ä¸€ä¸ª<code>Git</code>ä»“åº“å¯ä»¥ç»´æŠ¤å¤šä¸ªå¼€å‘åˆ†æ”¯,ç°åœ¨åˆ›å»ºåˆ†æ”¯</p></blockquote><pre><code class="bash">`$ git branch my_branch`</code></pre><blockquote><p>è¿è¡Œ<code>git branch</code>æŸ¥çœ‹å½“å‰åˆ†æ”¯åˆ—è¡¨,ä»¥åŠç›®å‰å¼€å‘ç¯å¢ƒå¤„åœ¨å“ªä¸ªåˆ†æ”¯ä¸Š:</p></blockquote><pre><code class="bash">45125@DESKTOP-I0F25I8 MINGW64 /d/Git (master)$ git branch* master  my_branch</code></pre><h4 id="åˆ‡æ¢åˆ†æ”¯"><a href="#åˆ‡æ¢åˆ†æ”¯" class="headerlink" title="åˆ‡æ¢åˆ†æ”¯"></a>åˆ‡æ¢åˆ†æ”¯</h4><blockquote><p><code>my_branch</code>æ˜¯åˆšåˆšåˆ›å»ºçš„åˆ†æ”¯,<code>master</code>æ˜¯<code>Git</code>ç³»ç»Ÿé»˜è®¤åˆ›å»ºçš„ä¸»åˆ†æ”¯,<code>*</code>æ ‡è¯†å½“å‰å·¥ä½œåœ¨å“ªä¸ªåˆ†æ”¯ä¸‹,è¾“å…¥<code>git checkout åˆ†æ”¯å</code> å¯ä»¥åˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯</p></blockquote><pre><code class="bash">45125@DESKTOP-I0F25I8 MINGW64 /d/Git (master)$ git checkout my_branchSwitched to branch &#39;my_branch&#39;# åˆ‡æ¢æˆåŠŸ45125@DESKTOP-I0F25I8 MINGW64 /d/Git (my_branch)$</code></pre><blockquote><p>åˆ‡æ¢åˆ°<code>my_branch</code>åˆ†æ”¯å,ç¼–è¾‘æ–‡ä»¶,å†æäº¤(commit)æ”¹åŠ¨,æœ€ååˆ‡æ¢å›<code>master</code>åˆ†æ”¯</p></blockquote><pre><code class="bash"># ä¿®æ”¹æ–‡ä»¶$ echo &#39;hello git&#39; &gt; file1.txt# æŸ¥çœ‹å½“å‰çŠ¶æ€$ git statusOn branch my_branch# æ·»åŠ å¹¶æäº¤file.textçš„ä¿®æ”¹$ git add file1.txt$ git commit -m &quot;update file1.text&quot;# æŸ¥çœ‹file1.textçš„å†…å®¹$ cat file1.txthello git# åˆ‡æ¢åˆ†æ”¯$ git checkout masterSwitched to branch &#39;master&#39;A       file1.txt45125@DESKTOP-I0F25I8 MINGW64 /d/Git (master)$</code></pre><blockquote><p>è¿™æ—¶æŸ¥çœ‹<code>file1.text</code>çš„å†…å®¹,å·²ç»çœ‹ä¸åˆ°åœ¨<code>my_branch</code>åˆ†æ”¯ä¸‹åšçš„æ”¹åŠ¨.</p></blockquote><h4 id="åˆå¹¶åˆ†æ”¯"><a href="#åˆå¹¶åˆ†æ”¯" class="headerlink" title="åˆå¹¶åˆ†æ”¯"></a>åˆå¹¶åˆ†æ”¯</h4><blockquote><p>åœ¨<code>master</code>ä¸»åˆ†æ”¯ä¸‹å†åšä¸€äº›ä¸åŒçš„ä¿®æ”¹,ç„¶åä½¿ç”¨<code>merge</code>å°†<code>my_branch</code>åˆ†æ”¯åˆå¹¶åˆ°<code>master</code>ä¸»åˆ†æ”¯:</p></blockquote><pre><code class="bash"># åˆ‡æ¢åˆ°ä¸»åˆ†æ”¯$ git checkout master# å°†`my_branch`åˆå¹¶åˆ°`master`,&#39;-m&#39;ä»ç„¶ä¸ºæ³¨é‡Š$ git merge -m &#39;merge my_branch branch&#39; my_branch# æäº¤$ git add .$ git commit</code></pre><blockquote><p>å½“<code>master</code>ä¸»åˆ†æ”¯å’Œ<code>my_branch</code>åˆ†æ”¯åŒæ—¶æ›´æ”¹äº†<code>hello.text</code>æ–‡ä»¶,åˆå¹¶æ˜¾ç„¶ä¼šæŠ¥é”™</p></blockquote><pre><code class="bash">$ git merge &quot;merge my_branch&quot; my_branchmerge: merge my_branch - not something we can merge</code></pre><blockquote><p>æç¤ºå¦‚ä¸‹:</p></blockquote><pre><code class="bash">45125@DESKTOP-I0F25I8 MINGW64 /d/Git(master)$ git merge &quot;merge my_branch&quot; my_branchAuto-merging hello.txtCONFLICT (content): Merge conflict in hello.txt -----æç¤ºåˆå¹¶å†²çªAutomatic merge failed; fix conflicts and then commit the result. --è§£å†³å†²çªå¹¶æäº¤</code></pre><blockquote><p>æ­¤æ—¶ç”¨æˆ·æ˜¾ç¤ºä¸º<code>master|MERGING</code>:</p></blockquote><pre><code class="bash">45125@DESKTOP-I0F25I8 MINGW64 /d/Git (master|MERGING)$</code></pre><blockquote><p>éœ€è¦æ‰‹åŠ¨åˆå¹¶å†²çªæ–‡ä»¶,å¹¶æ·»åŠ åˆ°ç¼“å­˜<code>add</code>,ç„¶åæäº¤<code>commit</code>æ‰èƒ½ç»§ç»­åç»­æ‰§è¡Œæ“ä½œ.</p></blockquote><h4 id="åˆ é™¤åˆ†æ”¯"><a href="#åˆ é™¤åˆ†æ”¯" class="headerlink" title="åˆ é™¤åˆ†æ”¯"></a>åˆ é™¤åˆ†æ”¯</h4><blockquote><p>å½“åˆå¹¶å®Œæˆå,ä¸å†éœ€è¦åˆ†æ”¯<code>my_branch</code>,å°±å¯ä»¥åˆ é™¤åˆ†æ”¯:</p></blockquote><pre><code class="bash">45125@DESKTOP-I0F25I8 MINGW64 /d/Git_new (master)$ git branch -d my_branchDeleted branch my_branch (was 4be8b88).</code></pre><blockquote><p>éœ€æ³¨æ„ <code>git branch -d</code> åªèƒ½åˆ é™¤å·²ç»åˆ«åˆå¹¶çš„åˆ†æ”¯,è‹¥è¦å¼ºåˆ¶åˆ é™¤æŸä¸ªåˆ†æ”¯,ä½¿ç”¨<code>git branch -D</code></p></blockquote><h4 id="æ’¤é”€ä¸€ä¸ªåˆå¹¶"><a href="#æ’¤é”€ä¸€ä¸ªåˆå¹¶" class="headerlink" title="æ’¤é”€ä¸€ä¸ªåˆå¹¶"></a>æ’¤é”€ä¸€ä¸ªåˆå¹¶</h4><blockquote><p>å›åˆ°åˆå¹¶ä¹‹å‰çš„çŠ¶æ€</p></blockquote><pre><code class="bash">$ git reset --hard HEAD^</code></pre><p>æŸ¥çœ‹æ–‡ä»¶,å³å¯å‘ç°å›åˆ°åˆå¹¶å‰çŠ¶æ€</p><h4 id="å¿«é€Ÿå‘å‰åˆå¹¶"><a href="#å¿«é€Ÿå‘å‰åˆå¹¶" class="headerlink" title="å¿«é€Ÿå‘å‰åˆå¹¶"></a>å¿«é€Ÿå‘å‰åˆå¹¶</h4><h3 id="Gitæ—¥å¿—"><a href="#Gitæ—¥å¿—" class="headerlink" title="Gitæ—¥å¿—"></a>Gitæ—¥å¿—</h3><h4 id="æŸ¥çœ‹æ—¥å¿—"><a href="#æŸ¥çœ‹æ—¥å¿—" class="headerlink" title="æŸ¥çœ‹æ—¥å¿—"></a>æŸ¥çœ‹æ—¥å¿—</h4><blockquote><p><code>git log</code> å‘½ä»¤æ˜¾ç¤ºæ‰€æœ‰çš„æäº¤<code>commit</code></p></blockquote><pre><code class="bash">$ git log</code></pre><p>å›è½¦é€è¡Œæ˜¾ç¤º,<code>q</code>é€€å‡º</p><p><code>git log</code>é€‰é¡¹å¾ˆå¤š,å¯ä½¿ç”¨<code>git help log</code>æŸ¥çœ‹,ä¾‹:æ‰¾å‡ºæ‰€æœ‰ä»â€™v2.5â€™å¼€å§‹åœ¨fsç›®å½•ä¸‹çš„æ‰€æœ‰Makefileçš„ä¿®æ”¹:</p><pre><code class="bash">$ git log v2.5.. Makefile fs/</code></pre><p><code>Git</code>ä¼šæ ¹æ®<code>git log</code>å‘½ä»¤çš„å‚æ•°,æŒ‰æ—¶é—´é¡ºåºæ˜¾ç¤ºç›¸å…³çš„æäº¤(commit)</p><h4 id="æ—¥å¿—ç»Ÿè®¡"><a href="#æ—¥å¿—ç»Ÿè®¡" class="headerlink" title="æ—¥å¿—ç»Ÿè®¡"></a>æ—¥å¿—ç»Ÿè®¡</h4><blockquote><p>å¦‚æœä½¿ç”¨<code>--stat</code>é€‰é¡¹ä½¿ç”¨<code>git log</code> ä¼šæ‰“å°è¯¦ç»†çš„æäº¤è®°å½•:</p></blockquote><pre><code class="bash">$ git log --stat</code></pre><p>æ­¤å‘½ä»¤ä¼šæ˜¾ç¤ºæ¯ä¸ªæäº¤ä¸­å“ªä¸ªæ–‡ä»¶è¢«ä¿®æ”¹,è¿™äº›æ–‡ä»¶æ·»åŠ æˆ–è€…ä¿®æ”¹äº†å¤šå°‘è¡Œå†…å®¹</p><h4 id="æ ¼å¼åŒ–æ—¥å¿—"><a href="#æ ¼å¼åŒ–æ—¥å¿—" class="headerlink" title="æ ¼å¼åŒ–æ—¥å¿—"></a>æ ¼å¼åŒ–æ—¥å¿—</h4><blockquote><p>æŒ‰è‡ªå·±è¦æ±‚æ ¼å¼åŒ–è¾“å‡ºæ—¥å¿—.<code>--pretty</code> å‚æ•°å®ç°</p></blockquote><pre><code class="bash">$ git log --pretty=oneline# è¾“å‡ºå†…å®¹--------a5a5ade971c5cbb55a81ad6536f68ea3827e3436 merge637423f27ac26924df3f10b3be67e2160c300af1 456d7380bc7f9ebb0686c1e8e905a2398593e0d14aa hehe...$ git log --pretty=short# è¾“å‡ºå†…å®¹--------commit 4be8b88c059d6fd162b2ca7ed5911fc71b9e448aAuthor: zysxm &lt;451253127@qq.com&gt;    hahhah...</code></pre><p>å…¶ä»–å‚æ•°<code>medium</code>,<code>full</code>,<code>fuller</code>,<code>email</code>æˆ–<code>raw</code>.</p><p>è‹¥éƒ½ä¸ç¬¦åˆè‡ªå·±éœ€æ±‚,ä¹Ÿå¯ä½¿ç”¨<code>--pretty=format</code>å‚æ•°å®šä¹‰æ ¼å¼</p><p><code>--graph</code> é€‰é¡¹å¯ä»¥å¯è§†åŒ–æäº¤å›¾(commit graph),ä¼šç”¨ASCIIå­—ç¬¦æ¥ç”»å‡ºä¸€ä¸ªå¾ˆå¾ˆæ¼‚äº®çš„æäº¤å†å²(commit history)çº¿:</p><pre><code class="bash">$ git log --graph --pretty=oneline# è¾“å‡ºå†…å®¹* 1a9d3e56192965adf42c374f9badf8d31d766526 (HEAD -&gt; master) add from master*   37ad7837625ff73d0839c5f15c1d38502fc58662 haha|\| * 4be8b88c059d6fd162b2ca7ed5911fc71b9e448a hahhah* | f432d9841ac64fd7d6e3846a747b5da719547901 modify hello.text* |   3b2b490122c7e4c93c2c691bf3e4bd51d1383239 merge|\ \| |/| * d1abf7b663fc50a08fcd2b2ded20d7ea9685b1ae update text* |   a5a5ade971c5cbb55a81ad6536f68ea3827e3436 merge...</code></pre><h4 id="æ—¥å¿—æ’åº"><a href="#æ—¥å¿—æ’åº" class="headerlink" title="æ—¥å¿—æ’åº"></a>æ—¥å¿—æ’åº</h4><blockquote><p>æ—¥å¿—è®°å½•å¯ä»¥æŒ‰ä¸åŒçš„é¡ºåºæ¥æ˜¾ç¤º,å¯ä»¥æŒ‡å®š<code>--topo-order</code>å‚æ•°,è®©æäº¤æŒ‰æ‹“æ‰‘é¡ºåºæ¥æ˜¾ç¤º(å°±æ˜¯å­æäº¤åœ¨ä»–ä»¬çš„çˆ¶æäº¤å‰æ˜¾ç¤º):</p></blockquote><pre><code class="bash">git log --pretty=format:&#39;%h : %s&#39; --topo-order --graph</code></pre><p><code>--reverse</code>å‚æ•°é€†å‘æ˜¾ç¤ºæ‰€æœ‰æäº¤æ—¥å¿—</p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ul><li>git config: é…ç½®ç›¸å…³ä¿¡æ¯</li><li>git clone: å¤åˆ¶ä»“åº“</li><li>git init: åˆå§‹åŒ–ä»“åº“</li><li>git add: æ·»åŠ æ›´æ–°å†…å®¹åˆ°ç´¢å¼•ä¸­</li><li>git diff: æ¯”è¾ƒå†…å®¹</li><li>git status: è·å–å½“å‰é¡¹ç›®çŠ¶æ€</li><li>git commit: æäº¤</li><li>git branch: åˆ†æ”¯ç›¸å…³</li><li>git checkout: åˆ‡æ¢åˆ†æ”¯</li><li>git merge: åˆå¹¶åˆ†æ”¯</li><li>git reset: æ¢å¤ç‰ˆæœ¬</li><li>git log: æŸ¥çœ‹æ—¥å¿—</li></ul><!-- <meta http-equiv="refresh" content="2"> -->]]></content>
    
    
    
    <tags>
      
      <tag>Git</tag>
      
      <tag>æ•™ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äººäººç¾å‰§å½±è§†åº“çˆ¬è™«</title>
    <link href="undefined2018/07/31/2018-07-30-%E4%BA%BA%E4%BA%BA%E7%BE%8E%E5%89%A7%E5%BD%B1%E8%A7%86%E5%BA%93%E7%88%AC%E8%99%AB/"/>
    <url>2018/07/31/2018-07-30-%E4%BA%BA%E4%BA%BA%E7%BE%8E%E5%89%A7%E5%BD%B1%E8%A7%86%E5%BA%93%E7%88%AC%E8%99%AB/</url>
    
    <content type="html"><![CDATA[<h2 id="å­—å¹•ç»„å½±è§†åº“"><a href="#å­—å¹•ç»„å½±è§†åº“" class="headerlink" title="å­—å¹•ç»„å½±è§†åº“"></a>å­—å¹•ç»„å½±è§†åº“</h2><a id="more"></a><pre><code class="python">from urllib.request import Request,urlopenfrom lxml import etreeimport xlwtclass Zimuzu(object):    def __init__(self):        self.base_url = &#39;http://www.zimuzu.io/resourcelist&#39;        self.headers = {            &#39;User-Agent&#39;:&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#39;        }        self.workBook = None        self.sheet = None        self.record = 1    def spider(self):        self.create_workBook()        self.get_data_with_url(self.base_url)        self.workBook.save(&#39;äººäººå½±è§†åº“.xls&#39;)    def get_data_with_url(self,url):        request = Request(url,headers=self.headers)        response = urlopen(request).read()        code = etree.HTML(response)        items = code.xpath(&#39;//div[@class=&quot;resource-showlist has-point&quot;]/ul/li[@class=&quot;clearfix&quot;]&#39;)        print(items)        for item in items:            point = item.xpath(&#39;.//span[@class=&quot;point&quot;]//text()&#39;)            if len(point) == 2:                point = point[0] + point [1]            point = &#39;&#39;            type = item.xpath(&#39;.//h3[@class=&quot;f14&quot;]/a/strong/text()&#39;)            if len(type) == 0:                type = &#39;&#39;            type = type[0]            name = item.xpath(&#39;.//h3[@class=&quot;f14&quot;]/a/text()&#39;)[0]            num = item.xpath(&#39;.//h3[@class=&quot;f14&quot;]/font[@class=&quot;f4&quot;]/text()&#39;)            if len(num)==0:                num = &#39;&#39;            num = num[0]            try:                self.sheet.write(self.record,0,point)                self.sheet.write(self.record,1,type)                self.sheet.write(self.record,2,name)                self.sheet.write(self.record,3,num)            except Exception as e:                print(&#39;å†™å…¥å¤±è´¥&#39;,e)            finally:                self.record += 1        self.next_page_with_code(code)    def next_page_with_code(self,code):        next_page = code.xpath(&#39;//div[@class=&quot;pages&quot;]/div/a[last()-1]/@href&#39;)        print(next_page)        if len(next_page) == 0:            print(&#39;è·å–å®Œæ¯•&#39;)            return        self.get_data_with_url(&#39;http://www.zimuzu.io&#39;+ next_page[0])    def create_workBook(self):        self.workBook = xlwt.Workbook(encoding=&#39;utf-8&#39;)        self.sheet = self.workBook.add_sheet(&#39;movies&#39;)        self.sheet.write(0,0,&#39;å½±è§†è¯„åˆ†&#39;)        self.sheet.write(0,1,&#39;å½±è§†ç±»å‹&#39;)        self.sheet.write(0,2,&#39;å½±è§†åç§°&#39;)        self.sheet.write(0,3,&#39;æ›´æ–°è¿›åº¦&#39;)zimuzu = Zimuzu()zimuzu.spider()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>seleniumç¯å¢ƒé…ç½®åŠä½¿ç”¨</title>
    <link href="undefined2018/07/31/2018-07-30-selenium%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
    <url>2018/07/31/2018-07-30-selenium%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h2 id="seleniumçš„ç‰¹ç‚¹"><a href="#seleniumçš„ç‰¹ç‚¹" class="headerlink" title="seleniumçš„ç‰¹ç‚¹:"></a>seleniumçš„ç‰¹ç‚¹:</h2><ul><li>ç”±ç¨‹åºæ§åˆ¶æµè§ˆå™¨è¿›è¡Œæ“ä½œ,è€Œä¸æ˜¯æ‰‹åŠ¨æ“ä½œæµè§ˆå™¨</li><li>ç¨‹åºæ§åˆ¶æµè§ˆå™¨è¿›è¡Œæ“ä½œçš„æ—¶å€™,é€Ÿåº¦éå¸¸æ…¢,æ‰€ä»¥è¦è°¨æ…ä½¿ç”¨selenium</li><li>ä½¿ç”¨seleniumæ§åˆ¶æµè§ˆå™¨çš„æ—¶å€™,éœ€è¦ä¸‹è½½æµè§ˆå™¨å¯¹åº”çš„é©±åŠ¨ç¨‹åº</li><li>seleniumä¸ºå¼€æº,å…è´¹,ä½†æ˜¯æ›´æ–°é€Ÿåº¦æ²¡æœ‰æµè§ˆå™¨å¿«,ä¸æ˜¯selenium<br> æ›´æ–°æ…¢,è€Œæ˜¯æµè§ˆå™¨æ˜¯æ›´æ–°å¿«,æ³¨æ„seleniumå’Œæµè§ˆå™¨å¯¹åº”å…³ç³»</li></ul><a id="more"></a><h2 id="ä½¿ç”¨seleniumä¹‹å‰è¿›è¡Œç¯å¢ƒé…ç½®"><a href="#ä½¿ç”¨seleniumä¹‹å‰è¿›è¡Œç¯å¢ƒé…ç½®" class="headerlink" title="ä½¿ç”¨seleniumä¹‹å‰è¿›è¡Œç¯å¢ƒé…ç½®"></a>ä½¿ç”¨seleniumä¹‹å‰è¿›è¡Œç¯å¢ƒé…ç½®</h2><ol><li><p>ä¸‹è½½<code>chromedriver</code>å’Œ<code>geckodriver</code></p><ul><li><p><a href="http://npm.taobao.org/mirrors/chromedriver/" target="_blank" rel="noopener" title="æ·˜å®é•œåƒæº">chromedriver</a></p><blockquote><p>é€‰æ‹©é€‚åˆç‰ˆæœ¬ä¸‹è½½ é™„<a href="https://download.mozilla.org/?product=firefox-58.0&os=win&lang=zh-CN" target="_blank" rel="noopener" title="ç‚¹å‡»ä¸‹è½½">FireFox_58_ç®€ä¸­ç‰ˆ</a><br><img src="/assets/img/Pictures/chromedriver.png" srcset="/img/loading.gif" alt="" title="æ•ˆæœ"></p></blockquote></li><li><p><a href="https://github.com/mozilla/geckodriver/releases" target="_blank" rel="noopener" title="GitHubåœ°å€">geckodriver/releases</a></p><blockquote><p>é€‰æ‹©å¯¹åº”å¹³å°ä¸‹è½½<br><img src="/assets/img/Pictures/geckodriver1.png" srcset="/img/loading.gif" alt="" title="æ•ˆæœ"><br><img src="/assets/img/Pictures/geckodriver2.png" srcset="/img/loading.gif" alt="" title="æ•ˆæœ"></p></blockquote></li></ul></li><li><p>å°†ä¸‹è½½å¥½çš„<code>chromedriver.exe</code>å’Œ<code>geckodriver.exe</code>è§£å‹åæ”¾åˆ°<code>Anoconda</code>çš„å®‰è£…ç›®å½•ä¸­æˆ–è€…Pythonå®‰è£…ç›®å½•ä¸­,ä½ç½®å¦‚ä¸‹:</p></li></ol><blockquote><p><code>D:\Python\Anaconda\Scripts</code></p></blockquote><ol start="3"><li><p>é‡å¯Pycharm ç­‰å¾…åŠ è½½å®Œæˆ</p></li><li><p><code>terminal</code>æˆ–è€…<code>cmd</code>å®‰è£…<code>selenium</code></p></li></ol><blockquote><p><code>pip install selenium</code></p></blockquote><ol start="5"><li><p>åœ¨Pycharmä¸­å¼•å…¥ç½‘é¡µé©±åŠ¨å¹¶æ‰§è¡Œ</p><pre><code class="python"> # å¼•å…¥ç½‘é¡µé©±åŠ¨ from selenium import webdriver import time # ä½¿ç”¨ç½‘é¡µé©±åŠ¨æ¥è¿è¡Œgoogle/firefoxæµè§ˆå™¨ driver = webdriver.Chrome() # é€šè¿‡é©±åŠ¨æ¥æ‰§è¡ŒæŒ‡å®šçš„ç½‘é¡µ driver.get(&#39;http://www.baidu.com&#39;) # selenium.common.exceptions.NoSuchElementException: Message: Unable to locate element: [id=&quot;kw&quot;] # é”™è¯¯åŸå› :ä»£ç æ‰§è¡Œé€Ÿåº¦å¾ˆå¿«,ä½†æ˜¯æµè§ˆå™¨å“åº”å¾ˆæ…¢, # ä»£ç æ‰§è¡Œåˆ°è¿™çš„æ—¶å€™ æµè§ˆå™¨é‡Œé¢çš„å…ƒç´ å¯èƒ½è¿˜æ²¡æœ‰åŠ è½½å®Œ # æ‰€ä»¥æŠ¥é”™æ‰¾ä¸åˆ°å…ƒç´  # time.sleep(3) # é€šè¿‡idæŸ¥æ‰¾ driver.find_element_by_id(&#39;kw&#39;).send_keys(&#39;selenium&#39;) # é€šè¿‡nameæŸ¥æ‰¾ å±æ€§ driver.find_element_by_name(&#39;wd&#39;).send_keys(&#39;csdn&#39;) # Unicode è‹¥åé¢æœ‰ä¸­æ–‡ é‚£ä¹ˆå‰é¢éœ€è¦åŠ ä¸€ä¸ªu   r:ç¦æ­¢è½¬ä¹‰ driver.find_element_by_class_name(&#39;s_ipt&#39;).send_keys(u&#39;æ™ºæ¸¸&#39;) # tag_name driver.find_element_by_tag_name(&#39;input&#39;).send_keys(&#39;...&#39;) # å‰ç«¯ html css js # selector é€‰æ‹©å™¨ driver.find_element_by_css_selector(&#39;#kw&#39;).send_keys(&#39;...&#39;) # é€šè¿‡xpathè¯­æ³•å®šä½ä¸€ä¸ªå…ƒç´  driver.find_element_by_xpath(&#39;//form[@id=&quot;form&quot;]/span/input[@id=&quot;kw&quot;]&#39;).send_keys(&#39;123&#39;) #link é“¾æ¥ driver.find_element_by_link_text(&#39;è´´å§&#39;) time.sleep(5) driver.close()</code></pre></li><li><p>seleniumè¿›é˜¶</p><ul><li>æŒ‰é”®æ“ä½œ</li></ul><pre><code class="python"># commom å…±åŒçš„;å…¬å…±çš„# keys é”®from selenium.webdriver.common.keys import Keysfrom selenium import webdriverimport timedriver = webdriver.Chrome()driver.get(&#39;http://www.baidu.com&#39;)time.sleep(3)# æ‰¾åˆ°è¾“å…¥æ¡† è¾“å…¥æŒ‡å®šå†…å®¹driver.find_element_by_id(&#39;kw&#39;).send_keys(&#39;selenium&#39;)time.sleep(3)# å…¨é€‰è¾“å…¥æ¡†å†…çš„å…¨éƒ¨å†…å®¹driver.find_element_by_id(&#39;kw&#39;).send_keys(Keys.CONTROL,&#39;a&#39;)time.sleep(3)driver.find_element_by_id(&#39;kw&#39;).send_keys(Keys.CONTROL,&#39;x&#39;)time.sleep(3)driver.find_element_by_id(&#39;kw&#39;).send_keys(u&#39;çˆ¬è™«æŠ€å·§&#39;)time.sleep(3)driver.find_element_by_id(&#39;su&#39;).click()time.sleep(5)# é€€å‡ºæµè§ˆå™¨driver.quit()</code></pre><ul><li>æ—¶é—´ç­‰å¾…</li></ul><pre><code class="python"># selenium ç”±ç½‘é¡µé©±åŠ¨é©±ä½¿æµè§ˆå™¨è¿›è¡Œæ“ä½œ,é€Ÿåº¦æ…¢æ—¶ä¸€å¤§ç‰¹ç‚¹# ç»å¸¸ä¼šå‡ºç°ä»£ç æ‰§è¡Œå®Œäº† ä½†æ˜¯ç½‘é¡µå†…å®¹è¿˜æ²¡æœ‰åŠ è½½å®Œæ¯•# é‡Œé¢çš„æ ‡ç­¾è¿˜æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ å¦‚æœè¿™æ—¶å€™æ“ä½œé‡Œé¢çš„æ ‡ç­¾# å°±ä¼šçˆ†å‡ºå¼‚å¸¸ NoSuchElementExpection# è§£å†³çš„åŠæ³•:æ—¶é—´ä¼‘çœ  time.sleep()# ä¸ç®¡é¡µé¢çš„å†…å®¹æœ‰æ²¡æœ‰åŠ è½½å®Œæ¯• ä¸€å®šè¦ä¼‘çœ æŒ‡å®šç§’æ•°from selenium.webdriver.support.ui import WebDriverWaitfrom selenium import webdriverdriver = webdriver.Chrome()driver.get(&#39;http://www.baidu.com&#39;)# driver.find_element_by_id(&#39;kw&#39;).send_keys(&#39;hello world&#39;)button = driver.find_element_by_id(&#39;su&#39;)# WebDriverWait ç½‘é¡µç­‰å¾…# å€¼1: ç­‰å¾…çš„å¯¹è±¡# å€¼2: ç­‰å¾…çš„æ—¶é—´# WebDriverWaitç»å¸¸å’Œuntil not ä¸€èµ·ä½¿ç”¨ until: ç›´åˆ°...# lambda åŒ¿åå‡½æ•° is_displayed æ˜¯å¦å·²ç»æ˜¾ç¤ºis_visible = WebDriverWait(driver , 10).until(lambda driver: button.is_displayed())print(is_visible)button.click()# WebDriverWait() å’Œ time.sleep()# 1.éƒ½æ˜¯è®©ç¨‹åºç­‰å¾…æŒ‡å®šæ—¶é—´# 2.timeçš„æ—¶é—´æ˜¯å›ºå®šçš„ æ—¶é—´é•¿çŸ­ä¸ä¼šéšæ ‡ç­¾çš„åŠ è½½é€Ÿåº¦è€Œæ”¹å˜  # WebDriverWaitæ—¶é—´æ˜¯ä¸å›ºå®šçš„ ç­‰åœ°å•Šå¤šå°‘æ—¶é—´è¦çœ‹æ ‡ç­¾çš„åŠ è½½æ—¶é—´  # å’ŒæŒ‡å®šçš„å›ºå®šçš„æ—¶é—´# 3.å¦‚æœåœ¨æŒ‡å®šçš„æ—¶é—´å†…,æ ‡ç­¾ä»ç„¶æ²¡æœ‰åŠ è½½å‡ºæ¥,é‚£ä¹ˆäºŒè€…éƒ½ä¼šçˆ†å‡ºå¼‚å¸¸# éšæ€§æ—¶é—´ implicility_wait</code></pre><ul><li>ç‚¹å‡»äº‹ä»¶</li></ul><pre><code class="python">from selenium import webdriver# action è¡ŒåŠ¨ chains é“¾from selenium.webdriver.common.action_chains import ActionChainsfrom selenium.webdriver.support.ui import WebDriverWaitimport timedriver = webdriver.Chrome()driver.get(&#39;http://www.baidu.com&#39;)# driver.find_element_by_class_name(&#39;index-logo-src&#39;)logo = driver.find_element_by_css_selector(&#39;#lg &gt; img&#39;)logo = driver.find_element_by_xpath(&#39;//div[@id=&quot;lg&quot;]/img[@class=&quot;index-logo-src&quot;]&#39;)# åŒå‡»äº‹ä»¶ActionChains(driver).double_click(logo).perform()# context ä¸Šä¸‹æ–‡# content å†…å®¹# context_click å³å‡»# å³é”®ç‚¹å‡»# WebDriverWait(driver,10).until(lambda driver : logo.is_displayed())# action = ActionChains(driver).context_click(logo)# æ“ä½œäº‹ä»¶ä¼šè·‘åˆ°performé˜Ÿåˆ—é‡Œé¢ performå®ç°# action.perform()# time.sleep(5)# more = driver.find_element_by_class_name(&#39;bri&#39;)# # é¼ æ ‡ç§»åŠ¨# WebDriverWait(driver,10).until(lambda driver: more.is_displayed())# action = ActionChains(driver).move_to_element(more).perform()</code></pre><ul><li>æ ‡ç­¾é€‰æ‹©</li></ul><pre><code class="python">from selenium import webdriverfrom selenium.webdriver.common.by import Byimport os,timedriver = webdriver.Chrome()driver.get(&#39;file:///&#39; + os.path.abspath(&#39;4.index.html&#39;))# åŒè¿‡æ ‡ç­¾åå­—æ‰¾åˆ°æŒ‡å®šæ ‡ç­¾# btns = driver.find_elements_by_tag_name(&#39;button&#39;)# print(btns)# é€šè¿‡ç´¢å¼•æ‰¾åˆ°æŒ‡å®šæ ‡ç­¾# btns[1].click()# for btn in btns:#     # é€šè¿‡å±æ€§æ‰¾åˆ°æŒ‡å®šæ ‡ç­¾#     if btn.get_attribute(&#39;type&#39;) == &#39;button&#39;:#         btn.click()  # time.sleep(3)  # btn.click()# btn = driver.find_element_by_tag_name(&#39;button&#39;).click()# find_element_by_XXé€šè¿‡XXæ¥æ‰¾åˆ°æ‰€æœ‰æ ‡ç­¾ä¸­çš„ç¬¬ä¸€ä¸ªæ ‡ç­¾# find_elements_by_XXé€šè¿‡XXæ¥æ‰¾åˆ°æ‰€æœ‰ç¬¦åˆçš„æ ‡ç­¾# å¼¹å‡ºæŒ‡å®šçš„å…ƒç´  å¦‚æœä¸å†™ç´¢å¼• é»˜è®¤ä¸ºæœ€åä¸€ä¸ª# driver.find_elements_by_css_selector(&#39;button&#39;).pop(3).click()# [type=button] []é‡Œé¢ä¸ºé™åˆ¶æ¡ä»¶ é™åˆ¶é€‰æ‹©çš„å†…å®¹driver.find_elements_by_css_selector(&#39;button[type=button]&#39;).pop().click()# é€šè¿‡...æ¥æ‰¾åˆ°æŒ‡å®šçš„æ ‡ç­¾ ID,TAG,CLASS...driver.find_element(by=By.ID,value=&#39;pink&#39;).click()time.sleep(10)driver.quit()</code></pre><ul><li>windowåˆ‡æ¢</li></ul><pre><code class="python">from selenium import webdriverfrom selenium.webdriver.support.ui import WebDriverWaitimport timedriver = webdriver.Chrome()driver.get(&#39;http://www.baidu.com&#39;)# è·å–å½“å‰çš„windowå¯¹è±¡current_window = driver.current_window_handle# è·å–å½“å‰çª—å£ç¼–å·å’Œç½‘é¡µæ ‡é¢˜print(current_window,driver.title)driver.find_element_by_name(&#39;tj_trnews&#39;).click()news = WebDriverWait(driver,10).until(lambda driver:driver.find_element_by_css_selector(&#39;.hdline0 .a3&#39;))news.click()# è·å–æ‰€æœ‰çš„çª—å£all_windows = driver.window_handlesprint(all_windows)for window in all_windows:  if window != current_window:      # switch åˆ‡æ¢ to åˆ°      driver.switch_to.window(window)# title = driver.find_element_by_tag_name(&#39;h1&#39;)time.sleep(2)title = driver.find_element_by_css_selector(&#39;.text_title h1&#39;).text# WebDriverWait(driver,10).until(lambda driver: title.is_displayed())print(title)time.sleep(3)# å…³é—­çª—å£driver.close()driver.switch_to.window(current_window)time.sleep(2)print(driver.find_element_by_css_selector(&#39;#footer span&#39;).text)</code></pre></li></ol><pre><code># å…³é—­æµè§ˆå™¨# driver.quit()```* frameåˆ‡æ¢```pythonfrom selenium import webdriverimport osdriver = webdriver.Chrome()driver.get(&#39;file:///&#39; + os.path.abspath(&#39;6.outframe.html&#39;))# frameåˆ‡æ¢driver.switch_to.frame(driver.find_element_by_id(&#39;out&#39;))driver.switch_to.frame(&#39;in&#39;)driver.find_element_by_id(&#39;kw&#39;).send_keys(&#39;selenium&#39;)driver.find_element_by_id(&#39;su&#39;).click()```</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¥‡ä¹¦ç½‘</title>
    <link href="undefined2018/07/30/2018-07-30-%E5%A5%87%E4%B9%A6%E7%BD%91/"/>
    <url>2018/07/30/2018-07-30-%E5%A5%87%E4%B9%A6%E7%BD%91/</url>
    
    <content type="html"><![CDATA[<p>å¥‡ä¹¦ç½‘å°è¯´çˆ¬å–</p><blockquote><p>ä½œä¸šï¼šå¥‡ä¹¦ç½‘ ï¼Œç„å¹»å¥‡å¹»ç±»å°è¯´<br>å°†å°è¯´åï¼Œç‚¹å‡»æ¬¡æ•°ï¼Œæ–‡ä»¶å¤§å°ï¼Œä¹¦ç±ç±»å‹ã€‚æ›´æ–°æ—¥æœŸï¼Œè¿è½½çŠ¶æ€ã€‚<br>ä¹¦ç±ä½œè€…ï¼Œå°è¯´ç®€ä»‹ï¼Œä¸‹è½½åœ°å€å­˜å‚¨åˆ°excelé‡Œé¢,</p><blockquote><p>å®é™…è·å–ä¸­é‡åˆ°ä¸€äº›å‘ ç»å¸¸è·å–ä¸åˆ°åº•éƒ¨é¡µé¢å¯¼èˆª<br>è§£å†³:é‡‡ç”¨é‡ä¼ urlè·å–æœ¬é¡µå†…å®¹</p></blockquote></blockquote><a id="more"></a><pre><code class="python">import xlwtfrom urllib.request import urlopen,Requestfrom bs4 import BeautifulSoupclass Qishu(object):    def __init__(self):        self.base_url = &#39;https://www.qisuu.la/soft/sort01/index_1.html&#39;        self.headers = {            &#39;User-Agent&#39;:&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#39;        }        self.workBook = None        self.sheet = None        self.record = 1    # ä¸»çˆ¬è™«ç¨‹åº    def spider(self):        self.create_workBook()        self.get_data_with_url(self.base_url)        # åˆ›å»ºexcleå·¥ä½œç°¿        self.workBook.save(&#39;å¥‡ä¹¦å°è¯´.xls&#39;)    # è¯·æ±‚urlè·å–ä¿¡æ¯    def get_data_with_url(self,url):        print(&#39;æ­£åœ¨è·å–:{} ...&#39;.format(url))        # è¯·æ±‚url        request = Request(url, headers=self.headers)        try:            response = urlopen(request).read()        except Exception as e:            print(&#39;è¯·æ±‚æœ¬é¡µå¤±è´¥&#39;,e)            print(&#39;é‡æ–°è·å–æœ¬é¡µ:{}...&#39;.format(url))            self.get_data_with_url(url)        # print(response)        soup = BeautifulSoup(response,&#39;lxml&#39;)        # åˆ†æ”¯è¯­å¥åˆ¤æ–­èƒ½å¦è·å–æœ¬é¡µtspage,è·å–ä¸åˆ°æ—¶        # é‡æ–°è·å–        tspage = soup.select(&#39;.tspage a&#39;)        if len(tspage) == 0:            print(&#39;é‡æ–°è·å–æœ¬é¡µ:{}&#39;.format(url))            self.get_data_with_url(url)        else:            # è·å–ä¸€é¡µä¸­çš„æ‰€æœ‰å°è¯´æ¡ç›®            items = soup.select(&#39;.listBox ul li&#39;)            for item in items:                # findè·å–æ¯ä¸ªæ¡ç›®ä¸­çš„ç¬¬ä¸€ä¸ªurlé“¾æ¥å³å°è¯´è¯¦æƒ…                url = item.find(&#39;a&#39;).get(&#39;href&#39;)                # print(url)                # è·å–è¯¦æƒ…é¡µä¿¡æ¯-----------------------------------------                self.get_sub_data_with_url(&#39;https://www.qisuu.la&#39; + url)            # è·å–ä¸‹ä¸€é¡µurl            try:                tspage = soup.select(&#39;.tspage a&#39;)                if tspage[-2].get_text() != &#39;ä¸‹ä¸€é¡µ&#39; :                    print(&#39;æ²¡æœ‰ä¸‹ä¸€é¡µäº†,äº²...&#39;)                    return                next_page = tspage[-2].get(&#39;href&#39;)                page_url = &#39;https://www.qisuu.la&#39;+next_page                # print(page_url)                # ä¼ é€’ä¸‹ä¸€é¡µurl å›è°ƒå‡½æ•°                self.get_data_with_url(page_url)            except Exception as e:                print(&#39;è·å–å¤±è´¥:&#39;,e)    # è¯¦æƒ…é¡µ    def get_sub_data_with_url(self,url):        request = Request(url, headers=self.headers)        response = urlopen(request).read()        # print(response.decode())        soup = BeautifulSoup(response, &#39;lxml&#39;)        # è·å–æŒ‡å®šä¿¡æ¯        name = soup.select(&#39;.detail_right h1&#39;)[0].get_text()        infos = soup.select(&#39;.detail_right ul .small&#39;)        list = [name]        for index in range(0,6):            # å–æ–‡æœ¬å¹¶å¤„ç†æ•°æ®            option = infos[index].get_text().split(&#39;ï¼š&#39;)[1]            list.append(option)        show = soup.select(&#39;.showInfo p&#39;)[0].get_text()        url = soup.select(&#39;.showDown ul li script&#39;)[0].get_text().split(&quot;&#39;&quot;)[3]        list.append(show)        list.append(url)        # å†™å…¥excelè¡¨        for index,option in enumerate(list):            self.sheet.write(self.record,index,option)        # record æ§åˆ¶æ’å…¥ä½ç½®        self.record += 1    # åˆ›å»ºexcelå·¥ä½œç°¿    def create_workBook(self):        self.workBook = xlwt.Workbook(encoding=&#39;utf-8&#39;)        self.sheet = self.workBook.add_sheet(&#39;å°è¯´&#39;)        # æ’å…¥å¤´ä¿¡æ¯        for index,option in enumerate([&#39;å°è¯´åç§°&#39;,&#39;ç‚¹å‡»æ¬¡æ•°&#39;,&#39;æ–‡ä»¶å¤§å°&#39;,&#39;ä¹¦ç±ç±»å‹&#39;,&#39;æ›´æ–°æ—¥æœŸ&#39;,&#39;è¿è½½çŠ¶æ€&#39;,&#39;ä¹¦ç±ä½œè€…&#39;,&#39;å°è¯´ç®€ä»‹&#39;,&#39;ä¸‹è½½åœ°å€&#39;]):            self.sheet.write(0,index,option)# å®ä¾‹åŒ–å¯¹è±¡qishu = Qishu()qishu.spider()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xpath,bs4,æ­£åˆ™,æ•°æ®è¯·æ±‚æ–¹å¼</title>
    <link href="undefined2018/07/28/2018-07-27-xpath,bs4,%E6%AD%A3%E5%88%99,%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F/"/>
    <url>2018/07/28/2018-07-27-xpath,bs4,%E6%AD%A3%E5%88%99,%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h3 id="å¼•ç”¨æ¨¡å—"><a href="#å¼•ç”¨æ¨¡å—" class="headerlink" title="å¼•ç”¨æ¨¡å—"></a>å¼•ç”¨æ¨¡å—</h3><pre><code class="python"># xpathfrom lxml import etree# bs4from bs4 import BeautifulSoup# æ­£åˆ™import re# æ•°æ®è¯·æ±‚from urllib.request import urlopen,Requestimport requests</code></pre><a id="more"></a><h3 id="xpathå’Œbs4å’Œæ­£åˆ™çš„åŒºåˆ«"><a href="#xpathå’Œbs4å’Œæ­£åˆ™çš„åŒºåˆ«" class="headerlink" title="xpathå’Œbs4å’Œæ­£åˆ™çš„åŒºåˆ«"></a>xpathå’Œbs4å’Œæ­£åˆ™çš„åŒºåˆ«</h3><pre><code class="python"># ---------------------------xpathå’Œbs4å’Œæ­£åˆ™çš„åŒºåˆ«--------------------------                # æ€»ç»“:                # xpathä¸bs4zæŸ¥æ‰¾æ ‡ç­¾çš„æ–¹å¼ä¸åŒ è§33,42                # xpathå’Œbs4éƒ½å…·æœ‰getæ–¹æ³•ç”¨äºå–å±æ€§çš„å€¼ å…¶ä¸­xpathä¹Ÿå¯ç”¨ @+å±æ€§å æ¥å–å±æ€§å€¼                # xpathä½¿ç”¨text()å–æ–‡æœ¬  BeautifulSoupä½¿ç”¨get_text()å–æ–‡æœ¬                # æ­£åˆ™ç›´æ¥æ­£é¢åˆš# ä»¥ç½‘ç«™ç¾é£Ÿæ°ä¸ºä¾‹ &#39;http://meishij.net&#39;è¯´æ˜headers = {    &#39;User-Agent&#39;:&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#39;}request = Request(&#39;http://meishij.net&#39;,headers=headers)response = urlopen(request)code = response.read().decode()# print(code)# xpath    # etreeå°†å“åº”çš„å­—ç¬¦ä¸²codeè½¬åŒ–ä¸ºhtmlçš„æ ‡ç­¾ç±»å‹,    # é€šè¿‡xpathè®¿é—®æ ‡ç­¾çš„æ–¹å¼åŒ¹é…æŸ¥æ‰¾æŒ‡å®šçš„å†…å®¹    # root = etree.HTML(code)root = etree.HTML(code)print(type(root))title = root.xpath(&#39;//div[@class=&quot;nav&quot;]/ul/li&#39;)[0]# strong_text = title.xpath(&#39;.//a/strong/text()&#39;) #è·å–æ ‡ç­¾æ–‡æœ¬å†…å®¹ è¿”å›å­—ç¬¦ä¸²# strong_text = title.xpath(&#39;@class&#39;)#è·å–æ ‡ç­¾å†…å±æ€§å†…å®¹ è¿”å›åˆ—è¡¨strong_text = title.get(&#39;class&#39;) # get è·å–æ ‡ç­¾å†…å±æ€§å†…å®¹print(strong_text)# bs4soup = BeautifulSoup(code,&#39;lxml&#39;)print(type(soup))# idå”¯ä¸€ ä½¿ç”¨ # + idå†…å®¹æ¥è®¿é—®  classä¸å”¯ä¸€ ä½¿ç”¨. + classå†…å®¹æ¥è®¿é—®# è¿”å›åˆ—è¡¨ éœ€è¦[0]æ¥ä½¿ç”¨index = soup.select(&#39;.nav ul li a&#39;)[0]print(index)attr = index.get(&#39;class&#39;) #å–å±æ€§çš„å€¼print(attr)text = index.get_text() #å–æ–‡æœ¬print(text)# æ­£åˆ™pattern = re.compile(r&#39;&lt;div class=&quot;nav&quot;&gt;.*?&lt;li class=&quot;current&quot;&gt;.*?&lt;strong&gt;(.*?)&lt;/strong&gt;&#39;,re.S)result = pattern.findall(code)print(result)</code></pre><h3 id="æ•°æ®è¯·æ±‚æ–¹å¼çš„åŒºåˆ«"><a href="#æ•°æ®è¯·æ±‚æ–¹å¼çš„åŒºåˆ«" class="headerlink" title="æ•°æ®è¯·æ±‚æ–¹å¼çš„åŒºåˆ«"></a>æ•°æ®è¯·æ±‚æ–¹å¼çš„åŒºåˆ«</h3><pre><code class="python"># -------------------------æ•°æ®è¯·æ±‚æ–¹å¼çš„åŒºåˆ«------------------------# 1.requests# è¯·æ±‚æ•°æ®æ–¹å¼ä¸åŒresponse = requests.get(&#39;http://meishij.net&#39;,headers=headers)print(response.content) # bytesprint(response.text) # str è§£ç å# 2.urlopen Requestrequest = Request(&#39;http://meishij.net&#39;,headers=headers)response = urlopen(request).read() #bytesresponse = response.decode() #str è§£ç åprint(response)</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è±†ç“£top250</title>
    <link href="undefined2018/07/27/2018-07-27-%E8%B1%86%E7%93%A3top250/"/>
    <url>2018/07/27/2018-07-27-%E8%B1%86%E7%93%A3top250/</url>
    
    <content type="html"><![CDATA[<h2 id="è·å–è±†ç“£å½±è¯„top250ä¿¡æ¯å­˜å…¥excelè¡¨"><a href="#è·å–è±†ç“£å½±è¯„top250ä¿¡æ¯å­˜å…¥excelè¡¨" class="headerlink" title="è·å–è±†ç“£å½±è¯„top250ä¿¡æ¯å­˜å…¥excelè¡¨"></a>è·å–è±†ç“£å½±è¯„top250ä¿¡æ¯å­˜å…¥excelè¡¨</h2><blockquote><p>ä½¿ç”¨xpathè·å–æŒ‡å®šå†…å®¹<br>from fake_useragent import UserAgent éšæœºç”ŸæˆUser-Agent</p></blockquote><a id="more"></a><pre><code class="python">import xlwtimport requestsfrom lxml import etreefrom fake_useragent import UserAgentclass DBMovie(object):    def __init__(self):        self.base_url = &#39;http://movie.douban.com/top250&#39;        self.current_page = 1        self.headers = UserAgent()        self.workBook = None        self.sheet = None    def start_load_movie(self):        self.get_excel()        # ç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥æ–¹æ³• urlå€¼å¯ä»¥ä¸ç”¨ä¼         self.get_code_with_url()        self.workBook.save(&#39;è±†ç“£top250.xls&#39;)    def get_excel(self):        self.workBook = xlwt.Workbook(encoding=&#39;utf-8&#39;)        self.sheet = self.workBook.add_sheet(&#39;ç”µå½±æ’è¡Œæ¦œ&#39;)        self.sheet.write(0,0,&#39;æ’å&#39;)        self.sheet.write(0,1,&#39;å½±ç‰‡&#39;)        self.sheet.write(0,2,&#39;å¯¼æ¼”å’Œæ¼”å‘˜&#39;)        self.sheet.write(0,3,&#39;è¯„åˆ†&#39;)        self.sheet.write(0,4,&#39;è¯„è®ºäººæ¬¡&#39;)        self.record = 1    def get_code_with_url(self,url=&#39;&#39;):        headers = {            &#39;User-Agent&#39;:self.headers.random        }        full_url = self.base_url + url        response = requests.get(full_url,headers=headers).text        # print(response)        code = etree.HTML(response)        item_div = code.xpath(&#39;//div[@class=&quot;item&quot;]&#39;)        # print(item_div)        for tag in item_div:            # .ä»å½“å‰èŠ‚ç‚¹å¼€å§‹å–            # ..ä»çˆ¶èŠ‚ç‚¹å¼€å§‹å–            rank = tag.xpath(&#39;.//em[@class=&quot;&quot;]/text()&#39;)[0]            movie_name = tag.xpath(&#39;.//div[@class=&quot;hd&quot;]/a/span/text()&#39;)            name = &#39;&#39;            for movie in movie_name:                name += movie            director = tag.xpath(&#39;.//div[@class=&quot;bd&quot;]/p[@class=&quot;&quot;]/text()&#39;)[0]            director = director.strip(&#39;\n&#39;).replace(&#39; &#39;,&#39;&#39;)            star = tag.xpath(&#39;.//span[@class=&quot;rating_num&quot;]/text()&#39;)[0]            comment_num = tag.xpath(&#39;.//div[@class=&quot;star&quot;]/span[last()]/text()&#39;)[0]            comment_num = comment_num[0:-3]            # print(rank,name,director,star,comment_num)            self.sheet.write(self.record,0,rank)            self.sheet.write(self.record,1,name)            self.sheet.write(self.record,2,director)            self.sheet.write(self.record,3,star)            self.sheet.write(self.record,4,comment_num)            self.record += 1        self.get_next_page(code)    def get_next_page(self,code):        next_url = code.xpath(&#39;//span[@class=&quot;next&quot;]/a/@href&#39;)        if len(next_url) == 0:            print(&#39;å·²ç»æ˜¯æœ€åä¸€é¡µäº†&#39;)            return        self.get_code_with_url(next_url[0])movie = DBMovie()movie.start_load_movie()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¾é£Ÿæ°/BeautifulSoup</title>
    <link href="undefined2018/07/27/2018-07-26-%E7%BE%8E%E9%A3%9F%E6%9D%B0BeautifulSoup/"/>
    <url>2018/07/27/2018-07-26-%E7%BE%8E%E9%A3%9F%E6%9D%B0BeautifulSoup/</url>
    
    <content type="html"><![CDATA[<p>ç¾é£Ÿæ°ç½‘ç«™çˆ¬å–å°é¢å›¾ç‰‡,èœè°±ååŠäººæ°”,ä»¥ â€œè´ç¬‹ç‚’è›‹ï¼ˆ2047äººæ°”)â€ å½¢å¼å­˜å…¥æ•°æ®åº“</p><a id="more"></a><pre><code class="python">from bs4 import BeautifulSoupfrom urllib.request import Request,urlopen,urlretrieveimport os,shutilimport sqlite3# æ•°æ®åº“æ“ä½œclass DBManager(object):    con = None    cursor = None    @classmethod    def createTable(cls):        cls.con = sqlite3.connect(&#39;Msj&#39;)        cls.cursor = cls.con.cursor()        cls.cursor.execute(&#39;create table if not exists food(title text,src text)&#39;)        cls.con.commit()    @classmethod    def insert_data(cls,title,src):        cls.cursor.execute(&#39;insert into food VALUES (&quot;{}&quot;,&quot;{}&quot;)&#39;.format(title,src))        cls.con.commit()    @classmethod    def closeDB(cls):        cls.cursor.close()        cls.con.close()class Msj(object):    def __init__(self):        self.base_url = &#39;https://www.meishij.net/chufang/diy/?&amp;page=1&#39;        self.DBmanager = DBManager()        self.pagedir = 1    def spider(self):        self.DBmanager.createTable()        if os.path.exists(&#39;D:/meishij&#39;):            shutil.rmtree(&#39;D:/meishij&#39;)        os.mkdir(&#39;D:/meishij&#39;)        os.chdir(&#39;D:/meishij&#39;)        self.get_code_with_url(self.base_url)        self.DBmanager.closeDB()    def get_code_with_url(self,url):        headers = {            &#39;User-Agent&#39;:&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0&#39;        }        request = Request(url,headers=headers)        response = urlopen(request)        try:            code = response.read().decode()            self.get_page_with_code(code)        except Exception as e:            print(&#39;è·å–å¤±è´¥:&#39;,e)    def get_page_with_code(self,code):        # print(code)        soup = BeautifulSoup(code,&#39;lxml&#39;)        info = soup.select(&#39;.clearfix img&#39;)        hots = soup.select(&#39;.c1 span&#39;)        print(info,hots)        os.mkdir(&#39;Page{}&#39;.format(self.pagedir))        os.chdir(&#39;Page{}&#39;.format(self.pagedir))        for data,hot in zip(info,hots):            title = data.get(&#39;alt&#39;).replace(&#39;|&#39;,&#39;&#39;)            src = data.get(&#39;src&#39;)            hot = hot.get_text().replace(&#39; &#39;,&#39;&#39;).split(&#39;è®º&#39;)[1]            print(title,src,hot)            self.DBmanager.insert_data(title+&#39;(&#39;+hot+&#39;)&#39;,src)            urlretrieve(src,title+&#39;(&#39;+hot+&#39;).jpg&#39;)        os.chdir(os.path.pardir)        next_page = soup.select(&#39;.next&#39;)        if next_page:            next_page = next_page[0]            next_page_url = next_page.get(&#39;href&#39;)            self.pagedir +=1            print(next_page)            self.get_code_with_url(next_page_url)msj = Msj()msj.spider()</code></pre><blockquote><p>è€å¸ˆ:</p></blockquote><pre><code class="python">import requestsimport lxmlfrom bs4 import BeautifulSoupimport sqlite3from fake_useragent import UserAgentclass MeishiDB(object):    con = None    cursor = None    def openDB(self):        self.con = sqlite3.connect(&#39;meishiDB&#39;)        self.cursor = self.con.cursor()        self.cursor.execute(&#39;create table if not exists MeiShiTable (name text,src text)&#39;)        self.con.commit()    def add_info_to_db(self,name,src):        self.cursor.execute(&#39;insert into MeiShiTable VALUES (&quot;{}&quot;,&quot;{}&quot;)&#39;.format(name,src))        self.con.commit()    def close(self):        self.cursor.close()        self.con.close()class MeiShiJie(object):    def __init__(self):        self.headers = UserAgent()        self.DB = MeishiDB()    def spider(self):        # æ‰“å¼€æ•°æ®åº“å’Œåˆ›å»ºæ•°æ®è¡¨        self.DB.openDB()        code = self.get_code_with_url(&#39;https://www.meishij.net/chufang/diy/&#39;)        self.DB.close()    def get_code_with_url(self,url):        headers = {            &#39;User-Agent&#39;:self.headers.random        }        response = requests.get(url,headers=headers).text        # print(response)        code = BeautifulSoup(response,&#39;lxml&#39;)        self.get_content_with_code(code)    def get_content_with_code(self,code):        divList = code.select(&#39;div.listtyle1&#39;)        for div in divList:            img_alt = div.select(&#39;img&#39;)[0][&#39;alt&#39;]            print(img_alt)            img_src = div.select(&#39;img&#39;)[0][&#39;src&#39;]            print(img_src)            self.DB.add_info_to_db(img_alt,img_src)        self.get_next_page_with_code(code)    def get_next_page_with_code(self,code):        next_url = code.select(&#39;a.next&#39;)        if len(next_url) == 0:            print(&#39;æœ€åä¸€é¡µ&#39;)            return        self.get_code_with_url(next_url[0][&#39;href&#39;])meishi = MeiShiJie()meishi.spider()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¾é£Ÿæ°æ¨¡æ‹Ÿç™»é™†</title>
    <link href="undefined2018/07/26/2018-07-25-%E7%BE%8E%E9%A3%9F%E6%9D%B0%E6%A8%A1%E6%8B%9F%E7%99%BB%E9%99%86/"/>
    <url>2018/07/26/2018-07-25-%E7%BE%8E%E9%A3%9F%E6%9D%B0%E6%A8%A1%E6%8B%9F%E7%99%BB%E9%99%86/</url>
    
    <content type="html"><![CDATA[<p>CharlesæŠ“åŒ…åˆ†æ</p><blockquote><p>ç¾é£ŸèŠ‚ ä½¿ç”¨cookieæ¨¡æ‹Ÿç™»é™† è·å–ç½‘é¡µæºç  ä½¿ç”¨xpathå¾—åˆ°ç”¨æˆ·ä¿¡æ¯ å­˜å‚¨åˆ°excelè¡¨æ ¼</p></blockquote><a id="more"></a><pre><code class="python">from http.cookiejar import CookieJar,LWPCookieJarfrom urllib.request import Request,build_opener,HTTPCookieProcessorfrom urllib.parse import urlencodefrom lxml import etreeimport xlwt# è·å–cookiefileName = &#39;meishij.txt&#39;# ä½¿ç”¨ç»§æ‰¿è‡ªCookieJarç±»çš„LWPCookieJarç±»å®ä¾‹åŒ–ä¸€ä¸ªç®¡ç†cookieçš„å¯¹è±¡# å¹¶ä¼ å…¥fileé‚£ä¹ˆå‚æ•°cookie_obj = LWPCookieJar(filename=fileName)# å®ä¾‹åŒ–ä¸€ä¸ªæ”¯æŒcookieçš„æ‰©å±•ç±»å¯¹è±¡cookie_handler = HTTPCookieProcessor(cookie_obj)# æ„å»ºä¸€ä¸ªåŠŸèƒ½æ›´å¤šçš„è¯·æ±‚urlçš„æ–¹å¼opener = build_opener(cookie_handler)response = opener.open(&#39;https://i.meishi.cc/login.php?redirect=https%3A%2F%2Fi.meishi.cc%2Flogin.php%3Fac%3Dzhuce&#39;)# ä¿å­˜cookiecookie_obj.save(ignore_discard=True,ignore_expires=True)# ä½¿ç”¨æœ¬åœ°cookieæ¨¡æ‹Ÿç”¨æˆ·ç™»é™†cookie = LWPCookieJar()cookie.load(&#39;meishij.txt&#39;)cookie_handler = HTTPCookieProcessor(cookie)opener = build_opener(cookie_handler)post_url = &#39;https://i.meishi.cc/login.php?redirect=https%3A%2F%2Fi.meishi.cc%2Flogin.php%3Fac%3Dzhuce&#39;headers = {    &#39;User-Agent&#39;:&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0&#39;}data = urlencode({    &#39;username&#39;:&#39;********&#39;, #ç”¨æˆ·å     &#39;password&#39;:&#39;********&#39;  #å¯†ç })request = Request(post_url,headers=headers)response = opener.open(request,bytes(data,encoding=&#39;utf-8&#39;))code = response.read().decode()root = etree.HTML(code)print(root)name_list = root.xpath(&#39;//div[@class=&quot;info1&quot;]/h1/text()[1]&#39;)name = name_list[0].replace(&#39;\t&#39;,&#39;&#39;)grade_list = root.xpath(&#39;//span[@class=&quot;info&quot;]/em[1]/a/text()&#39;)grade = grade_list[0]other_list = root.xpath(&#39;//span[@class=&quot;info&quot;]/em/text()&#39;)workBook = xlwt.Workbook(encoding=&#39;utf-8&#39;)sheet = workBook.add_sheet(&#39;info_meishij&#39;)sheet.write(0,0,name)sheet.write(0,1,grade)sheet.write(0,2,other_list[0])sheet.write(0,3,other_list[1])sheet.write(0,4,other_list[2])workBook.save(&#39;meishij.xls&#39;)</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç¨‹æ— å¿§51Job</title>
    <link href="undefined2018/07/25/2018-07-24-%E5%89%8D%E7%A8%8B%E6%97%A0%E5%BF%A751Job/"/>
    <url>2018/07/25/2018-07-24-%E5%89%8D%E7%A8%8B%E6%97%A0%E5%BF%A751Job/</url>
    
    <content type="html"><![CDATA[<p>çˆ¬å–å‰ç¨‹æ— å¿§çš„å²—ä½ä¿¡æ¯å¹¶å­˜å…¥Excelè¡¨<a id="more"></a></p><blockquote><p>çˆ¬å–å†…å®¹:</p><blockquote><p>å²—ä½ å…¬å¸åç§° åœ°å€ è–ªèµ„ å‘å¸ƒæ—¶é—´</p></blockquote></blockquote><pre><code class="python">#https://search.51job.com/list/020000%252C030200,000000,0000,00,9,99,python,2,1.htmlfrom urllib.request import Request,urlopenfrom urllib.parse import quoteimport reimport string,jsonimport xlwtclass job_51(object):    def __init__(self,cityList,job):        self.cityList = cityList        self.job = job        self.cityName = &#39;&#39;        self.headers = {            &quot;User-Agent&quot;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#39;        }        self.first_page = 1        self.total_page = 1        for city in cityList:            cityDigitDict = self.get_cityDigit()            if city == cityList[-1]:                self.cityName += cityDigitDict[city]            else:                self.cityName += cityDigitDict[city] + &#39;%252C&#39;            # print(self.cityName)    def get_cityDigit(self):        url = &#39;https://js.51jobcdn.com/in/js/2016/layer/area_array_c.js?20180319=&#39;        request = Request(url,headers=self.headers)        response = urlopen(request)        code = response.read().decode(&#39;gbk&#39;)        # print(code)        pattern = re.compile(r&#39;area=(.*?);&#39;,re.S)        result = pattern.findall(code)        result = json.loads(result[0])        dict = {}        for key,value in result.items():            key = key.strip(&#39;\r&#39;)            key = key.strip(&#39;\n&#39;)            dict[value] = key        return dict    def get_total_page(self,code):        pattern = re.compile(r&#39;&lt;span class=&quot;td&quot;&gt;å…±(.*?)é¡µ.*?&lt;/span&gt;&#39;,re.S)        result = pattern.findall(code)        return (int(result[0]))    def spider(self):        code = self.get_code_from_url(self.first_page)        # print(code)        self.total_page = self.get_total_page(code)        sheet,workBook = self.openExeclBook()        record = 1        for index in range(1,self.total_page+1):            code = self.get_code_from_url(index)            dataList = self.get_total_data(code)            for index in dataList:                sheet.write(record,0,index[0])                sheet.write(record,1,index[1])                sheet.write(record,2,index[2])                sheet.write(record,3,index[3])                sheet.write(record,4,index[4])                record +=1        workBook.save(&#39;pythonèŒä½ä»‹ç»è¡¨.xls&#39;)    def get_total_data(self,code):        pattern = re.compile(r&#39;&lt;div class=&quot;el&quot;.*?&lt;span.*?&lt;a target.*?&gt;(.*?)&lt;/a&gt;.*?&lt;a.*?&gt;(.*?)&lt;/a&gt;.*?&lt;span class.*?&gt;(.*?)&lt;/span&gt;.*?&lt;span class.*?&gt;(.*?)&lt;/span&gt;.*?&lt;span class.*?&gt;(.*?)&lt;/span&gt;&#39;,re.S)        pattern_space = re.compile(r&#39;\s&#39;, re.S)        result = pattern.findall(code)        list = []        for job, company, add, salary, time in result:            job = job.strip(&#39;\r\n&#39;)            job = re.sub(pattern_space, &#39;&#39;, job)            list.append([job, company, add, salary, time])        return list    def openExeclBook(self):        workBook = xlwt.Workbook(encoding=&#39;utf-8&#39;)        sheet = workBook.add_sheet(&#39;pythonèŒä½è¡¨_51job&#39;)        sheet.write(0,0,&#39;èŒä½å&#39;)        sheet.write(0,1,&#39;å…¬å¸å&#39;)        sheet.write(0,2,&#39;å·¥ä½œåœ°ç‚¹&#39;)        sheet.write(0,3,&#39;è–ªèµ„&#39;)        sheet.write(0,4,&#39;å‘å¸ƒæ—¶é—´&#39;)        return sheet, workBook    def get_code_from_url(self,indexPage):        url = &#39;https://search.51job.com/list/{},000000,0000,00,9,99,{},2,{}.html&#39;.format(self.cityName,self.job,indexPage)        request = Request(url,headers=self.headers)        response = urlopen(request)        code = response.read().decode(&#39;gbk&#39;)        return codecityList = []while True:    city = input(&#39;è¯·è¾“å…¥ä½ è¦æŸ¥è¯¢çš„åŸå¸‚,æŒ‰Eé€€å‡º:&#39;)    if city == &#39;E&#39;:        break    cityList.append(city)job = input(&#39;è¯·è¾“å…¥ä½ è¦æŸ¥è¯¢çš„èŒä½:&#39;)spider = job_51(cityList,job)spider.spider()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äººäººç¾å‰§æ‡’åŠ è½½</title>
    <link href="undefined2018/07/25/2018-07-24-%E4%BA%BA%E4%BA%BA%E7%BE%8E%E5%89%A7%E6%87%92%E5%8A%A0%E8%BD%BD/"/>
    <url>2018/07/25/2018-07-24-%E4%BA%BA%E4%BA%BA%E7%BE%8E%E5%89%A7%E6%87%92%E5%8A%A0%E8%BD%BD/</url>
    
    <content type="html"><![CDATA[<blockquote><p>è¿™ç§åšæ³•æ•ˆç‡æœ‰ç‚¹ä½ğŸ˜‚ è¿˜æœ‰ç‚¹è ¢â€¦â€¦</p></blockquote><a id="more"></a><pre><code class="python"># http://www.zimuzu.io/articlefrom urllib.request import Request,urlopenimport reclass Zimuzu(object):    def __init__(self):        self.base_url = &#39;http://www.zimuzu.io/article/?page=&#39;        self.headers = {            &quot;User-Agent&quot;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#39;        }        self.first_page = 1        self.total_page = 1    def spider(self):        code = self.get_code_from_url(self.first_page)        self.total_page = self.get_total_page(code)        self.get_data_from_code(code)        self.get_page_step()    def get_page_step(self):        index = 1        while True:            signal = input(&#39;å›è½¦ç¿»é¡µ,æŒ‰Eé€€å‡º&#39;)            if signal !=&quot;E&quot;:                code = self.get_code_from_url(index)                data = self.get_data_from_code(code)                index += 1                print(data)            else:                break    def get_data_from_code(self,code):        pattern = re.compile(r&#39;&lt;li class=&quot;clearfix&quot;.*?&lt;span.*?&gt;(.*?)&lt;/span&gt;.*?&lt;a.*?&gt;(.*?)&lt;/a&gt;.*?&lt;p&gt;(.*?)&lt;font.*?&gt;&#39;,re.S)        data = pattern.findall(code)        return data    def get_total_page(self,code):        pattern = re.compile(r&#39;&lt;div class=&quot;pages pages-padding&quot;&gt;.*?&lt;b&gt;.*?&lt;/b&gt;.*?&lt;/a&gt;.*?&lt;a href=.*?page=(.*?)&gt;.*?&lt;span&gt;&#39;,re.S)        result = pattern.findall(code)        result = result[0][0:-1]        return (int(result))    def get_code_from_url(self,indexPage):        url = self.base_url + str(indexPage)        request = Request(url ,headers=self.headers)        response = urlopen(request)        code = response.read().decode()        return codez = Zimuzu()z.spider()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç³—äº‹ç™¾ç§‘çˆ¬è™«</title>
    <link href="undefined2018/07/20/2018-07-19-%E7%B3%97%E4%BA%8B%E7%99%BE%E7%A7%91%E7%88%AC%E8%99%AB/"/>
    <url>2018/07/20/2018-07-19-%E7%B3%97%E4%BA%8B%E7%99%BE%E7%A7%91%E7%88%AC%E8%99%AB/</url>
    
    <content type="html"><![CDATA[<p>ç³—äº‹ç™¾ç§‘çˆ¬è™«</p><a id="more"></a><pre><code class="python">import  refrom urllib.request import Request,urlopenbase_url = &#39;https://www.qiushibaike.com/hot/page/&#39;headers = {    &#39;User-Agent&#39;:&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#39;}ip_list = [    &#39;223.241.116.66:18118&#39;,    &#39;125.120.200.49:6666&#39;,    &#39;221.228.17.172:8181&#39;,    &#39;122.72.18.34:80&#39;,    &#39;218.241.234.48:8080&#39;,    &#39;120.26.110.59:8080&#39;]def down_load_qiubai_info(pageIndex):    full_url = base_url + str(pageIndex) +&#39;/&#39;    request = Request(full_url,headers = headers)    response = urlopen(request)    # è·å–å¯¹åº”ç½‘é¡µçš„å…¨éƒ¨å†…å®¹    # decode()è§£ç     code = response.read().decode()    # æ­£åˆ™åŒ¹é…çš„å†…å®¹  ä»åˆ¶å®šçš„å¼€å§‹ä½ç½®  åˆ°å…¨éƒ¨å†…å®¹ç»“æŸ    # æ‰€ä»¥åªéœ€è¦æŒ‡å®šå¼€å§‹çš„ä½ç½®  ä¸éœ€è¦æŒ‡å®šç»“æŸçš„ä½ç½®    #    # å¦‚æœæˆ‘ä»¬æƒ³è¦æ­£åˆ™è·å–æŸä¸€å¯¹æ ‡ç­¾é‡Œé¢çš„å†…å®¹çš„æ—¶å€™    # é‚£ä¹ˆéœ€è¦å°†è¿™å¯¹æ ‡ç­¾å¯¹å†™å®Œæ•´ è€Œä¸”åœ¨æƒ³è¦è·å–çš„å†…å®¹    # ä¸Šæ·»åŠ () ä¾‹å¦‚: &lt;h2&gt;(.*?)&lt;/h2&gt;    # pattern = re.compile(r&#39;&lt;div class=&quot;author clearfix&quot;&gt;.*?&lt;h2&gt;(.*?)&lt;/h2&gt;.*?&lt;div class=&quot;articleGender .*?Icon&quot;&gt;(.*?)&lt;/div&gt;.*?&lt;a href=&quot;(.*?)&quot;&#39;,re.S)    # result = pattern.findall(code)    # # print(result)    # for name,age,article_url in result:    #     # å»æ‰å¼€å§‹å’Œç»“å°¾çš„æ¢è¡Œç¬¦    #     name = name.strip(&#39;\n&#39;)    #     article_url = article_url.strip(&#39;\n&#39;).replace(&#39;&lt;br/&gt;&#39;,&#39;&#39;)    #     print(&#39;ä½œè€…æ˜¯:&#39;,name)    #     print(&#39;å¹´é¾„æ˜¯:&#39;,age)    #     print(&#39;å†…å®¹æ˜¯:&#39;,article_url)    pattern = re.compile(r&#39;&lt;div class=&quot;author clearfix&quot;&gt;.*?&lt;h2&gt;(.*?)&lt;/h2&gt;.*?&lt;div class=&quot;articleGender.*?Icon&quot;&gt;(.*?)&lt;/div&gt;.*?&lt;a.*?href=&quot;(.*?)&quot;.*?&gt;.*?&lt;div class=&quot;content&quot;&gt;.*?&lt;span&gt;(.*?)&lt;/span&gt;.*?&lt;div class=&quot;stats&quot;&gt;.*?&lt;i class=&quot;number&quot;&gt;(.*?)&lt;/i&gt;.*?&lt;span class=&quot;stats-comments&quot;&gt;.*?&lt;i class=&quot;number&quot;&gt;(.*?)&lt;/i&gt;&#39;,re.S)    result = pattern.findall(code)    for name,age,href,content,number,comments in result:        name = name.strip(&#39;\n&#39;)        age = age.strip(&#39;\n&#39;)        href = href.strip(&#39;\n&#39;)        content = content.strip(&#39;\n&#39;)        number = number.strip(&#39;\n&#39;)        comments = comments.strip(&#39;\n&#39;)        print(&#39;ä½œè€…æ˜¯:&#39;,name)        print(&#39;å¹´é¾„æ˜¯:&#39;,age)        print(&#39;è¯¦æƒ…æ˜¯:&#39;,href)        print(&#39;å†…å®¹æ˜¯:&#39;,content)        print(&#39;å¥½ç¬‘æ•°:&#39;,number)        print(&#39;è¯„è®ºæ•°:&#39;,comments)        if int(comments) !=0:            get_all_comment_with(href)        else:            print(&#39;è¯¥å†…å®¹æš‚æ— è¯„è®º&#39;)def get_all_comment_with(url):    detail_url = &#39;https://www.qiushibaike.com&#39; + url    print(detail_url)    request = Request(detail_url,headers=headers)    response = urlopen(request)    code = response.read().decode()    # print(code)    pattern = re.compile(r&#39;&lt;div class=&quot;replay&quot;.*?&lt;a href=&quot;(.*?)&quot; class=&quot;userlogin&quot;.*?title=&quot;(.*?)&quot;&gt;.*?&lt;span class=&quot;body&quot;&gt;(.*?)&lt;/span&gt;&#39;,re.S)    result = pattern.findall(code)    print(result)    print(&#39;---------------------------------------------------------------&#39;)for i in range(1,14):    down_load_qiubai_info(i)</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bingå£çº¸çˆ¬å–</title>
    <link href="undefined2018/07/19/2018-07-18-Bing%E5%A3%81%E7%BA%B8%E7%88%AC%E5%8F%96/"/>
    <url>2018/07/19/2018-07-18-Bing%E5%A3%81%E7%BA%B8%E7%88%AC%E5%8F%96/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ¬¡çˆ¬å–é‡‡ç”¨<a href="https://github.com/xCss/bing" target="_blank" rel="noopener" title="GitHub">xCss</a>å¤§å¤§æä¾›çš„æ¥å£</p><a id="more"></a><pre><code class="python">from urllib.request import urlopenimport timepname = 0day = 0while True:    day +=1    url = &#39;https://bing.ioliu.cn/v1?d={}&amp;w=1280&#39;.format(day)    response = urlopen(url)    responseStr = response.read()    pname +=1    with open(&#39;C:/Users/45125/Downloads/Bing_1280/{}.jpg&#39;.format(pname),&#39;wb&#39;)as f:        f.write(responseStr)        f.close()    time.sleep(0.5)</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bç«™è§†é¢‘ä¿¡æ¯çˆ¬å–</title>
    <link href="undefined2018/07/18/2018-07-10-B%E7%AB%99%E8%A7%86%E9%A2%91%E4%BF%A1%E6%81%AF%E7%88%AC%E5%8F%96/"/>
    <url>2018/07/18/2018-07-10-B%E7%AB%99%E8%A7%86%E9%A2%91%E4%BF%A1%E6%81%AF%E7%88%AC%E5%8F%96/</url>
    
    <content type="html"><![CDATA[<p>Bç«™è§†é¢‘ä¿¡æ¯çˆ¬å–,åˆ†æbç«™è§†é¢‘ä¿¡æ¯å¾—åˆ°çš„apiæ¥å£</p><a id="more"></a><pre><code class="python">from urllib.request import urlopenfrom urllib.parse import quoteimport string,json,time# url:http://api.bilibili.com/x/web-interface/archive/stat?aid=10001# {&quot;code&quot;:0,&quot;message&quot;:&quot;0&quot;,&quot;ttl&quot;:1,&quot;data&quot;:{&quot;aid&quot;:10001,&quot;view&quot;:22760,&quot;danmaku&quot;:195,&quot;reply&quot;:191,&quot;favorite&quot;:173,&quot;coin&quot;:21,&quot;share&quot;:47,&quot;like&quot;:38,&quot;now_rank&quot;:0,&quot;his_rank&quot;:0,&quot;no_reprint&quot;:0,&quot;copyright&quot;:2}}i = 10001with open(&#39;bili.txt&#39;, &#39;a&#39;, encoding=&#39;utf-8&#39;)as f:    while i&gt;=1000:        i+=1        url = &#39;http://api.bilibili.com/x/web-interface/archive/stat?aid={}&#39;.format(i)        reponse = urlopen(url)        reponseStr = reponse.read()        reponseJson = json.loads(reponseStr)        print(reponseJson)        time.sleep(0.5)        if reponseJson[&#39;code&#39;] == 0:            biliList = []            for index in reponseJson[&#39;data&#39;].items():                biliList.append(str(index)+&#39;,&#39;)            biliList.pop()            biliList.append(&#39;\n&#39;)            for j in biliList:                f.write(str(j))            time.sleep(0.5)    f.close()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>markdown_sync</title>
    <link href="undefined2018/07/17/2018-07-13-markdown_sync/"/>
    <url>2018/07/17/2018-07-13-markdown_sync/</url>
    
    <content type="html"><![CDATA[<p>è¯¥æ–‡ä»¶ç”¨æ¥æµ‹è¯•å’Œå±•ç¤ºä¹¦å†™READMEçš„å„ç§markdownè¯­æ³•ã€‚<a id="more"></a>GitHubçš„markdownè¯­æ³•åœ¨æ ‡å‡†çš„markdownè¯­æ³•åŸºç¡€ä¸Šåšäº†æ‰©å……ï¼Œç§°ä¹‹ä¸º<code>GitHub Flavored Markdown</code>ã€‚ç®€ç§°<code>GFM</code>ï¼ŒGFMåœ¨GitHubä¸Šæœ‰å¹¿æ³›åº”ç”¨ï¼Œé™¤äº†READMEæ–‡ä»¶å¤–ï¼Œissueså’Œwikiå‡æ”¯æŒmarkdownè¯­æ³•ã€‚</p><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li><a href="#æ¨ªçº¿">æ¨ªçº¿</a></li><li><a href="#æ ‡é¢˜">æ ‡é¢˜</a></li><li><a href="#æ–‡æœ¬">æ–‡æœ¬</a><ul><li>æ™®é€šæ–‡æœ¬</li><li>å•è¡Œæ–‡æœ¬</li><li>å¤šè¡Œæ–‡æœ¬</li><li>æ–‡å­—é«˜äº®</li><li>æ¢è¡Œ</li><li>æ–œä½“</li><li>ç²—ä½“</li><li>åˆ é™¤çº¿</li></ul></li><li><a href="#å›¾ç‰‡">å›¾ç‰‡</a><ul><li>æ¥æºäºç½‘ç»œçš„å›¾ç‰‡</li><li>GitHubä»“åº“ä¸­çš„å›¾ç‰‡</li></ul></li><li><a href="#é“¾æ¥">é“¾æ¥</a> <ul><li>æ–‡å­—è¶…é“¾æ¥<ul><li>é“¾æ¥å¤–éƒ¨URL</li><li>é“¾æ¥æœ¬ä»“åº“é‡Œçš„URL</li></ul></li><li>é”šç‚¹</li><li><a href="#å›¾ç‰‡é“¾æ¥">å›¾ç‰‡é“¾æ¥</a></li></ul></li><li><a href="#åˆ—è¡¨">åˆ—è¡¨</a><ul><li>æ— åºåˆ—è¡¨</li><li>æœ‰åºåˆ—è¡¨</li><li>å¤é€‰æ¡†åˆ—è¡¨</li></ul></li><li><a href="#å—å¼•ç”¨">å—å¼•ç”¨</a></li><li><a href="#ä»£ç é«˜äº®">ä»£ç é«˜äº®</a></li><li><a href="#è¡¨æ ¼">è¡¨æ ¼</a> </li><li><a href="#è¡¨æƒ…">è¡¨æƒ…</a></li><li><a href="#diffè¯­æ³•">diffè¯­æ³•</a></li></ul><h3 id="æ¨ªçº¿"><a href="#æ¨ªçº¿" class="headerlink" title="æ¨ªçº¿"></a>æ¨ªçº¿</h3><hr><p>***ã€â€”ã€___å¯ä»¥æ˜¾ç¤ºæ¨ªçº¿æ•ˆæœ</p><hr><hr><hr><h2 id="æ ‡é¢˜"><a href="#æ ‡é¢˜" class="headerlink" title="æ ‡é¢˜"></a>æ ‡é¢˜</h2><h1 id="ä¸€çº§æ ‡é¢˜"><a href="#ä¸€çº§æ ‡é¢˜" class="headerlink" title="ä¸€çº§æ ‡é¢˜"></a>ä¸€çº§æ ‡é¢˜</h1><h2 id="äºŒçº§æ ‡é¢˜"><a href="#äºŒçº§æ ‡é¢˜" class="headerlink" title="äºŒçº§æ ‡é¢˜"></a>äºŒçº§æ ‡é¢˜</h2><h3 id="ä¸‰çº§æ ‡é¢˜"><a href="#ä¸‰çº§æ ‡é¢˜" class="headerlink" title="ä¸‰çº§æ ‡é¢˜"></a>ä¸‰çº§æ ‡é¢˜</h3><h4 id="å››çº§æ ‡é¢˜"><a href="#å››çº§æ ‡é¢˜" class="headerlink" title="å››çº§æ ‡é¢˜"></a>å››çº§æ ‡é¢˜</h4><h5 id="äº”çº§æ ‡é¢˜"><a href="#äº”çº§æ ‡é¢˜" class="headerlink" title="äº”çº§æ ‡é¢˜"></a>äº”çº§æ ‡é¢˜</h5><h6 id="å…­çº§æ ‡é¢˜"><a href="#å…­çº§æ ‡é¢˜" class="headerlink" title="å…­çº§æ ‡é¢˜"></a>å…­çº§æ ‡é¢˜</h6><h2 id="æ–‡æœ¬"><a href="#æ–‡æœ¬" class="headerlink" title="æ–‡æœ¬"></a>æ–‡æœ¬</h2><h3 id="æ™®é€šæ–‡æœ¬"><a href="#æ™®é€šæ–‡æœ¬" class="headerlink" title="æ™®é€šæ–‡æœ¬"></a>æ™®é€šæ–‡æœ¬</h3><p>è¿™æ˜¯ä¸€æ®µæ™®é€šçš„æ–‡æœ¬</p><h3 id="å•è¡Œæ–‡æœ¬"><a href="#å•è¡Œæ–‡æœ¬" class="headerlink" title="å•è¡Œæ–‡æœ¬"></a>å•è¡Œæ–‡æœ¬</h3><pre><code>Hello,å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æœå†»è™¾ä»ã€‚</code></pre><p>åœ¨ä¸€è¡Œå¼€å¤´åŠ å…¥1ä¸ªTabæˆ–è€…4ä¸ªç©ºæ ¼ã€‚</p><h3 id="æ–‡æœ¬å—"><a href="#æ–‡æœ¬å—" class="headerlink" title="æ–‡æœ¬å—"></a>æ–‡æœ¬å—</h3><h4 id="è¯­æ³•1"><a href="#è¯­æ³•1" class="headerlink" title="è¯­æ³•1"></a>è¯­æ³•1</h4><p>åœ¨è¿ç»­å‡ è¡Œçš„æ–‡æœ¬å¼€å¤´åŠ å…¥1ä¸ªTabæˆ–è€…4ä¸ªç©ºæ ¼ã€‚</p><pre><code>æ¬¢è¿åˆ°è®¿å¾ˆé«˜å…´è§åˆ°æ‚¨ç¥æ‚¨ï¼Œæ—©ä¸Šå¥½ï¼Œä¸­åˆå¥½ï¼Œä¸‹åˆå¥½ï¼Œæ™šå®‰</code></pre><h4 id="è¯­æ³•2"><a href="#è¯­æ³•2" class="headerlink" title="è¯­æ³•2"></a>è¯­æ³•2</h4><p>ä½¿ç”¨ä¸€å¯¹å„ä¸‰ä¸ªçš„åå¼•å·ï¼š</p><pre><code>æ¬¢è¿åˆ°è®¿æˆ‘æ˜¯C++ç å†œä½ å¯ä»¥åœ¨çŸ¥ä¹ã€CSDNã€ç®€ä¹¦æœç´¢ã€æœå†»è™¾ä»ã€‘æ‰¾åˆ°æˆ‘</code></pre><p>è¯¥è¯­æ³•ä¹Ÿå¯ä»¥å®ç°ä»£ç é«˜äº®ï¼Œè§<a href="#ä»£ç é«˜äº®">ä»£ç é«˜äº®</a></p><h3 id="æ–‡å­—é«˜äº®"><a href="#æ–‡å­—é«˜äº®" class="headerlink" title="æ–‡å­—é«˜äº®"></a>æ–‡å­—é«˜äº®</h3><p>æ–‡å­—é«˜äº®åŠŸèƒ½èƒ½ä½¿è¡Œå†…éƒ¨åˆ†æ–‡å­—é«˜äº®ï¼Œä½¿ç”¨ä¸€å¯¹åå¼•å·ã€‚<br>è¯­æ³•ï¼š</p><pre><code>`linux` `ç½‘ç»œç¼–ç¨‹` `socket` `epoll` </code></pre><p>æ•ˆæœï¼š<code>linux</code> <code>ç½‘ç»œç¼–ç¨‹</code> <code>socket</code> <code>epoll</code></p><p>ä¹Ÿé€‚åˆåšä¸€ç¯‡æ–‡ç« çš„tag</p><h4 id="æ¢è¡Œ"><a href="#æ¢è¡Œ" class="headerlink" title="æ¢è¡Œ"></a>æ¢è¡Œ</h4><p>ç›´æ¥å›è½¦ä¸èƒ½æ¢è¡Œï¼Œ<br>å¯ä»¥åœ¨ä¸Šä¸€è¡Œæ–‡æœ¬åé¢è¡¥ä¸¤ä¸ªç©ºæ ¼ï¼Œ<br>è¿™æ ·ä¸‹ä¸€è¡Œçš„æ–‡æœ¬å°±æ¢è¡Œäº†ã€‚</p><p>æˆ–è€…å°±æ˜¯åœ¨ä¸¤è¡Œæ–‡æœ¬ç›´æ¥åŠ ä¸€ä¸ªç©ºè¡Œã€‚</p><p>ä¹Ÿèƒ½å®ç°æ¢è¡Œæ•ˆæœï¼Œä¸è¿‡è¿™ä¸ªè¡Œé—´è·æœ‰ç‚¹å¤§ã€‚</p><h4 id="æ–œä½“ã€ç²—ä½“ã€åˆ é™¤çº¿"><a href="#æ–œä½“ã€ç²—ä½“ã€åˆ é™¤çº¿" class="headerlink" title="æ–œä½“ã€ç²—ä½“ã€åˆ é™¤çº¿"></a>æ–œä½“ã€ç²—ä½“ã€åˆ é™¤çº¿</h4><table><thead><tr><th>è¯­æ³•</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td><code>*æ–œä½“1*</code></td><td><em>æ–œä½“1</em></td></tr><tr><td><code>_æ–œä½“2_</code></td><td><em>æ–œä½“2</em></td></tr><tr><td><code>**ç²—ä½“1**</code></td><td><strong>ç²—ä½“1</strong></td></tr><tr><td><code>__ç²—ä½“2__</code></td><td><strong>ç²—ä½“2</strong></td></tr><tr><td><code>è¿™æ˜¯ä¸€ä¸ª ~~åˆ é™¤çº¿~~</code></td><td>è¿™æ˜¯ä¸€ä¸ª <del>åˆ é™¤çº¿</del></td></tr><tr><td><code>***æ–œç²—ä½“1***</code></td><td><strong><em>æ–œç²—ä½“1</em></strong></td></tr><tr><td><code>___æ–œç²—ä½“2___</code></td><td><strong><em>æ–œç²—ä½“2</em></strong></td></tr><tr><td><code>***~~æ–œç²—ä½“åˆ é™¤çº¿1~~***</code></td><td><strong><em><del>æ–œç²—ä½“åˆ é™¤çº¿1</del></em></strong></td></tr><tr><td><code>~~***æ–œç²—ä½“åˆ é™¤çº¿2***~~</code></td><td><del><strong><em>æ–œç²—ä½“åˆ é™¤çº¿2</em></strong></del></td></tr></tbody></table><pre><code>æ–œä½“ã€ç²—ä½“ã€åˆ é™¤çº¿å¯æ··åˆä½¿ç”¨</code></pre><h2 id="å›¾ç‰‡"><a href="#å›¾ç‰‡" class="headerlink" title="å›¾ç‰‡"></a>å›¾ç‰‡</h2><p>åŸºæœ¬æ ¼å¼ï¼š</p><pre><code>![alt](URL title)</code></pre><p>altå’Œtitleå³å¯¹åº”HTMLä¸­çš„altå’Œtitleå±æ€§ï¼ˆéƒ½å¯çœç•¥ï¼‰ï¼š</p><ul><li>altè¡¨ç¤ºå›¾ç‰‡æ˜¾ç¤ºå¤±è´¥æ—¶çš„æ›¿æ¢æ–‡æœ¬</li><li>titleè¡¨ç¤ºé¼ æ ‡æ‚¬åœåœ¨å›¾ç‰‡æ—¶çš„æ˜¾ç¤ºæ–‡æœ¬ï¼ˆæ³¨æ„è¿™é‡Œè¦åŠ å¼•å·ï¼‰</li></ul><p>URLå³å›¾ç‰‡çš„urlåœ°å€ï¼Œå¦‚æœå¼•ç”¨æœ¬ä»“åº“ä¸­çš„å›¾ç‰‡ï¼Œç›´æ¥ä½¿ç”¨<strong>ç›¸å¯¹è·¯å¾„</strong>å°±å¯äº†ï¼Œå¦‚æœå¼•ç”¨å…¶ä»–githubä»“åº“ä¸­çš„å›¾ç‰‡è¦æ³¨æ„æ ¼å¼ï¼Œå³ï¼š<code>ä»“åº“åœ°å€/raw/åˆ†æ”¯å/å›¾ç‰‡è·¯å¾„</code>ï¼Œå¦‚ï¼š</p><pre><code>https://github.com/guodongxiaren/ImageCache/raw/master/Logo/foryou.gif</code></pre><table><thead><tr><th>#</th><th>è¯­æ³•</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td>1</td><td><code>![baidu](http://www.baidu.com/img/bdlogo.gif &quot;ç™¾åº¦logo&quot;)</code></td><td><img src="http://www.baidu.com/img/bdlogo.gif" srcset="/img/loading.gif" alt="baidu" title="ç™¾åº¦logo"></td></tr><tr><td>2</td><td><code>![][foryou]</code></td><td><img src="https://github.com/guodongxiaren/ImageCache/raw/master/Logo/foryou.gif" srcset="/img/loading.gif" alt=""></td></tr></tbody></table><p>æ³¨æ„ä¾‹2çš„å†™æ³•ä½¿ç”¨äº†<strong>URLæ ‡è¯†ç¬¦</strong>çš„å½¢å¼ï¼Œåœ¨<a href="#é“¾æ¥">é“¾æ¥</a>ä¸€èŠ‚æœ‰ä»‹ç»ã€‚</p><blockquote><p>åœ¨æ–‡æœ«æœ‰foryouçš„å®šä¹‰ï¼š</p></blockquote><pre><code>[foryou]:https://github.com/guodongxiaren/ImageCache/raw/master/Logo/foryou.gif</code></pre><h2 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h2><h3 id="é“¾æ¥å¤–éƒ¨URL"><a href="#é“¾æ¥å¤–éƒ¨URL" class="headerlink" title="é“¾æ¥å¤–éƒ¨URL"></a>é“¾æ¥å¤–éƒ¨URL</h3><table><thead><tr><th>#</th><th>è¯­æ³•</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td>1</td><td><code>[æˆ‘çš„åšå®¢](http://blog.csdn.net/guodongxiaren &quot;æ‚¬åœæ˜¾ç¤º&quot;)</code></td><td><a href="http://blog.csdn.net/guodongxiaren" target="_blank" rel="noopener" title="æ‚¬åœæ˜¾ç¤º">æˆ‘çš„åšå®¢</a></td></tr><tr><td>2</td><td><code>[æˆ‘çš„çŸ¥ä¹][zhihu]</code></td><td><a href="https://www.zhihu.com/people/jellywong" target="_blank" rel="noopener" title="æˆ‘çš„çŸ¥ä¹ï¼Œæ¬¢è¿å…³æ³¨">æˆ‘çš„çŸ¥ä¹</a></td></tr></tbody></table><p>è¯­æ³•2ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š</p><ul><li>ç¬¬ä¸€éƒ¨åˆ†ä½¿ç”¨ä¸¤ä¸ªä¸­æ‹¬å·ï¼Œ[ ]é‡Œçš„æ ‡è¯†ç¬¦ï¼ˆæœ¬ä¾‹ä¸­zhihuï¼‰ï¼Œå¯ä»¥æ˜¯æ•°å­—ï¼Œå­—æ¯ç­‰çš„ç»„åˆï¼Œæ ‡è¯†ç¬¦ä¸Šä¸‹å¯¹åº”å°±è¡Œäº†ï¼ˆ<strong>å§‘ä¸”ç§°ä¹‹ä¸ºURLæ ‡è¯†ç¬¦</strong>ï¼‰</li><li>ç¬¬äºŒéƒ¨åˆ†æ ‡è®°å®é™…URLã€‚</li></ul><blockquote><p>ä½¿ç”¨URLæ ‡è¯†ç¬¦èƒ½è¾¾åˆ°å¤ç”¨çš„ç›®çš„ï¼Œä¸€èˆ¬æŠŠå…¨æ–‡æ‰€æœ‰çš„URLæ ‡è¯†ç¬¦ç»Ÿä¸€æ”¾åœ¨æ–‡ç« æœ«å°¾ï¼Œè¿™æ ·çœ‹èµ·æ¥æ¯”è¾ƒå¹²å‡€ã€‚</p><blockquote><p>URLæ ‡è¯†ç¬¦æ˜¯æˆ‘èµ·çš„åå­—ï¼Œä¸çŸ¥é“æ˜¯å¦å‡†ç¡®ã€‚å›§ã€‚ã€‚</p></blockquote></blockquote><h3 id="é“¾æ¥æœ¬ä»“åº“é‡Œçš„URL"><a href="#é“¾æ¥æœ¬ä»“åº“é‡Œçš„URL" class="headerlink" title="é“¾æ¥æœ¬ä»“åº“é‡Œçš„URL"></a>é“¾æ¥æœ¬ä»“åº“é‡Œçš„URL</h3><table><thead><tr><th>è¯­æ³•</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td><code>[æˆ‘çš„ç®€ä»‹](/example/profile.md)</code></td><td><a href="/example/profile.md">æˆ‘çš„ç®€ä»‹</a></td></tr><tr><td><code>[example](./example)</code></td><td><a href="./example">example</a></td></tr></tbody></table><h3 id="å›¾ç‰‡é“¾æ¥"><a href="#å›¾ç‰‡é“¾æ¥" class="headerlink" title="å›¾ç‰‡é“¾æ¥"></a>å›¾ç‰‡é“¾æ¥</h3><p>ç»™å›¾ç‰‡åŠ é“¾æ¥çš„æœ¬è´¨æ˜¯æ··åˆå›¾ç‰‡æ˜¾ç¤ºè¯­æ³•å’Œæ™®é€šçš„é“¾æ¥è¯­æ³•ã€‚æ™®é€šçš„é“¾æ¥ä¸­[ ]å†…éƒ¨æ˜¯é“¾æ¥è¦æ˜¾ç¤ºçš„æ–‡æœ¬ï¼Œè€Œå›¾ç‰‡é“¾æ¥[ ]é‡Œé¢åˆ™æ˜¯è¦æ˜¾ç¤ºçš„å›¾ç‰‡ã€‚<br>ç›´æ¥æ··åˆä¸¤ç§è¯­æ³•å½“ç„¶å¯ä»¥ï¼Œä½†æ˜¯ååˆ†å•°å—¦ï¼Œä¸ºæ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨URLæ ‡è¯†ç¬¦çš„å½¢å¼ã€‚</p><table><thead><tr><th>#</th><th>è¯­æ³•</th><th align="center">æ•ˆæœ</th></tr></thead><tbody><tr><td>1</td><td><code>[![weibo-logo]](http://weibo.com/linpiaochen)</code></td><td align="center"><a href="http://weibo.com/linpiaochen" target="_blank" rel="noopener"><img src="/img/weibo.png" srcset="/img/loading.gif" alt="weibo-logo" title="ç‚¹å‡»å›¾ç‰‡è¿›å…¥æˆ‘çš„å¾®åš"></a></td></tr><tr><td>2</td><td><code>[![](/img/zhihu.png &quot;æˆ‘çš„çŸ¥ä¹ï¼Œæ¬¢è¿å…³æ³¨&quot;)][zhihu]</code></td><td align="center"><a href="https://www.zhihu.com/people/jellywong" target="_blank" rel="noopener" title="æˆ‘çš„çŸ¥ä¹ï¼Œæ¬¢è¿å…³æ³¨"><img src="/img/zhihu.png" srcset="/img/loading.gif" alt="" title="æˆ‘çš„çŸ¥ä¹ï¼Œæ¬¢è¿å…³æ³¨"></a></td></tr><tr><td>3</td><td><code>[![csdn-logo]][csdn]</code></td><td align="center"><a href="http://blog.csdn.net/guodongxiaren" target="_blank" rel="noopener" title="æˆ‘çš„åšå®¢"><img src="/img/csdn.png" srcset="/img/loading.gif" alt="csdn-logo" title="æˆ‘çš„CSDNåšå®¢"></a></td></tr></tbody></table><p>å› ä¸ºå›¾ç‰‡æœ¬èº«å’Œé“¾æ¥æœ¬èº«éƒ½æ”¯æŒURLæ ‡è¯†ç¬¦çš„å½¢å¼ï¼Œæ‰€ä»¥å›¾ç‰‡é“¾æ¥ä¹Ÿå¯ä»¥å¾ˆç®€æ´ï¼ˆè§ä¾‹3ï¼‰ã€‚<br>æ³¨æ„ï¼Œæ­¤æ—¶é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºçš„æ–‡å­—æ˜¯å›¾ç‰‡çš„titleï¼Œè€Œéé“¾æ¥æœ¬èº«çš„titleäº†ã€‚</p><blockquote><p>æœ¬æ–‡URLæ ‡è¯†ç¬¦éƒ½æ”¾ç½®äºæ–‡æœ«</p></blockquote><h3 id="é”šç‚¹"><a href="#é”šç‚¹" class="headerlink" title="é”šç‚¹"></a>é”šç‚¹</h3><p>å…¶å®å‘¢ï¼Œæ¯ä¸€ä¸ªæ ‡é¢˜éƒ½æ˜¯ä¸€ä¸ªé”šç‚¹ï¼Œå’ŒHTMLçš„é”šç‚¹ï¼ˆ<code>#</code>ï¼‰ç±»ä¼¼ï¼Œæ¯”å¦‚æˆ‘ä»¬ </p><table><thead><tr><th>è¯­æ³•</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td><code>[å›åˆ°é¡¶éƒ¨](#readme)</code></td><td><a href="#readme">å›åˆ°é¡¶éƒ¨</a></td></tr></tbody></table><p>ä¸è¿‡è¦æ³¨æ„ï¼Œæ ‡é¢˜ä¸­çš„è‹±æ–‡å­—æ¯éƒ½è¢«è½¬åŒ–ä¸º<strong>å°å†™å­—æ¯</strong>äº†ã€‚</p><blockquote><p>ä»¥å‰GitHubå¯¹ä¸­æ–‡æ”¯æŒçš„ä¸å¥½ï¼Œæ‰€ä»¥ä¸­æ–‡æ ‡é¢˜ä¸èƒ½æ­£ç¡®è¯†åˆ«ä¸ºé”šç‚¹ï¼Œä½†æ˜¯ç°åœ¨å·²ç»æ²¡é—®é¢˜å•¦ï¼</p></blockquote><h2 id="åˆ—è¡¨"><a href="#åˆ—è¡¨" class="headerlink" title="åˆ—è¡¨"></a>åˆ—è¡¨</h2><h3 id="æ— åºåˆ—è¡¨"><a href="#æ— åºåˆ—è¡¨" class="headerlink" title="æ— åºåˆ—è¡¨"></a>æ— åºåˆ—è¡¨</h3><ul><li>æ˜µç§°ï¼šæœå†»è™¾ä»</li></ul><ul><li>åˆ«åï¼šéš”å£è€ç‹</li></ul><ul><li>è‹±æ–‡åï¼šJelly</li></ul><h3 id="å¤šçº§æ— åºåˆ—è¡¨"><a href="#å¤šçº§æ— åºåˆ—è¡¨" class="headerlink" title="å¤šçº§æ— åºåˆ—è¡¨"></a>å¤šçº§æ— åºåˆ—è¡¨</h3><ul><li>ç¼–ç¨‹è¯­è¨€<ul><li>è„šæœ¬è¯­è¨€<ul><li>Python</li></ul></li></ul></li></ul><h3 id="æœ‰åºåˆ—è¡¨"><a href="#æœ‰åºåˆ—è¡¨" class="headerlink" title="æœ‰åºåˆ—è¡¨"></a>æœ‰åºåˆ—è¡¨</h3><h4 id="ä¸€èˆ¬æ•ˆæœ"><a href="#ä¸€èˆ¬æ•ˆæœ" class="headerlink" title="ä¸€èˆ¬æ•ˆæœ"></a>ä¸€èˆ¬æ•ˆæœ</h4><p>å°±æ˜¯åœ¨æ•°å­—åé¢åŠ ä¸€ä¸ªç‚¹ï¼Œå†åŠ ä¸€ä¸ªç©ºæ ¼ã€‚ä¸è¿‡çœ‹èµ·æ¥èµ·æ¥å¯èƒ½ä¸å¤Ÿæ˜æ˜¾ã€‚<br>é¢å‘å¯¹è±¡çš„ä¸‰ä¸ªåŸºæœ¬ç‰¹å¾ï¼š</p><ol><li>å°è£…</li><li>ç»§æ‰¿</li><li>å¤šæ€</li></ol><h4 id="å¤šçº§æœ‰åºåˆ—è¡¨"><a href="#å¤šçº§æœ‰åºåˆ—è¡¨" class="headerlink" title="å¤šçº§æœ‰åºåˆ—è¡¨"></a>å¤šçº§æœ‰åºåˆ—è¡¨</h4><p>å’Œæ— åºåˆ—è¡¨ä¸€æ ·ï¼Œæœ‰åºåˆ—è¡¨ä¹Ÿæœ‰å¤šçº§ç»“æ„ï¼š  </p><ol><li>è¿™æ˜¯ä¸€çº§çš„æœ‰åºåˆ—è¡¨ï¼Œæ•°å­—1è¿˜æ˜¯1<ol><li>è¿™æ˜¯äºŒçº§çš„æœ‰åºåˆ—è¡¨ï¼Œé˜¿æ‹‰ä¼¯æ•°å­—åœ¨æ˜¾ç¤ºçš„æ—¶å€™å˜æˆäº†ç½—é©¬æ•°å­—<ol><li>è¿™æ˜¯ä¸‰çº§çš„æœ‰åºåˆ—è¡¨ï¼Œæ•°å­—åœ¨æ˜¾ç¤ºçš„æ—¶å€™å˜æˆäº†è‹±æ–‡å­—æ¯</li></ol></li></ol></li></ol><h3 id="å¤é€‰æ¡†åˆ—è¡¨"><a href="#å¤é€‰æ¡†åˆ—è¡¨" class="headerlink" title="å¤é€‰æ¡†åˆ—è¡¨"></a>å¤é€‰æ¡†åˆ—è¡¨</h3><ul><li><input checked="" disabled="" type="checkbox"> éœ€æ±‚åˆ†æ</li><li><input checked="" disabled="" type="checkbox"> ç³»ç»Ÿè®¾è®¡</li><li><input checked="" disabled="" type="checkbox"> è¯¦ç»†è®¾è®¡</li><li><input disabled="" type="checkbox"> ç¼–ç </li><li><input disabled="" type="checkbox"> æµ‹è¯•</li><li><input disabled="" type="checkbox"> äº¤ä»˜</li></ul><p>æ‚¨å¯ä»¥ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½æ¥æ ‡æ³¨æŸä¸ªé¡¹ç›®å„é¡¹ä»»åŠ¡çš„å®Œæˆæƒ…å†µã€‚</p><blockquote><p>Tip:</p><blockquote><p>åœ¨GitHubçš„<strong>issue</strong>ä¸­ä½¿ç”¨è¯¥è¯­æ³•æ˜¯å¯ä»¥å®æ—¶ç‚¹å‡»å¤é€‰æ¡†æ¥å‹¾é€‰æˆ–è§£é™¤å‹¾é€‰çš„ï¼Œè€Œæ— éœ€ä¿®æ”¹issueåŸæ–‡ã€‚</p></blockquote></blockquote><h2 id="å—å¼•ç”¨"><a href="#å—å¼•ç”¨" class="headerlink" title="å—å¼•ç”¨"></a>å—å¼•ç”¨</h2><h3 id="å¸¸ç”¨äºå¼•ç”¨æ–‡æœ¬"><a href="#å¸¸ç”¨äºå¼•ç”¨æ–‡æœ¬" class="headerlink" title="å¸¸ç”¨äºå¼•ç”¨æ–‡æœ¬"></a>å¸¸ç”¨äºå¼•ç”¨æ–‡æœ¬</h3><h4 id="æ–‡æœ¬æ‘˜è‡ªã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹P27"><a href="#æ–‡æœ¬æ‘˜è‡ªã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹P27" class="headerlink" title="æ–‡æœ¬æ‘˜è‡ªã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹P27"></a>æ–‡æœ¬æ‘˜è‡ªã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹P27</h4><p>ã€€ä»¤äººåƒæƒŠçš„æ˜¯ï¼Œåœ¨å“ªç§å­—èŠ‚é¡ºåºæ˜¯åˆé€‚çš„è¿™ä¸ªé—®é¢˜ä¸Šï¼Œäººä»¬è¡¨ç°å¾—éå¸¸æƒ…ç»ªåŒ–ã€‚å®é™…ä¸Šæœ¯è¯­â€œlittle endianâ€ï¼ˆå°ç«¯ï¼‰å’Œâ€œbig endianâ€ï¼ˆå¤§ç«¯ï¼‰å‡ºè‡ªJonathan Swiftçš„ã€Šæ ¼åˆ©ä½›æ¸¸è®°ã€‹ä¸€ä¹¦ï¼Œå…¶ä¸­äº¤æˆ˜çš„ä¸¤ä¸ªæ´¾åˆ«æ— æ³•å°±åº”è¯¥ä»å“ªä¸€ç«¯æ‰“å¼€ä¸€ä¸ªåŠç†Ÿçš„é¸¡è›‹è¾¾æˆä¸€è‡´ã€‚å› æ­¤ï¼Œäº‰è®ºæ²¦ä¸ºå…³äºç¤¾ä¼šæ”¿æ²»çš„äº‰è®ºã€‚åªè¦é€‰æ‹©äº†ä¸€ç§è§„åˆ™å¹¶ä¸”å§‹ç»ˆå¦‚ä¸€çš„åšæŒï¼Œå…¶å®å¯¹äºå“ªç§å­—èŠ‚æ’åºçš„é€‰æ‹©éƒ½æ˜¯ä»»æ„çš„ã€‚</p><blockquote><p><strong>â€œç«¯â€ï¼ˆendianï¼‰çš„èµ·æº</strong><br>ä»¥ä¸‹æ˜¯Jonathan Swiftåœ¨1726å¹´å…³äºå¤§å°ç«¯ä¹‹äº‰å†å²çš„æè¿°ï¼š<br>â€œâ€¦â€¦ä¸‹é¢æˆ‘è¦å‘Šè¯‰ä½ çš„æ˜¯ï¼ŒLilliputå’ŒBlefuscuè¿™ä¸¤å¤§å¼ºå›½åœ¨è¿‡å»36ä¸ªæœˆé‡Œä¸€ç›´åœ¨è‹¦æˆ˜ã€‚æˆ˜äº‰å¼€å§‹æ˜¯ç”±äºä»¥ä¸‹çš„åŸå› ï¼šæˆ‘ä»¬å¤§å®¶éƒ½è®¤ä¸ºï¼Œåƒé¸¡è›‹å‰ï¼ŒåŸå§‹çš„æ–¹æ³•æ˜¯æ‰“ç ´é¸¡è›‹è¾ƒå¤§çš„ä¸€ç«¯ï¼Œå¯æ˜¯å½“ä»Šçš„çš‡å¸çš„ç¥–çˆ¶å°æ—¶å€™åƒé¸¡è›‹ï¼Œä¸€æ¬¡æŒ‰å¤æ³•æ‰“é¸¡è›‹æ—¶ç¢°å·§å°†ä¸€ä¸ªæ‰‹æŒ‡å¼„ç ´äº†ï¼Œå› æ­¤ä»–çš„çˆ¶äº²ï¼Œå½“æ—¶çš„çš‡å¸ï¼Œå°±ä¸‹äº†ä¸€é“æ••ä»¤ï¼Œå‘½ä»¤å…¨ä½“è‡£æ°‘åƒé¸¡è›‹æ—¶æ‰“ç ´è¾ƒå°çš„ä¸€ç«¯ï¼Œè¿ä»¤è€…é‡ç½šã€‚â€</p></blockquote><h3 id="å—å¼•ç”¨æœ‰å¤šçº§ç»“æ„"><a href="#å—å¼•ç”¨æœ‰å¤šçº§ç»“æ„" class="headerlink" title="å—å¼•ç”¨æœ‰å¤šçº§ç»“æ„"></a>å—å¼•ç”¨æœ‰å¤šçº§ç»“æ„</h3><blockquote><p>æ•°æ®ç»“æ„</p><blockquote><p>æ ‘</p><blockquote><p>äºŒå‰æ ‘</p><blockquote><p>å¹³è¡¡äºŒå‰æ ‘</p><blockquote><p>æ»¡äºŒå‰æ ‘</p></blockquote></blockquote></blockquote></blockquote></blockquote><h2 id="ä»£ç é«˜äº®"><a href="#ä»£ç é«˜äº®" class="headerlink" title="ä»£ç é«˜äº®"></a>ä»£ç é«˜äº®</h2><p>åœ¨ä¸‰ä¸ªåå¼•å·åé¢åŠ ä¸Šç¼–ç¨‹è¯­è¨€çš„åå­—ï¼Œå¦èµ·ä¸€è¡Œå¼€å§‹å†™ä»£ç ï¼Œæœ€åä¸€è¡Œå†åŠ ä¸Šä¸‰ä¸ªåå¼•å·ã€‚</p><pre><code class="Java">public static void main(String[]args){} //Java</code></pre><pre><code class="c">int main(int argc, char *argv[]) //C</code></pre><pre><code class="Bash">echo &quot;hello GitHub&quot; #Bash</code></pre><pre><code class="javascript">document.getElementById(&quot;myH1&quot;).innerHTML=&quot;Welcome to my Homepage&quot;; //javascipt</code></pre><pre><code class="cpp">string &amp;operator+(const string&amp; A,const string&amp; B) //cpp</code></pre><h2 id="è¡¨æ ¼"><a href="#è¡¨æ ¼" class="headerlink" title="è¡¨æ ¼"></a>è¡¨æ ¼</h2><table><thead><tr><th>è¡¨å¤´1</th><th>è¡¨å¤´2</th></tr></thead><tbody><tr><td>è¡¨æ ¼å•å…ƒ</td><td>è¡¨æ ¼å•å…ƒ</td></tr><tr><td>è¡¨æ ¼å•å…ƒ</td><td>è¡¨æ ¼å•å…ƒ</td></tr></tbody></table><table><thead><tr><th>è¡¨å¤´1</th><th>è¡¨å¤´2</th></tr></thead><tbody><tr><td>è¡¨æ ¼å•å…ƒ</td><td>è¡¨æ ¼å•å…ƒ</td></tr><tr><td>è¡¨æ ¼å•å…ƒ</td><td>è¡¨æ ¼å•å…ƒ</td></tr></tbody></table><h3 id="å¯¹é½"><a href="#å¯¹é½" class="headerlink" title="å¯¹é½"></a>å¯¹é½</h3><p>è¡¨æ ¼å¯ä»¥æŒ‡å®šå¯¹é½æ–¹å¼</p><table><thead><tr><th align="left">å·¦å¯¹é½</th><th align="center">å±…ä¸­</th><th align="right">å³å¯¹é½</th></tr></thead><tbody><tr><td align="left">col 3 is</td><td align="center">some wordy text</td><td align="right">$1600</td></tr><tr><td align="left">col 2 is</td><td align="center">centered</td><td align="right">$12</td></tr><tr><td align="left">zebra stripes</td><td align="center">are neat</td><td align="right">$1</td></tr></tbody></table><h3 id="æ··åˆå…¶ä»–è¯­æ³•"><a href="#æ··åˆå…¶ä»–è¯­æ³•" class="headerlink" title="æ··åˆå…¶ä»–è¯­æ³•"></a>æ··åˆå…¶ä»–è¯­æ³•</h3><p>è¡¨æ ¼å•å…ƒä¸­çš„å†…å®¹å¯ä»¥å’Œå…¶ä»–å¤§å¤šæ•°GFMè¯­æ³•é…åˆä½¿ç”¨ï¼Œå¦‚ï¼š  </p><h4 id="ä½¿ç”¨æ™®é€šæ–‡æœ¬çš„åˆ é™¤çº¿ï¼Œæ–œä½“ç­‰æ•ˆæœ"><a href="#ä½¿ç”¨æ™®é€šæ–‡æœ¬çš„åˆ é™¤çº¿ï¼Œæ–œä½“ç­‰æ•ˆæœ" class="headerlink" title="ä½¿ç”¨æ™®é€šæ–‡æœ¬çš„åˆ é™¤çº¿ï¼Œæ–œä½“ç­‰æ•ˆæœ"></a>ä½¿ç”¨æ™®é€šæ–‡æœ¬çš„åˆ é™¤çº¿ï¼Œæ–œä½“ç­‰æ•ˆæœ</h4><table><thead><tr><th>åå­—</th><th>æè¿°</th></tr></thead><tbody><tr><td>Help</td><td><del>Display the</del> help window.</td></tr><tr><td>Close</td><td><em>Closes</em> a window</td></tr></tbody></table><h4 id="è¡¨æ ¼ä¸­åµŒå…¥å›¾ç‰‡ï¼ˆé“¾æ¥ï¼‰"><a href="#è¡¨æ ¼ä¸­åµŒå…¥å›¾ç‰‡ï¼ˆé“¾æ¥ï¼‰" class="headerlink" title="è¡¨æ ¼ä¸­åµŒå…¥å›¾ç‰‡ï¼ˆé“¾æ¥ï¼‰"></a>è¡¨æ ¼ä¸­åµŒå…¥å›¾ç‰‡ï¼ˆé“¾æ¥ï¼‰</h4><p>å…¶å®å‰é¢ä»‹ç»å›¾ç‰‡æ˜¾ç¤ºã€å›¾ç‰‡é“¾æ¥çš„æ—¶å€™ä¸ºäº†æ¸…æ™°å°±æ˜¯æ”¾åœ¨åœ¨è¡¨æ ¼ä¸­æ˜¾ç¤ºçš„ã€‚</p><table><thead><tr><th>å›¾ç‰‡</th><th>æè¿°</th></tr></thead><tbody><tr><td><img src="http://www.baidu.com/img/bdlogo.gif" srcset="/img/loading.gif" alt="baidu" title="ç™¾åº¦logo"></td><td>ç™¾åº¦</td></tr></tbody></table><h2 id="è¡¨æƒ…"><a href="#è¡¨æƒ…" class="headerlink" title="è¡¨æƒ…"></a>è¡¨æƒ…</h2><p>Githubçš„Markdownè¯­æ³•æ”¯æŒæ·»åŠ emojiè¡¨æƒ…ï¼Œè¾“å…¥ä¸åŒçš„ç¬¦å·ç ï¼ˆä¸¤ä¸ªå†’å·åŒ…å›´çš„å­—ç¬¦ï¼‰å¯ä»¥æ˜¾ç¤ºå‡ºä¸åŒçš„è¡¨æƒ…ã€‚</p><p>æ¯”å¦‚<code>:blush:</code>ï¼Œå¯ä»¥æ˜¾ç¤º:blush:ã€‚</p><p>å…·ä½“æ¯ä¸€ä¸ªè¡¨æƒ…çš„ç¬¦å·ç ï¼Œå¯ä»¥æŸ¥è¯¢GitHubçš„å®˜æ–¹ç½‘é¡µ<a href="http://www.emoji-cheat-sheet.com" target="_blank" rel="noopener">http://www.emoji-cheat-sheet.com</a>ã€‚</p><p>ä½†æ˜¯è¿™ä¸ªç½‘é¡µæ¯æ¬¡éƒ½æ‰“å¼€<strong>å¥‡æ…¢</strong>ã€‚ã€‚æ‰€ä»¥æˆ‘æ•´ç†åˆ°äº†æœ¬repoä¸­ï¼Œå¤§å®¶å¯ä»¥ç›´æ¥åœ¨æ­¤æŸ¥çœ‹<a href="./emoji.md">emoji</a>ã€‚</p><h2 id="diffè¯­æ³•"><a href="#diffè¯­æ³•" class="headerlink" title="diffè¯­æ³•"></a>diffè¯­æ³•</h2><p>ç‰ˆæœ¬æ§åˆ¶çš„ç³»ç»Ÿä¸­éƒ½å°‘ä¸äº†diffçš„åŠŸèƒ½ï¼Œå³å±•ç¤ºä¸€ä¸ªæ–‡ä»¶å†…å®¹çš„å¢åŠ ä¸åˆ é™¤ã€‚<br>GFMä¸­å¯ä»¥æ˜¾ç¤ºçš„å±•ç¤ºdiffæ•ˆæœã€‚ä½¿ç”¨ç»¿è‰²è¡¨ç¤ºæ–°å¢ï¼Œçº¢è‰²è¡¨ç¤ºåˆ é™¤ã€‚</p><p>å…¶è¯­æ³•ä¸ä»£ç é«˜äº®ç±»ä¼¼ï¼Œåªæ˜¯åœ¨ä¸‰ä¸ªåå¼•å·åé¢å†™diffï¼Œ<br>å¹¶ä¸”å…¶å†…å®¹ä¸­ï¼Œä»¥ <code>+</code>å¼€å¤´è¡¨ç¤ºæ–°å¢ï¼Œ<code>-</code>å¼€å¤´è¡¨ç¤ºåˆ é™¤ã€‚</p><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><pre><code class="diff">+ é¸Ÿå®¿æ± è¾¹æ ‘ï¼Œåƒ§æ•²æœˆä¸‹é—¨- é¸Ÿå®¿æ± è¾¹æ ‘ï¼Œåƒ§æ¨æœˆä¸‹é—¨</code></pre><hr>]]></content>
    
    
    
    <tags>
      
      <tag>markdown</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>pythonå¸¸è§é”™è¯¯</title>
    <link href="undefined2018/07/17/2018-07-16-python%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF/"/>
    <url>2018/07/17/2018-07-16-python%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF/</url>
    
    <content type="html"><![CDATA[<h2 id="pythonå¸¸è§é”™è¯¯"><a href="#pythonå¸¸è§é”™è¯¯" class="headerlink" title="pythonå¸¸è§é”™è¯¯"></a>pythonå¸¸è§é”™è¯¯</h2><p>1.SyntaxError: â€˜returnâ€™ outside function</p><pre><code class="python">while True:    count += 1    if count ==20:        return</code></pre><blockquote><p>è¯­æ³•é”™è¯¯:return ä¸èƒ½åœ¨æ–¹æ³•ä»¥å¤–æ‰§è¡Œ</p><blockquote><p>è§£å†³:å°†returnæ”¾è¿›æ–¹æ³•ä½“ä¸­</p></blockquote></blockquote> <a id="more"></a><p>2.IndentationError: expected an indented block</p><pre><code class="python">if count == 0:print(count)else:  print(&#39;nothing&#39;)</code></pre><blockquote><p>ç¼©è¿›é”™è¯¯:æœªæ­£ç¡®ç¼©è¿›</p><blockquote><p>è§£å†³:æ­£ç¡®ç¼©è¿›</p></blockquote></blockquote><p>3.IndexError: string index out of range</p><pre><code class="python">content = &#39;hello&#39;print(content[10])</code></pre><blockquote><p>ç´¢å¼•é”™è¯¯:å­—ç¬¦ä¸²è¶…å‡ºèŒƒå›´</p><blockquote><p>è§£å†³:æŸ¥çœ‹å­—ç¬¦ä¸²é•¿åº¦,ç´¢å¼•è¦å°äºå­—ç¬¦ä¸²é•¿åº¦</p></blockquote></blockquote><p>4.ValueError: substring not found</p><pre><code class="python">content = &#39;Hello World&#39;result = content.index(&#39;z&#39;)print(result)</code></pre><blockquote><p>å€¼é”™è¯¯:å­å­—ç¬¦ä¸²æœªæ‰¾åˆ°</p><blockquote><p>è§£å†³://</p></blockquote></blockquote><p>5.AttributeError: â€˜tupleâ€™ object has no attribute â€˜removeâ€™</p><pre><code class="python">tp1 = ((),[],{},1,2,3,&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,3.14,True)print(tp1)</code></pre><blockquote><p>attribute å±æ€§ object å¯¹è±¡</p><blockquote><p>å±æ€§é”™è¯¯</p></blockquote></blockquote><p>6.KeyError: â€˜fondâ€™</p><pre><code class="python">dict1 = {    &#39;name&#39;:&#39;å¼ ä¸‰&#39;,    &#39;age&#39;:17,    &#39;friend&#39;:[&#39;æå››&#39;,&#39;ç‹äº”&#39;,&#39;èµµå…­&#39;,&#39;å†¯ä¸ƒ&#39;]}print(dict1[&#39;fond&#39;])</code></pre><blockquote><p>keyé”™è¯¯ æ²¡æœ‰æŒ‡å®šçš„é”®å€¼â€™fondâ€™</p></blockquote><p>7.TypeError: pop expected at least 1 arguments, got 0</p><pre><code class="python">dict1 = {&#39;a&#39;:1,&#39;b&#39;:2}dict1.pop()</code></pre><blockquote><p>arguments å‚æ•°  expected æœŸæœ› at least è‡³å°‘</p><blockquote><p>ç±»å‹é”™è¯¯:popæ–¹æ³•å¸Œæœ›å¾—åˆ°è‡³å°‘ä¸€ä¸ªå‚æ•° ä½†ç°åœ¨å‚æ•°ä¸º0</p></blockquote></blockquote><p>8.SyntaxError: invalid syntax</p><pre><code class="python">if True    print(1)</code></pre><blockquote><p>è¯­æ³•é”™è¯¯</p><blockquote><p>è§£å†³:Trueåé¢åŠ ä¸Š:</p></blockquote></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>